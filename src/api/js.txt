import {a6 as g, a7 as d, u as c, I as b, a8 as m, a9 as i, g as p, aa as v, A as h, ab as k} from "./DsUZB3l6.js";
function x(t=!1) {
    const a = g
      , e = a.l.u;
    if (!e)
        return;
    let f = () => v(a.s);
    if (t) {
        let n = 0
          , s = {};
        const _ = h( () => {
            let l = !1;
            const r = a.s;
            for (const o in r)
                r[o] !== s[o] && (s[o] = r[o],
                l = !0);
            return l && n++,
            n
        }
        );
        f = () => p(_)
    }
    e.b.length && d( () => {
        u(a, f),
        i(e.b)
    }
    ),
    c( () => {
        const n = b( () => e.m.map(m));
        return () => {
            for (const s of n)
                typeof s == "function" && s()
        }
    }
    ),
    e.a.length && c( () => {
        u(a, f),
        i(e.a)
    }
    )
}
function u(t, a) {
    if (t.l.s)
        for (const e of t.l.s)
            p(e);
    a()
}
k();
export {x as i};
 import {n as L, aI as X, aJ as Q, aK as ee, aj as re, aL as se, aM as te, aN as j, aH as ae, I as V, ai as G, am as A, aO as oe, aP as p, aQ as T, U as v} from "./DsUZB3l6.js";
const ne = Symbol("is custom element")
  , ie = Symbol("is html");
function Se(e) {
    if (L) {
        var r = !1
          , s = () => {
            if (!r) {
                if (r = !0,
                e.hasAttribute("value")) {
                    var t = e.value;
                    I(e, "value", null),
                    e.value = t
                }
                if (e.hasAttribute("checked")) {
                    var a = e.checked;
                    I(e, "checked", null),
                    e.checked = a
                }
            }
        }
        ;
        e.__on_r = s,
        re(s),
        se()
    }
}
function $e(e, r) {
    var s = z(e);
    s.value === (s.value = r ?? void 0) || e.value === r && (r !== 0 || e.nodeName !== "PROGRESS") || (e.value = r ?? "")
}
function I(e, r, s, t) {
    var a = z(e);
    L && (a[r] = e.getAttribute(r),
    r === "src" || r === "srcset" || r === "href" && e.nodeName === "LINK") || a[r] !== (a[r] = s) && (r === "loading" && (e[X] = s),
    s == null ? e.removeAttribute(r) : typeof s != "string" && ce(e).includes(r) ? e[r] = s : e.setAttribute(r, s))
}
function z(e) {
    return e.__attributes ??= {
        [ne]: e.nodeName.includes("-"),
        [ie]: e.namespaceURI === Q
    }
}
var D = new Map;
function ce(e) {
    var r = e.getAttribute("is") || e.nodeName
      , s = D.get(r);
    if (s)
        return s;
    D.set(r, s = []);
    for (var t, a = e, n = Element.prototype; n !== a; ) {
        t = te(a);
        for (var i in t)
            t[i].set && s.push(i);
        a = ee(a)
    }
    return s
}
function Ue(e, r, s=r) {
    var t = new WeakSet;
    j(e, "input", async a => {
        var n = a ? e.defaultValue : e.value;
        if (n = b(e) ? P(n) : n,
        s(n),
        A !== null && t.add(A),
        await ae(),
        n !== (n = r())) {
            var i = e.selectionStart
              , u = e.selectionEnd
              , $ = e.value.length;
            if (e.value = n ?? "",
            u !== null) {
                var d = e.value.length;
                i === u && u === $ && d > $ ? (e.selectionStart = d,
                e.selectionEnd = d) : (e.selectionStart = i,
                e.selectionEnd = Math.min(u, d))
            }
        }
    }
    ),
    (L && e.defaultValue !== e.value || V(r) == null && e.value) && (s(b(e) ? P(e.value) : e.value),
    A !== null && t.add(A)),
    G( () => {
        var a = r();
        if (e === document.activeElement) {
            var n = oe ?? A;
            if (t.has(n))
                return
        }
        b(e) && a === P(e.value) || e.type === "date" && !a && !e.value || a !== e.value && (e.value = a ?? "")
    }
    )
}
function Le(e, r, s=r) {
    j(e, "change", t => {
        var a = t ? e.defaultChecked : e.checked;
        s(a)
    }
    ),
    (L && e.defaultChecked !== e.checked || V(r) == null) && s(e.checked),
    G( () => {
        var t = r();
        e.checked = !!t
    }
    )
}
function b(e) {
    var r = e.type;
    return r === "number" || r === "range"
}
function P(e) {
    return e === "" ? null : +e
}
const q = "nowkie_user";
function B() {
    try {
        const e = localStorage.getItem(q);
        if (e)
            return JSON.parse(e)
    } catch {}
    return null
}
function y(e) {
    try {
        e ? localStorage.setItem(q, JSON.stringify(e)) : localStorage.removeItem(q)
    } catch {}
}
function ue() {
    const e = B()
      , {subscribe: r, set: s, update: t} = T({
        user: e,
        accessToken: null,
        isLoading: !1,
        isChecked: !1,
        profileRequired: !1
    });
    return {
        subscribe: r,
        setAccessToken(a) {
            t(n => ({
                ...n,
                accessToken: a
            }))
        },
        getAccessToken() {
            return v({
                subscribe: r
            }).accessToken
        },
        setUser(a) {
            t(n => (y(a),
            {
                ...n,
                user: a,
                isChecked: !0
            }))
        },
        login(a, n) {
            s({
                user: a,
                accessToken: n || null,
                isLoading: !1,
                isChecked: !0,
                profileRequired: !1
            }),
            y(a)
        },
        setProfileRequired(a) {
            s({
                user: null,
                accessToken: a,
                isLoading: !1,
                isChecked: !0,
                profileRequired: !0
            }),
            y(null)
        },
        logout() {
            s({
                user: null,
                accessToken: null,
                isLoading: !1,
                isChecked: !0,
                profileRequired: !1
            }),
            y(null)
        },
        setLoading(a) {
            t(n => ({
                ...n,
                isLoading: a
            }))
        },
        setChecked(a) {
            t(n => ({
                ...n,
                isChecked: a
            }))
        },
        updateUser(a) {
            t(n => {
                if (!n.user)
                    return n;
                const i = {
                    ...n.user,
                    ...a
                };
                return y(i),
                {
                    ...n,
                    user: i
                }
            }
            )
        },
        hasCachedUser() {
            return !!B()
        }
    }
}
const o = ue()
  , Ce = p(o, e => e.isChecked && !!e.user)
  , Ne = p(o, e => e.user)
  , Oe = p(o, e => e.isLoading)
  , be = p(o, e => e.isChecked);
p(o, e => e.isChecked && e.user?.roles?.includes("healer"));
p(o, e => e.accessToken);
const Pe = p(o, e => e.profileRequired)
  , le = ""
  , F = `${le}/api`
  , fe = ""
  , J = `${fe}/api/v1/auth`
  , c = {
    auth: {
        signUp: "/sign-up",
        signIn: "/sign-in",
        verifyOtp: "/verify-otp",
        resendOtp: "/resend-otp",
        refresh: "/refresh",
        logout: "/logout",
        changePassword: "/change-password",
        forgotPassword: "/forgot-password",
        resetPassword: "/reset-password",
        loginYandex: "/login/yandex",
        loginGoogle: "/login/google"
    },
    users: {
        me: "/users/me",
        profile: e => `/users/${e}`,
        updateProfile: "/users/me",
        privacy: "/users/me/privacy",
        follow: e => `/users/${e}/follow`,
        followers: e => `/users/${e}/followers`,
        following: e => `/users/${e}/following`,
        whoToFollow: "/users/suggestions/who-to-follow",
        topClans: "/users/stats/top-clans",
        search: "/users/search",
        pins: "/users/me/pins",
        setPin: "/users/me/pin"
    },
    posts: {
        list: "/posts",
        single: e => `/posts/${e}`,
        create: "/posts",
        update: e => `/posts/${e}`,
        delete: e => `/posts/${e}`,
        restore: e => `/posts/${e}/restore`,
        like: e => `/posts/${e}/like`,
        repost: e => `/posts/${e}/repost`,
        view: e => `/posts/${e}/view`,
        pin: e => `/posts/${e}/pin`,
        byUser: e => `/posts/user/${e}`,
        likedByUser: e => `/posts/user/${e}/liked`,
        wallByUser: e => `/posts/user/${e}/wall`,
        comments: e => `/posts/${e}/comments`
    },
    comments: {
        delete: e => `/comments/${e}`,
        restore: e => `/comments/${e}/restore`,
        like: e => `/comments/${e}/like`,
        replies: e => `/comments/${e}/replies`
    },
    notifications: {
        list: "/notifications/",
        count: "/notifications/count",
        markRead: e => `/notifications/${e}/read`,
        markReadBatch: "/notifications/read-batch",
        markAllRead: "/notifications/read-all",
        stream: "/notifications/stream"
    },
    files: {
        upload: "/files/upload",
        get: e => `/files/${e}`,
        delete: e => `/files/${e}`
    },
    reports: {
        create: "/reports"
    },
    hashtags: {
        search: "/hashtags",
        trending: "/hashtags/trending",
        posts: e => `/hashtags/${encodeURIComponent(e)}/posts`
    },
    search: {
        global: "/search"
    },
    verification: {
        status: "/verification/status",
        submit: "/verification/submit"
    }
};
let x = !1
  , R = null;
async function M() {
    return x && R || (x = !0,
    R = (async () => {
        try {
            const e = await fetch(`${J}/refresh`, {
                method: "POST",
                credentials: "include",
                headers: {
                    "Content-Type": "application/json"
                }
            });
            if (!e.ok)
                return o.logout(),
                null;
            const s = (await e.json()).accessToken;
            return s ? (o.setAccessToken(s),
            s) : null
        } catch {
            return null
        } finally {
            x = !1,
            R = null
        }
    }
    )()),
    R
}
const de = [502, 503, 504];
class K {
    baseUrl;
    constructor(r) {
        this.baseUrl = r
    }
    getHeaders(r=!0) {
        const s = {
            "Content-Type": "application/json"
        };
        if (r) {
            const t = o.getAccessToken();
            t && (s.Authorization = `Bearer ${t}`)
        }
        return s
    }
    logError(r, s) {}
    async handleResponse(r) {
        if (r.status === 204)
            return {
                data: void 0
            };
        if (de.includes(r.status))
            return this.logError(`Server error (${r.status})`, "Backend unavailable"),
            {
                error: {
                    code: "SERVER_ERROR",
                    message: "Сервер временно недоступен"
                }
            };
        const s = await r.json().catch( () => null);
        if (r.status === 401) {
            const a = s?.error || {
                code: "UNAUTHORIZED",
                message: s?.message || "Требуется авторизация"
            };
            return this.logError("Unauthorized (401)", a),
            {
                error: a
            }
        }
        if (!r.ok) {
            const a = s?.error || {
                code: "UNKNOWN_ERROR",
                message: s?.message || "An unknown error occurred"
            };
            return this.logError(`Request failed (${r.status})`, a),
            {
                error: a
            }
        }
        return {
            data: s?.data !== void 0 ? s.data : s
        }
    }
    async executeWithRefresh(r, s, t, a) {
        const n = a?.skipAuth ?? !1;
        let i = await this.executeRequest(r, s, t, {
            ...a,
            skipAuth: n
        });
        return i.error?.code === "UNAUTHORIZED" && !n && await M() && (i = await this.executeRequest(r, s, t, a)),
        i
    }
    async executeRequest(r, s, t, a) {
        try {
            const n = await fetch(s, {
                method: r,
                headers: this.getHeaders(!a?.skipAuth),
                credentials: "include",
                body: t ? JSON.stringify(t) : void 0,
                signal: a?.signal
            });
            return this.handleResponse(n)
        } catch (n) {
            if (n instanceof Error && n.name === "AbortError")
                throw n;
            return this.logError(`Network error (${r})`, n),
            {
                error: {
                    code: "NETWORK_ERROR",
                    message: "Не удалось подключиться к серверу"
                }
            }
        }
    }
    async get(r, s, t) {
        let a = `${this.baseUrl}${r}`;
        if (s) {
            const n = new URLSearchParams;
            Object.entries(s).forEach( ([i,u]) => {
                n.append(i, String(u))
            }
            ),
            a += `?${n.toString()}`
        }
        return this.executeWithRefresh("GET", a, void 0, t)
    }
    async post(r, s, t) {
        return this.executeWithRefresh("POST", `${this.baseUrl}${r}`, s, t)
    }
    async put(r, s, t) {
        return this.executeWithRefresh("PUT", `${this.baseUrl}${r}`, s, t)
    }
    async patch(r, s, t) {
        return this.executeWithRefresh("PATCH", `${this.baseUrl}${r}`, s, t)
    }
    async delete(r, s) {
        return this.executeWithRefresh("DELETE", `${this.baseUrl}${r}`, void 0, s)
    }
}
const l = new K(F)
  , f = new K(J)
  , xe = {
    async signUp(e) {
        o.setLoading(!0);
        const r = await f.post(c.auth.signUp, {
            email: e.email,
            password: e.password,
            turnstileToken: e.turnstileToken
        }, {
            skipAuth: !0
        });
        return o.setLoading(!1),
        r.error ? {
            success: !1,
            error: r.error.message
        } : {
            success: !0,
            requiresVerification: !0,
            email: r.data?.email || e.email,
            flowToken: r.data?.flowToken
        }
    },
    async verifyOtp(e) {
        o.setLoading(!0);
        const r = await f.post(c.auth.verifyOtp, {
            email: e.email,
            password: e.password,
            otp: e.otp,
            flowToken: e.flowToken
        }, {
            skipAuth: !0
        });
        if (r.error) {
            o.setLoading(!1);
            const a = r.error;
            return {
                success: !1,
                error: r.error.message,
                errorCode: r.error.code,
                attemptsLeft: a.attemptsLeft
            }
        }
        if (!r.data?.accessToken)
            return o.setLoading(!1),
            {
                success: !1,
                error: "Unexpected error"
            };
        const s = r.data.accessToken;
        o.setAccessToken(s);
        const t = await l.get("/profile");
        return o.setLoading(!1),
        t.error ? {
            success: !1,
            error: t.error.message
        } : t.data?.profileRequired ? (o.setProfileRequired(s),
        {
            success: !0,
            profileRequired: !0
        }) : t.data?.user ? (o.login(t.data.user, s),
        {
            success: !0
        }) : {
            success: !1,
            error: "Unexpected error"
        }
    },
    async resendOtp(e) {
        const r = await f.post(c.auth.resendOtp, {
            email: e.email,
            flowToken: e.flowToken
        }, {
            skipAuth: !0
        });
        if (r.error) {
            const s = r.error;
            return {
                success: !1,
                error: r.error.message,
                retryAfter: s.retryAfter
            }
        }
        return {
            success: !0
        }
    },
    async signIn(e) {
        o.setLoading(!0);
        const r = await f.post(c.auth.signIn, {
            email: e.email,
            password: e.password,
            turnstileToken: e.turnstileToken
        }, {
            skipAuth: !0
        });
        if (r.error)
            return o.setLoading(!1),
            {
                success: !1,
                error: r.error.message,
                errorCode: r.error.code
            };
        if (!r.data)
            return o.setLoading(!1),
            {
                success: !1,
                error: "Unexpected error"
            };
        if ("requiresVerification"in r.data && r.data.requiresVerification)
            return o.setLoading(!1),
            {
                success: !0,
                requiresVerification: !0,
                email: r.data.email,
                flowToken: r.data.flowToken
            };
        const s = r.data;
        if (!s.accessToken)
            return o.setLoading(!1),
            {
                success: !1,
                error: "Unexpected error"
            };
        const t = s.accessToken;
        o.setAccessToken(t);
        const a = await l.get("/profile");
        return o.setLoading(!1),
        a.error ? {
            success: !1,
            error: a.error.message
        } : a.data?.profileRequired ? (o.setProfileRequired(t),
        {
            success: !0,
            profileRequired: !0
        }) : a.data?.user ? (o.login(a.data.user, t),
        {
            success: !0
        }) : {
            success: !1,
            error: "Failed to fetch user profile"
        }
    },
    async logout() {
        await f.post(c.auth.logout, void 0, {
            skipAuth: !0
        }),
        o.logout()
    },
    async checkAuth() {
        const e = await M();
        if (!e)
            return o.logout(),
            {
                authenticated: !1,
                user: null
            };
        const r = await l.get("/profile");
        return r.error ? r.error.code === "UNAUTHORIZED" ? (o.logout(),
        {
            authenticated: !1,
            user: null
        }) : {
            authenticated: !1,
            user: null,
            networkError: !0
        } : r.data ? r.data.banned ? (o.logout(),
        {
            authenticated: !1,
            user: null
        }) : r.data.profileRequired ? (o.setProfileRequired(e),
        {
            authenticated: !0,
            user: null,
            profileRequired: !0
        }) : r.data.user ? (o.login(r.data.user, e),
        {
            authenticated: !0,
            user: r.data.user
        }) : (o.logout(),
        {
            authenticated: !1,
            user: null
        }) : (o.logout(),
        {
            authenticated: !1,
            user: null
        })
    },
    async fetchCurrentUser() {
        const e = await l.get(c.users.me);
        return e.error ? (e.error.code === "UNAUTHORIZED" && o.logout(),
        {
            success: !1,
            error: e.error.message
        }) : e.data ? (o.setUser(e.data),
        {
            success: !0
        }) : {
            success: !1,
            error: "Failed to fetch user"
        }
    },
    async createProfile(e) {
        o.setLoading(!0);
        const r = await l.post("/users/profile", {
            displayName: e.displayName,
            avatar: e.avatar,
            username: e.username || void 0,
            gender: e.gender || void 0
        });
        if (o.setLoading(!1),
        r.error)
            return {
                success: !1,
                error: r.error.message,
                errorCode: r.error.code
            };
        if (r.data) {
            const s = o.getAccessToken();
            return o.login(r.data, s || void 0),
            {
                success: !0
            }
        }
        return {
            success: !1,
            error: "Failed to create profile"
        }
    },
    async forgotPassword(e) {
        const r = await f.post(c.auth.forgotPassword, {
            email: e.email,
            turnstileToken: e.turnstileToken
        }, {
            skipAuth: !0
        });
        return r.error ? {
            success: !1,
            error: r.error.message,
            errorCode: r.error.code
        } : {
            success: !0,
            email: r.data?.email || e.email,
            flowToken: r.data?.flowToken
        }
    },
    async resetPassword(e) {
        const r = await f.post(c.auth.resetPassword, {
            email: e.email,
            flowToken: e.flowToken,
            otp: e.otp,
            newPassword: e.newPassword
        }, {
            skipAuth: !0
        });
        if (r.error) {
            const s = r.error;
            return {
                success: !1,
                error: r.error.message,
                errorCode: r.error.code,
                attemptsLeft: s.attemptsLeft,
                retryAfter: s.retryAfter
            }
        }
        return {
            success: !0
        }
    },
    async resendForgotPasswordOtp(e) {
        const r = await f.post(c.auth.resendOtp, {
            email: e.email,
            flowToken: e.flowToken
        }, {
            skipAuth: !0
        });
        if (r.error) {
            const s = r.error;
            return {
                success: !1,
                error: r.error.message,
                retryAfter: s.retryAfter
            }
        }
        return {
            success: !0
        }
    }
}
  , g = T([])
  , E = T(0)
  , H = T(!1)
  , he = T(!0)
  , C = T([])
  , pe = 3
  , ge = 15e3;
let _ = !1
  , W = Date.now();
const w = new Map;
function me() {
    if (typeof window > "u")
        return;
    const e = () => {
        _ = !0,
        W = Date.now()
    }
    ;
    window.addEventListener("mousemove", e, {
        passive: !0
    }),
    window.addEventListener("click", e, {
        passive: !0
    }),
    window.addEventListener("keydown", e, {
        passive: !0
    }),
    window.addEventListener("scroll", e, {
        passive: !0
    }),
    window.addEventListener("touchstart", e, {
        passive: !0
    }),
    setInterval( () => {
        Date.now() - W > 2e3 && (_ = !1),
        _ && !w.size && v(C).forEach(t => {
            Y(t.id)
        }
        )
    }
    , 1e3)
}
function Y(e) {
    const r = w.get(e);
    if (r && clearTimeout(r),
    !_)
        return;
    const s = setTimeout( () => {
        C.update(t => t.filter(a => a.id !== e)),
        w.delete(e)
    }
    , ge);
    w.set(e, s)
}
function we(e) {
    const r = w.get(e);
    r && (clearTimeout(r),
    w.delete(e))
}
function ke(e) {
    C.update(r => [e, ...r].slice(0, pe)),
    _ && Y(e.id)
}
typeof window < "u" && me();
let k = null
  , U = null
  , h = 0
  , m = !1
  , S = !1;
const ve = 10
  , Te = 2e3
  , Ae = 3e4;
function ye(e) {
    const r = e.split(`
`);
    let s = "message"
      , t = "";
    for (const a of r)
        a.startsWith("event:") ? s = a.slice(6).trim() : a.startsWith("data:") && (t = a.slice(5).trim());
    return t ? {
        event: s,
        data: t
    } : null
}
function Re(e, r) {
    if (e !== "connected" && e === "notification")
        try {
            const s = JSON.parse(r);
            g.update(t => [s, ...t]),
            E.update(t => t + 1),
            ke(s)
        } catch {}
}
async function Z() {
    let e = v(o);
    if (!e.user || !e.accessToken || m || S)
        return;
    m = !0;
    const r = `${F}${c.notifications.stream}`;
    try {
        k = new AbortController;
        let t = await fetch(r, {
            method: "GET",
            headers: {
                Accept: "text/event-stream",
                "Cache-Control": "no-cache",
                Authorization: `Bearer ${e.accessToken}`
            },
            signal: k.signal
        });
        if (t.status === 401) {
            const u = await M();
            if (u)
                t = await fetch(r, {
                    method: "GET",
                    headers: {
                        Accept: "text/event-stream",
                        "Cache-Control": "no-cache",
                        Authorization: `Bearer ${u}`
                    },
                    signal: k.signal
                });
            else {
                m = !1;
                return
            }
        }
        if (!t.ok)
            throw new Error(`HTTP ${t.status}: ${t.statusText}`);
        if (!t.body)
            throw new Error("No response body");
        S = !0,
        m = !1,
        h = 0;
        const a = t.body.getReader()
          , n = new TextDecoder;
        let i = "";
        for (; ; ) {
            const {done: u, value: $} = await a.read();
            if (u)
                break;
            i += n.decode($, {
                stream: !0
            });
            const d = i.split(`

`);
            i = d.pop() || "";
            for (const N of d)
                if (N.trim()) {
                    if (N.startsWith(":"))
                        continue;
                    const O = ye(N);
                    O && Re(O.event, O.data)
                }
        }
    } catch (t) {
        if (t.name === "AbortError")
            return
    } finally {
        m = !1,
        S = !1
    }
    if (v(o).user)
        if (h < ve) {
            const t = Math.min(Te * Math.pow(1.5, h), Ae);
            h++,
            U = setTimeout(Z, t)
        } else
            h = 0
}
function Ee() {
    U && (clearTimeout(U),
    U = null),
    k && (k.abort(),
    k = null),
    h = 0,
    m = !1,
    S = !1
}
function qe() {
    return S
}
function Me() {
    h = 0,
    Ee(),
    Z()
}
const Ie = {
    async fetchNotifications(e=0, r=20) {
        if (!v(o).user)
            return {
                success: !1,
                error: "Not authenticated"
            };
        H.set(!0);
        const t = await l.get(`${c.notifications.list}?offset=${e}&limit=${r}`);
        return H.set(!1),
        t.error ? {
            success: !1,
            error: t.error.message
        } : t.data ? (e === 0 ? g.set(t.data.notifications) : g.update(a => [...a, ...t.data.notifications]),
        he.set(t.data.hasMore),
        {
            success: !0
        }) : {
            success: !1,
            error: "Unexpected error"
        }
    },
    async fetchUnreadCount() {
        if (!v(o).user)
            return 0;
        const r = await l.get(c.notifications.count);
        return r.data ? (E.set(r.data.count),
        r.data.count) : 0
    },
    async markAsRead(e) {
        return (await l.post(c.notifications.markRead(e))).data?.success ? (g.update(s => s.map(t => t.id === e ? {
            ...t,
            read: !0
        } : t)),
        E.update(s => Math.max(0, s - 1)),
        !0) : !1
    },
    async markAllAsRead() {
        return (await l.post(c.notifications.markAllRead)).data?.success ? (g.update(r => r.map(s => ({
            ...s,
            read: !0
        }))),
        E.set(0),
        !0) : !1
    },
    async markBatchAsRead(e) {
        if (e.length === 0)
            return 0;
        const r = await l.post(c.notifications.markReadBatch, {
            ids: e
        });
        if (r.data?.success) {
            const s = r.data.count;
            return g.update(t => t.map(a => e.includes(a.id) ? {
                ...a,
                read: !0
            } : a)),
            E.update(t => Math.max(0, t - s)),
            s
        }
        return 0
    },
    removeToast(e) {
        we(e),
        C.update(r => r.filter(s => s.id !== e))
    },
    getNotificationText(e) {
        const r = e.actor.displayName;
        switch (e.type) {
        case "like":
            return `${r} оценил ваш пост`;
        case "comment":
            return `${r} прокомментировал ваш пост`;
        case "reply":
            return `${r} ответил на ваш комментарий`;
        case "follow":
            return `${r} подписался на вас`;
        case "repost":
            return `${r} сделал репост вашего поста`;
        case "mention":
            return `${r} упомянул вас`;
        case "wall_post":
            return `${r} написал на вашей стене`;
        case "verification_approved":
            return "Ваша заявка на верификацию одобрена!";
        case "verification_rejected":
            return e.preview || "Ваша заявка на верификацию отклонена";
        default:
            return `${r} отправил уведомление`
        }
    },
    getNotificationLink(e) {
        return e.type === "follow" ? `/${e.actor.username || e.actor.id}` : e.type === "verification_approved" || e.type === "verification_rejected" ? "/settings" : e.targetId ? `/post/${e.targetId}` : "/"
    }
};
export {c as A, l as a, Ue as b, xe as c, $e as d, Oe as e, g as f, H as g, he as h, Ce as i, Z as j, qe as k, Me as l, be as m, Ie as n, o, Pe as p, Ee as q, Se as r, I as s, Ne as t, Le as u, f as v, F as w, M as x, E as y, C as z};
import {m as T, n as e, ac as b, ad as l, ae as E, af as S, ag as k, w as y, ah as A, v as c, a3 as g, ai as v, I as R, aj as N, S as w} from "./DsUZB3l6.js";
function B(a, r, t=!1) {
    e && b();
    var u = new A(a)
      , i = t ? l : 0;
    function s(f, n) {
        if (e) {
            const d = E(a) === S;
            if (f === d) {
                var h = k();
                y(h),
                u.anchor = h,
                c(!1),
                u.ensure(f, n),
                c(!0);
                return
            }
        }
        u.ensure(f, n)
    }
    T( () => {
        var f = !1;
        r( (n, h=!0) => {
            f = !0,
            s(h, n)
        }
        ),
        f || s(!1, null)
    }
    , i)
}
function _(a, r) {
    return a === r || a?.[w] === r
}
function F(a={}, r, t, u) {
    return g( () => {
        var i, s;
        return v( () => {
            i = s,
            s = [],
            R( () => {
                a !== t(...s) && (r(a, ...s),
                i && _(t(...i), a) && r(null, ...i))
            }
            )
        }
        ),
        () => {
            N( () => {
                s && _(t(...s), a) && r(null, ...s)
            }
            )
        }
    }
    ),
    a
}
export {F as b, B as i};
import {a, A as t} from "./BHGMQYcz.js";
const s = {
    async createReport(e) {
        const r = await a.post(t.reports.create, e);
        return r.error ? {
            error: r.error.message
        } : {
            data: r.data?.data
        }
    }
};
export {s as r};
import {s as e} from "./Dbk_u4kD.js";
const r = () => {
    const s = e;
    return {
        page: {
            subscribe: s.page.subscribe
        },
        navigating: {
            subscribe: s.navigating.subscribe
        },
        updated: s.updated
    }
}
  , b = {
    subscribe(s) {
        return r().page.subscribe(s)
    }
};
export {b as p};
import {l as u, m as o, H as _, n as t, q as g, C as m, t as a, v as i, w as n, x as p} from "./DsUZB3l6.js";
function E(d, r) {
    let s = null
      , f = t;
    var l;
    if (t) {
        s = p;
        for (var e = g(document.head); e !== null && (e.nodeType !== m || e.data !== d); )
            e = a(e);
        if (e === null)
            i(!1);
        else {
            var y = a(e);
            e.remove(),
            n(y)
        }
    }
    t || (l = document.head.appendChild(u()));
    try {
        o( () => r(l), _)
    } finally {
        f && (i(!0),
        n(s))
    }
}
export {E as h};
import {y as L, z as m, P as D, g as P, A as T, B, D as b, k as M, E as N, F as Y, G as U, I as h, J as x, K as z, L as G, M as $, N as q, S as w, O as y} from "./DsUZB3l6.js";
import {c as C} from "./SPpZcdEB.js";
function K(r, a, t, s) {
    var f = !x || (t & z) !== 0, v = (t & U) !== 0, O = (t & $) !== 0, n = s, l = !0, I = () => (l && (l = !1,
    n = O ? h(s) : s),
    n), u;
    if (v) {
        var o = w in r || y in r;
        u = L(r, a)?.set ?? (o && a in r ? e => r[a] = e : void 0)
    }
    var _, g = !1;
    v ? [_,g] = C( () => r[a]) : _ = r[a],
    _ === void 0 && s !== void 0 && (_ = I(),
    u && (f && m(),
    u(_)));
    var i;
    if (f ? i = () => {
        var e = r[a];
        return e === void 0 ? I() : (l = !0,
        e)
    }
    : i = () => {
        var e = r[a];
        return e !== void 0 && (n = void 0),
        e === void 0 ? n : e
    }
    ,
    f && (t & D) === 0)
        return i;
    if (u) {
        var A = r.$$legacy;
        return (function(e, S) {
            return arguments.length > 0 ? ((!f || !S || A || g) && u(S ? i() : e),
            e) : i()
        }
        )
    }
    var c = !1
      , d = ((t & G) !== 0 ? T : B)( () => (c = !1,
    i()));
    v && P(d);
    var R = N;
    return (function(e, S) {
        if (arguments.length > 0) {
            const E = S ? P(d) : f && v ? b(e) : e;
            return M(d, E),
            c = !0,
            n !== void 0 && (n = E),
            e
        }
        return q && c || (R.f & Y) !== 0 ? d.v : P(d)
    }
    )
}
export {K as p};
import {m as y, n as S, ac as rr, g as U, B as fr, ae as er, af as nr, ag as X, w as z, v as q, x as L, C as ar, ak as ir, al as $, am as ur, l as F, an as T, ao as V, ap as lr, aq as x, R as sr, ar as k, as as tr, at as or, au as vr, av as cr, aw as P, ax as Q, ay as B, t as dr, az as gr, aA as pr, q as hr, aj as Er, aB as W, aC as Ar} from "./DsUZB3l6.js";
function wr(r, n) {
    return n
}
function br(r, n, e) {
    for (var f = [], t = n.length, i, u = n.length, v = 0; v < t; v++) {
        let g = n[v];
        Q(g, () => {
            if (i) {
                if (i.pending.delete(g),
                i.done.add(g),
                i.pending.size === 0) {
                    var o = r.outrogroups;
                    Y(k(i.done)),
                    o.delete(i),
                    o.size === 0 && (r.outrogroups = null)
                }
            } else
                u -= 1
        }
        , !1)
    }
    if (u === 0) {
        var l = f.length === 0 && e !== null;
        if (l) {
            var d = e
              , s = d.parentNode;
            gr(s),
            s.append(d),
            r.items.clear()
        }
        Y(n, !l)
    } else
        i = {
            pending: new Set(n),
            done: new Set
        },
        (r.outrogroups ??= new Set).add(i)
}
function Y(r, n=!0) {
    for (var e = 0; e < r.length; e++)
        pr(r[e], n)
}
var G;
function Or(r, n, e, f, t, i=null) {
    var u = r
      , v = new Map
      , l = (n & W) !== 0;
    if (l) {
        var d = r;
        u = S ? z(hr(d)) : d.appendChild(F())
    }
    S && rr();
    var s = null, g = fr( () => {
        var c = e();
        return tr(c) ? c : c == null ? [] : k(c)
    }
    ), o, p = !0;
    function b() {
        a.fallback = s,
        Cr(a, o, u, n, f),
        s !== null && (o.length === 0 ? (s.f & T) === 0 ? P(s) : (s.f ^= T,
        H(s, null, u)) : Q(s, () => {
            s = null
        }
        ))
    }
    var C = y( () => {
        o = U(g);
        var c = o.length;
        let O = !1;
        if (S) {
            var R = er(u) === nr;
            R !== (c === 0) && (u = X(),
            z(u),
            q(!1),
            O = !0)
        }
        for (var A = new Set, I = ur, M = lr(), E = 0; E < c; E += 1) {
            S && L.nodeType === ar && L.data === ir && (u = L,
            O = !0,
            q(!1));
            var w = o[E]
              , D = f(w, E)
              , h = p ? null : v.get(D);
            h ? (h.v && $(h.v, w),
            h.i && $(h.i, E),
            M && I.skipped_effects.delete(h.e)) : (h = Tr(v, p ? u : G ??= F(), w, D, E, t, n, e),
            p || (h.e.f |= T),
            v.set(D, h)),
            A.add(D)
        }
        if (c === 0 && i && !s && (p ? s = V( () => i(u)) : (s = V( () => i(G ??= F())),
        s.f |= T)),
        S && c > 0 && z(X()),
        !p)
            if (M) {
                for (const [_,j] of v)
                    A.has(_) || I.skipped_effects.add(j.e);
                I.oncommit(b),
                I.ondiscard( () => {}
                )
            } else
                b();
        O && q(!0),
        U(g)
    }
    )
      , a = {
        effect: C,
        items: v,
        outrogroups: null,
        fallback: s
    };
    p = !1,
    S && (u = L)
}
function Cr(r, n, e, f, t) {
    var i = (f & Ar) !== 0, u = n.length, v = r.items, l = r.effect.first, d, s = null, g, o = [], p = [], b, C, a, c;
    if (i)
        for (c = 0; c < u; c += 1)
            b = n[c],
            C = t(b, c),
            a = v.get(C).e,
            (a.f & T) === 0 && (a.nodes?.a?.measure(),
            (g ??= new Set).add(a));
    for (c = 0; c < u; c += 1) {
        if (b = n[c],
        C = t(b, c),
        a = v.get(C).e,
        r.outrogroups !== null)
            for (const h of r.outrogroups)
                h.pending.delete(a),
                h.done.delete(a);
        if ((a.f & T) !== 0)
            if (a.f ^= T,
            a === l)
                H(a, null, e);
            else {
                var O = s ? s.next : l;
                a === r.effect.last && (r.effect.last = a.prev),
                a.prev && (a.prev.next = a.next),
                a.next && (a.next.prev = a.prev),
                N(r, s, a),
                N(r, a, O),
                H(a, O, e),
                s = a,
                o = [],
                p = [],
                l = s.next;
                continue
            }
        if ((a.f & B) !== 0 && (P(a),
        i && (a.nodes?.a?.unfix(),
        (g ??= new Set).delete(a))),
        a !== l) {
            if (d !== void 0 && d.has(a)) {
                if (o.length < p.length) {
                    var R = p[0], A;
                    s = R.prev;
                    var I = o[0]
                      , M = o[o.length - 1];
                    for (A = 0; A < o.length; A += 1)
                        H(o[A], R, e);
                    for (A = 0; A < p.length; A += 1)
                        d.delete(p[A]);
                    N(r, I.prev, M.next),
                    N(r, s, I),
                    N(r, M, R),
                    l = R,
                    s = M,
                    c -= 1,
                    o = [],
                    p = []
                } else
                    d.delete(a),
                    H(a, l, e),
                    N(r, a.prev, a.next),
                    N(r, a, s === null ? r.effect.first : s.next),
                    N(r, s, a),
                    s = a;
                continue
            }
            for (o = [],
            p = []; l !== null && l !== a; )
                (d ??= new Set).add(l),
                p.push(l),
                l = l.next;
            if (l === null)
                continue
        }
        (a.f & T) === 0 && o.push(a),
        s = a,
        l = a.next
    }
    if (r.outrogroups !== null) {
        for (const h of r.outrogroups)
            h.pending.size === 0 && (Y(k(h.done)),
            r.outrogroups?.delete(h));
        r.outrogroups.size === 0 && (r.outrogroups = null)
    }
    if (l !== null || d !== void 0) {
        var E = [];
        if (d !== void 0)
            for (a of d)
                (a.f & B) === 0 && E.push(a);
        for (; l !== null; )
            (l.f & B) === 0 && l !== r.fallback && E.push(l),
            l = l.next;
        var w = E.length;
        if (w > 0) {
            var D = (f & W) !== 0 && u === 0 ? e : null;
            if (i) {
                for (c = 0; c < w; c += 1)
                    E[c].nodes?.a?.measure();
                for (c = 0; c < w; c += 1)
                    E[c].nodes?.a?.fix()
            }
            br(r, E, D)
        }
    }
    i && Er( () => {
        if (g !== void 0)
            for (a of g)
                a.nodes?.a?.apply()
    }
    )
}
function Tr(r, n, e, f, t, i, u, v) {
    var l = (u & or) !== 0 ? (u & vr) === 0 ? sr(e, !1, !1) : x(e) : null
      , d = (u & cr) !== 0 ? x(t) : null;
    return {
        v: l,
        i: d,
        e: V( () => (i(n, l ?? e, d ?? t, v),
        () => {
            r.delete(f)
        }
        ))
    }
}
function H(r, n, e) {
    if (r.nodes)
        for (var f = r.nodes.start, t = r.nodes.end, i = n && (n.f & T) === 0 ? n.nodes.start : e; f !== null; ) {
            var u = dr(f);
            if (i.before(f),
            f === t)
                return;
            f = u
        }
}
function N(r, n, e) {
    n === null ? r.effect.first = e : n.next = e,
    e === null ? r.effect.last = n : e.prev = n
}
function Z(r) {
    var n, e, f = "";
    if (typeof r == "string" || typeof r == "number")
        f += r;
    else if (typeof r == "object")
        if (Array.isArray(r)) {
            var t = r.length;
            for (n = 0; n < t; n++)
                r[n] && (e = Z(r[n])) && (f && (f += " "),
                f += e)
        } else
            for (e in r)
                r[e] && (f && (f += " "),
                f += e);
    return f
}
function Nr() {
    for (var r, n, e = 0, f = "", t = arguments.length; e < t; e++)
        (r = arguments[e]) && (n = Z(r)) && (f && (f += " "),
        f += n);
    return f
}
function Rr(r) {
    return typeof r == "object" ? Nr(r) : r ?? ""
}
const J = [...` 	
\r\f \v\uFEFF`];
function Sr(r, n, e) {
    var f = r == null ? "" : "" + r;
    if (n && (f = f ? f + " " + n : n),
    e) {
        for (var t in e)
            if (e[t])
                f = f ? f + " " + t : t;
            else if (f.length)
                for (var i = t.length, u = 0; (u = f.indexOf(t, u)) >= 0; ) {
                    var v = u + i;
                    (u === 0 || J.includes(f[u - 1])) && (v === f.length || J.includes(f[v])) ? f = (u === 0 ? "" : f.substring(0, u)) + f.substring(v + 1) : u = v
                }
    }
    return f === "" ? null : f
}
function K(r, n=!1) {
    var e = n ? " !important;" : ";"
      , f = "";
    for (var t in r) {
        var i = r[t];
        i != null && i !== "" && (f += " " + t + ": " + i + e)
    }
    return f
}
function m(r) {
    return r[0] !== "-" || r[1] !== "-" ? r.toLowerCase() : r
}
function Mr(r, n) {
    if (n) {
        var e = "", f, t;
        if (Array.isArray(n) ? (f = n[0],
        t = n[1]) : f = n,
        r) {
            r = String(r).replaceAll(/\s*\/\*.*?\*\/\s*/g, "").trim();
            var i = !1
              , u = 0
              , v = !1
              , l = [];
            f && l.push(...Object.keys(f).map(m)),
            t && l.push(...Object.keys(t).map(m));
            var d = 0
              , s = -1;
            const C = r.length;
            for (var g = 0; g < C; g++) {
                var o = r[g];
                if (v ? o === "/" && r[g - 1] === "*" && (v = !1) : i ? i === o && (i = !1) : o === "/" && r[g + 1] === "*" ? v = !0 : o === '"' || o === "'" ? i = o : o === "(" ? u++ : o === ")" && u--,
                !v && i === !1 && u === 0) {
                    if (o === ":" && s === -1)
                        s = g;
                    else if (o === ";" || g === C - 1) {
                        if (s !== -1) {
                            var p = m(r.substring(d, s).trim());
                            if (!l.includes(p)) {
                                o !== ";" && g++;
                                var b = r.substring(d, g).trim();
                                e += " " + b + ";"
                            }
                        }
                        d = g + 1,
                        s = -1
                    }
                }
            }
        }
        return f && (e += K(f)),
        t && (e += K(t, !0)),
        e = e.trim(),
        e === "" ? null : e
    }
    return r == null ? null : String(r)
}
function Dr(r, n, e, f, t, i) {
    var u = r.__className;
    if (S || u !== e || u === void 0) {
        var v = Sr(e, f, i);
        (!S || v !== r.getAttribute("class")) && (v == null ? r.removeAttribute("class") : n ? r.className = v : r.setAttribute("class", v)),
        r.__className = e
    } else if (i && t !== i)
        for (var l in i) {
            var d = !!i[l];
            (t == null || d !== !!t[l]) && r.classList.toggle(l, d)
        }
    return i
}
export {Rr as c, Or as e, wr as i, Dr as s, Mr as t};
import "./DsnmJJEf.js";
import {a3 as nr, I as Xr, ai as Zr, aa as Kr, aS as Gr, n as Ga, aN as Qr, am as Ca, aO as Jr, as as $r, aT as es, aU as ts, V as as, a2 as Ve, Z as q, i as d, c as i, r as o, aQ as xt, U as wt, X as Ze, p as We, f as p, b as Pe, e as u, g as e, h as V, s as S, k as r, a as Ye, a1 as de, Y as Ge, aP as rs, D as rt, aR as Vt, _ as mt, j as He, d as ua, o as sa, a5 as Sa, u as ft, a0 as Wt, aH as Pa, $ as Jt, aV as Ia, aW as ss} from "./DsUZB3l6.js";
import {i as M, b as et} from "./BZbNXXnN.js";
import {s as se, a as Ae, A as Re, v as ns, o as ga, w as la, x as Qa, i as Ta, y as or, t as Ot, c as ir, d as $t, r as Qt, b as Nt, z as os, n as Zt} from "./BHGMQYcz.js";
import {t as is, s as ye, e as Qe, c as lr, i as bt} from "./DC-LS3Wc.js";
import {p as me} from "./CiAaDbzg.js";
import {a as Ke, s as Ct} from "./SPpZcdEB.js";
import {p as ma} from "./BzzorF5Q.js";
import {g as Ft, i as ls} from "./Dbk_u4kD.js";
import {i as cr} from "./B8CBK0oB.js";
function Yt(s, t, n) {
    nr( () => {
        var a = Xr( () => t(s, n?.()) || {});
        if (n && a?.update) {
            var l = !1
              , f = {};
            Zr( () => {
                var v = n();
                Kr(v),
                l && Gr(f, v) && (f = v,
                a.update(v))
            }
            ),
            l = !0
        }
        if (a?.destroy)
            return () => a.destroy()
    }
    )
}
function za(s, t={}, n, a) {
    for (var l in n) {
        var f = n[l];
        t[l] !== f && (n[l] == null ? s.style.removeProperty(l) : s.style.setProperty(l, f, a))
    }
}
function lt(s, t, n, a) {
    var l = s.__style;
    if (Ga || l !== t) {
        var f = is(t, a);
        (!Ga || f !== s.getAttribute("style")) && (f == null ? s.removeAttribute("style") : s.style.cssText = f),
        s.__style = t
    } else
        a && (Array.isArray(a) ? (za(s, n?.[0], a[0]),
        za(s, n?.[1], a[1], "important")) : za(s, n, a));
    return a
}
function dr(s, t, n=!1) {
    if (s.multiple) {
        if (t == null)
            return;
        if (!$r(t))
            return es();
        for (var a of s.options)
            a.selected = t.includes(aa(a));
        return
    }
    for (a of s.options) {
        var l = aa(a);
        if (ts(l, t)) {
            a.selected = !0;
            return
        }
    }
    (!n || t !== void 0) && (s.selectedIndex = -1)
}
function cs(s) {
    var t = new MutationObserver( () => {
        dr(s, s.__value)
    }
    );
    t.observe(s, {
        childList: !0,
        subtree: !0,
        attributes: !0,
        attributeFilter: ["value"]
    }),
    as( () => {
        t.disconnect()
    }
    )
}
function ds(s, t, n=t) {
    var a = new WeakSet
      , l = !0;
    Qr(s, "change", f => {
        var v = f ? "[selected]" : ":checked", c;
        if (s.multiple)
            c = [].map.call(s.querySelectorAll(v), aa);
        else {
            var h = s.querySelector(v) ?? s.querySelector("option:not([disabled])");
            c = h && aa(h)
        }
        n(c),
        Ca !== null && a.add(Ca)
    }
    ),
    nr( () => {
        var f = t();
        if (s === document.activeElement) {
            var v = Jr ?? Ca;
            if (a.has(v))
                return
        }
        if (dr(s, f, l),
        l && f === void 0) {
            var c = s.querySelector(":checked");
            c !== null && (f = aa(c),
            n(f))
        }
        s.__value = f,
        l = !1
    }
    ),
    cs(s)
}
function aa(s) {
    return "__value"in s ? s.__value : s.value
}
var vs = Ve('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none"><path fill="currentColor" fill-rule="evenodd" d="M14.595 16.187H9.406a.657.657 0 0 1-.67-.643c0-.355.3-.643.67-.643h5.189c.37 0 .67.288.67.643 0 .355-.3.643-.67.643Zm3.873-9.194c-.323-.275-.692-.585-1.131-.975-.199-.154-.417-.33-.648-.518C15.386 4.445 13.602 3 11.975 3c-1.608 0-3.278 1.365-4.619 2.46-.248.203-.48.393-.716.578-.416.37-.785.681-1.11.956C3.4 8.795 3 9.267 3 13.468 3 21 5.267 21 12 21c6.732 0 9 0 9-7.532 0-4.201-.4-4.674-2.532-6.475Z" clip-rule="evenodd"></path></svg>');
function vr(s, t) {
    let n = me(t, "size", 8, 24);
    var a = vs();
    q( () => {
        se(a, "width", n()),
        se(a, "height", n())
    }
    ),
    d(s, a)
}
var us = Ve('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="m19.5 19.5-3-3M11 4.5a6.5 6.5 0 1 1 0 13 6.5 6.5 0 0 1 0-13Z"></path></svg>');
function ur(s, t) {
    let n = me(t, "size", 8, 24);
    var a = us();
    q( () => {
        se(a, "width", n()),
        se(a, "height", n())
    }
    ),
    d(s, a)
}
var fs = Ve('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none"><path fill="currentColor" fill-rule="evenodd" d="M19.742 13.807c-.86-1.832-.837-2.52-.798-3.773.01-.296.02-.617.02-.986 0-2.926-2.16-7.048-6.963-7.048-4.804 0-6.965 4.122-6.965 7.048 0 .368.01.69.02.986.04 1.252.062 1.941-.807 3.797-.372.928-.327 1.73.135 2.382C5.492 17.783 8.7 18 12 18c3.3 0 6.508-.216 7.616-1.787.463-.653.508-1.454.125-2.406ZM15.056 19.005c-1.848.193-3.852.192-6.13-.002-.34-.026-.678.143-.835.437a.763.763 0 0 0 .125.893C9.236 21.407 10.578 22 11.994 22h.002c1.42 0 2.765-.592 3.788-1.667a.765.765 0 0 0 .122-.9c-.162-.294-.495-.458-.85-.428Z" clip-rule="evenodd"></path></svg>');
function fr(s, t) {
    let n = me(t, "size", 8, 24);
    var a = fs();
    q( () => {
        se(a, "width", n()),
        se(a, "height", n())
    }
    ),
    d(s, a)
}
var hs = Ve('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none"><path fill="currentColor" fill-rule="evenodd" d="M11.998 11a3.995 3.995 0 0 0 4-4c.084-2.213-1.702-4-4-4A3.995 3.995 0 0 0 8 7c0 2.213 1.787 4 3.998 4ZM18.938 17.878c-.3-1.04-.899-1.986-2.097-2.743C15.843 14.473 14.246 14 12.05 14c-4.292 0-6.389 1.892-6.987 3.878-.2.568.1 1.136.598 1.42C7.458 20.431 9.654 21 12.05 21c2.296 0 4.492-.662 6.288-1.703.5-.284.8-.851.6-1.419Z" clip-rule="evenodd"></path></svg>');
function gs(s, t) {
    let n = me(t, "size", 8, 24);
    var a = hs();
    q( () => {
        se(a, "width", n()),
        se(a, "height", n())
    }
    ),
    d(s, a)
}
var ms = Ve('<path fill="currentColor" fill-rule="evenodd" d="M17.57 3.221c-1.738-.533-4.103-.162-5.57 1.77-1.423-1.865-3.788-2.327-5.582-1.769C2.5 4.45 1.29 8.638 2.384 11.978 4.156 17.356 10.344 21 12.001 21c1.672 0 7.882-3.644 9.617-9.022 1.091-3.339-.123-7.527-4.048-8.757" clip-rule="evenodd"></path>')
  , _s = Ve('<path stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" d="M12 5.5C10.5 3.5 7.5 3 5.5 4.5S2.5 9 4 12c1.5 3 8 8 8 8s6.5-5 8-8 0-6-2-7.5-5-1-6 1"></path>')
  , ps = Ve('<svg viewBox="0 0 24 24" fill="none"><!></svg>');
function Ra(s, t) {
    let n = me(t, "size", 8, 18)
      , a = me(t, "filled", 8, !1);
    var l = ps()
      , f = i(l);
    {
        var v = h => {
            var m = ms();
            d(h, m)
        }
          , c = h => {
            var m = _s();
            d(h, m)
        }
        ;
        M(f, h => {
            a() ? h(v) : h(c, !1)
        }
        )
    }
    o(l),
    q( () => {
        se(l, "width", n()),
        se(l, "height", n())
    }
    ),
    d(s, l)
}
var ws = Ve('<svg viewBox="0 0 24 24" fill="none"><path stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"></path></svg>');
function hr(s, t) {
    let n = me(t, "size", 8, 18);
    var a = ws();
    q( () => {
        se(a, "width", n()),
        se(a, "height", n())
    }
    ),
    d(s, a)
}
var bs = Ve('<svg viewBox="0 0 24 24" fill="none"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m2 9 3-3 3 3"></path><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 18H7a2 2 0 0 1-2-2V6M22 15l-3 3-3-3"></path><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 6h6a2 2 0 0 1 2 2v10"></path></svg>');
function _a(s, t) {
    let n = me(t, "size", 8, 18);
    var a = bs();
    q( () => {
        se(a, "width", n()),
        se(a, "height", n())
    }
    ),
    d(s, a)
}
var ys = Ve('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="18" cy="5" r="3"></circle><circle cx="6" cy="12" r="3"></circle><circle cx="18" cy="19" r="3"></circle><line x1="8.59" y1="13.51" x2="15.42" y2="17.49"></line><line x1="15.41" y1="6.51" x2="8.59" y2="10.49"></line></svg>');
function gr(s, t) {
    let n = me(t, "size", 8, 18);
    var a = ys();
    q( () => {
        se(a, "width", n()),
        se(a, "height", n())
    }
    ),
    d(s, a)
}
var ks = Ve('<svg viewBox="0 0 24 24" fill="currentColor"><circle cx="12" cy="5" r="2"></circle><circle cx="12" cy="12" r="2"></circle><circle cx="12" cy="19" r="2"></circle></svg>');
function Da(s, t) {
    let n = me(t, "size", 8, 18);
    var a = ks();
    q( () => {
        se(a, "width", n()),
        se(a, "height", n())
    }
    ),
    d(s, a)
}
var xs = Ve('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 36 36" fill="none" aria-label="Верифицированный пользователь" role="img"><title>Верифицированный пользователь</title><path fill="#0080FF" d="M15.13 1.848c1.46-2.514 5.057-2.45 6.429.115l1.253 2.343a3.677 3.677 0 0 0 3.762 1.926l2.597-.373c2.842-.408 5.036 2.493 3.92 5.182L32.07 13.5a3.804 3.804 0 0 0 .865 4.192l1.906 1.833c2.086 2.006 1.224 5.56-1.54 6.348l-2.525.721c-1.484.424-2.554 1.74-2.683 3.302l-.22 2.658c-.242 2.91-3.51 4.44-5.84 2.734l-2.13-1.558a3.644 3.644 0 0 0-4.21-.075l-2.181 1.482c-2.387 1.622-5.601-.023-5.743-2.94l-.129-2.664c-.076-1.566-1.1-2.919-2.568-3.395l-2.499-.81c-2.735-.887-3.474-4.469-1.32-6.4l1.967-1.763a3.801 3.801 0 0 0 1.008-4.16l-.935-2.492C2.27 7.785 4.563 4.963 7.39 5.472l2.582.465a3.673 3.673 0 0 0 3.826-1.791l1.333-2.298Z"></path><path stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="m24 15-8 8-4-4"></path></svg>');
function mr(s, t) {
    let n = me(t, "size", 3, 16);
    var a = xs();
    q( () => {
        se(a, "width", n()),
        se(a, "height", n())
    }
    ),
    d(s, a)
}
var Cs = Ve('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>');
function Lt(s, t) {
    let n = me(t, "size", 8, 16);
    var a = Cs();
    q( () => {
        se(a, "width", n()),
        se(a, "height", n())
    }
    ),
    d(s, a)
}
var zs = Ve('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path></svg>');
function Ps(s, t) {
    let n = me(t, "size", 8, 18);
    var a = zs();
    q( () => {
        se(a, "width", n()),
        se(a, "height", n())
    }
    ),
    d(s, a)
}
var Ms = Ve('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z"></path><line x1="4" y1="22" x2="4" y2="15"></line></svg>');
function ja(s, t) {
    let n = me(t, "size", 8, 18);
    var a = Ms();
    q( () => {
        se(a, "width", n()),
        se(a, "height", n())
    }
    ),
    d(s, a)
}
var Ss = Ve('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path><line x1="10" y1="11" x2="10" y2="17"></line><line x1="14" y1="11" x2="14" y2="17"></line></svg>');
function qa(s, t) {
    let n = me(t, "size", 8, 18);
    var a = Ss();
    q( () => {
        se(a, "width", n()),
        se(a, "height", n())
    }
    ),
    d(s, a)
}
var Is = Ve('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="15 18 9 12 15 6"></polyline></svg>');
function Ts(s, t) {
    let n = me(t, "size", 8, 18);
    var a = Is();
    q( () => {
        se(a, "width", n()),
        se(a, "height", n())
    }
    ),
    d(s, a)
}
var Rs = Ve('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="17" x2="12" y2="22"></line><path d="M5 17h14v-1.76a2 2 0 0 0-1.11-1.79l-1.78-.9A2 2 0 0 1 15 10.76V6h1a2 2 0 0 0 0-4H8a2 2 0 0 0 0 4h1v4.76a2 2 0 0 1-1.11 1.79l-1.78.9A2 2 0 0 0 5 15.24Z"></path></svg>');
function Ja(s, t) {
    let n = me(t, "size", 8, 18);
    var a = Rs();
    q( () => {
        se(a, "width", n()),
        se(a, "height", n())
    }
    ),
    d(s, a)
}
const ut = {
    async getFeed(s={}) {
        const t = {
            limit: s.limit || 20,
            tab: s.tab || "popular"
        };
        s.cursor && (t.cursor = s.cursor);
        const n = await Ae.get(Re.posts.list, t);
        return n.error ? {
            error: n.error.message
        } : {
            data: n.data
        }
    },
    async getPost(s) {
        const t = await Ae.get(Re.posts.single(s));
        return t.error ? {
            error: t.error.message
        } : {
            data: t.data
        }
    },
    async getUserPosts(s, t={}) {
        const n = {
            limit: t.limit || 20,
            sort: t.sort || "new"
        };
        t.cursor && (n.cursor = t.cursor);
        const a = await Ae.get(Re.posts.byUser(s), n);
        return a.error ? {
            error: a.error.message
        } : {
            data: a.data
        }
    },
    async getLikedPosts(s, t={}) {
        const n = {
            limit: t.limit || 20
        };
        t.cursor && (n.cursor = t.cursor);
        const a = await Ae.get(Re.posts.likedByUser(s), n);
        return a.error ? {
            error: a.error.message
        } : {
            data: a.data
        }
    },
    async getWallPosts(s, t={}) {
        const n = {
            limit: t.limit || 20
        };
        t.cursor && (n.cursor = t.cursor);
        const a = await Ae.get(Re.posts.wallByUser(s), n);
        return a.error ? {
            error: a.error.message
        } : {
            data: a.data
        }
    },
    async createPost(s) {
        const t = await Ae.post(Re.posts.create, s);
        return t.error ? {
            error: t.error.message
        } : {
            data: t.data
        }
    },
    async updatePost(s, t) {
        const n = await Ae.put(Re.posts.update(s), {
            content: t
        });
        return n.error ? {
            error: n.error.message
        } : {
            data: n.data
        }
    },
    async deletePost(s) {
        const t = await Ae.delete(Re.posts.delete(s));
        return t.error ? {
            success: !1,
            error: t.error.message
        } : {
            success: !0
        }
    },
    async restorePost(s) {
        const t = await Ae.post(Re.posts.restore(s));
        return t.error ? {
            success: !1,
            error: t.error.message
        } : {
            success: !0
        }
    },
    async likePost(s, t) {
        const n = await Ae.post(Re.posts.like(s), void 0, {
            signal: t
        });
        return n.error ? {
            success: !1,
            error: n.error.message
        } : {
            success: !0
        }
    },
    async unlikePost(s, t) {
        const n = await Ae.delete(Re.posts.like(s), {
            signal: t
        });
        return n.error ? {
            success: !1,
            error: n.error.message
        } : {
            success: !0
        }
    },
    async repostPost(s, t) {
        const n = await Ae.post(Re.posts.repost(s), {
            content: t
        });
        return n.error ? {
            success: !1,
            error: n.error.message
        } : {
            success: !0,
            data: n.data
        }
    },
    async unrepostPost(s) {
        const t = await Ae.delete(Re.posts.repost(s));
        return t.error ? {
            success: !1,
            error: t.error.message
        } : {
            success: !0
        }
    },
    _viewedPosts: new Set,
    _MAX_VIEWED_POSTS: 5e3,
    async recordView(s) {
        if (!this._viewedPosts.has(s)) {
            if (this._viewedPosts.size >= this._MAX_VIEWED_POSTS) {
                const t = this._viewedPosts.values();
                for (let n = 0; n < 200; n++) {
                    const a = t.next().value;
                    a && this._viewedPosts.delete(a)
                }
            }
            this._viewedPosts.add(s),
            Ae.post(Re.posts.view(s)).catch( () => {}
            )
        }
    },
    isViewed(s) {
        return this._viewedPosts.has(s)
    },
    async pinPost(s) {
        const t = await Ae.post(Re.posts.pin(s));
        return t.error ? {
            success: !1,
            error: t.error.message
        } : {
            success: !0,
            pinnedPostId: t.data?.pinnedPostId
        }
    },
    async unpinPost(s) {
        const t = await Ae.delete(Re.posts.pin(s));
        return t.error ? {
            success: !1,
            error: t.error.message
        } : {
            success: !0
        }
    }
}
  , Ht = {
    async getProfile(s) {
        const t = await Ae.get(Re.users.profile(s));
        return t.error ? {
            error: t.error.message
        } : {
            data: t.data
        }
    },
    async updateProfile(s) {
        const t = await Ae.put(Re.users.updateProfile, s);
        return t.error ? {
            error: t.error.message
        } : (t.data && ga.setUser(t.data),
        {
            data: t.data
        })
    },
    async changePassword(s) {
        const t = await ns.post(Re.auth.changePassword, s);
        return t.error ? {
            success: !1,
            error: t.error.message,
            errorCode: t.error.code
        } : {
            success: !0
        }
    },
    async follow(s) {
        const t = await Ae.post(Re.users.follow(s));
        return t.error ? {
            success: !1,
            error: t.error.message
        } : {
            success: !0
        }
    },
    async unfollow(s) {
        const t = await Ae.delete(Re.users.follow(s));
        return t.error ? {
            success: !1,
            error: t.error.message
        } : {
            success: !0
        }
    },
    async getFollowers(s, t=1, n=20) {
        const a = await Ae.get(Re.users.followers(s), {
            page: t,
            limit: n
        });
        return a.error ? {
            error: a.error.message
        } : {
            data: a.data
        }
    },
    async getFollowing(s, t=1, n=20) {
        const a = await Ae.get(Re.users.following(s), {
            page: t,
            limit: n
        });
        return a.error ? {
            error: a.error.message
        } : {
            data: a.data
        }
    },
    async getWhoToFollow() {
        const s = await Ae.get(Re.users.whoToFollow);
        return s.error ? {
            error: s.error.message
        } : {
            data: s.data?.users
        }
    },
    async getTopClans() {
        const s = await Ae.get(Re.users.topClans);
        return s.error ? {
            error: s.error.message
        } : {
            data: s.data?.clans
        }
    },
    async searchUsers(s, t=10) {
        const n = await Ae.get(Re.users.search, {
            q: s,
            limit: t
        });
        return n.error ? {
            error: n.error.message
        } : {
            data: n.data?.data?.users
        }
    },
    async getPrivacySettings() {
        const s = await Ae.get(Re.users.privacy);
        return s.error ? {
            error: s.error.message
        } : {
            data: s.data
        }
    },
    async updatePrivacySettings(s) {
        const t = await Ae.put(Re.users.privacy, s);
        return t.error ? {
            error: t.error.message
        } : {
            data: t.data
        }
    },
    async getMyPins() {
        const s = await Ae.get(Re.users.pins);
        if (s.error)
            return {
                error: s.error.message
            };
        const t = s.data?.activePin || null;
        return {
            data: (s.data?.pins || []).map(a => ({
                slug: a.slug,
                name: a.name,
                description: a.description,
                isActive: a.slug === t
            }))
        }
    },
    async setActivePin(s) {
        const t = await Ae.put(Re.users.setPin, {
            slug: s
        });
        return t.error ? {
            success: !1,
            error: t.error.message
        } : {
            success: !0
        }
    },
    async removeActivePin() {
        const s = await Ae.delete(Re.users.setPin);
        return s.error ? {
            success: !1,
            error: s.error.message
        } : {
            success: !0
        }
    }
}
  , Tt = {
    async getPostComments(s, t=20, n="popular", a, l) {
        const f = {
            limit: t,
            sort: n
        };
        a && (f.cursor = a);
        const v = await Ae.get(Re.posts.comments(s), f, {
            signal: l
        });
        return v.error ? {
            error: v.error.message
        } : {
            data: v.data
        }
    },
    async createComment(s, t) {
        const n = await Ae.post(Re.posts.comments(s), t);
        return n.error ? {
            error: n.error.message
        } : {
            data: n.data
        }
    },
    async deleteComment(s) {
        const t = await Ae.delete(Re.comments.delete(s));
        return t.error ? {
            success: !1,
            error: t.error.message
        } : {
            success: !0
        }
    },
    async restoreComment(s) {
        const t = await Ae.post(Re.comments.restore(s));
        return t.error ? {
            success: !1,
            error: t.error.message
        } : {
            success: !0
        }
    },
    async likeComment(s) {
        const t = await Ae.post(Re.comments.like(s));
        return t.error ? {
            success: !1,
            error: t.error.message
        } : {
            success: !0
        }
    },
    async unlikeComment(s) {
        const t = await Ae.delete(Re.comments.like(s));
        return t.error ? {
            success: !1,
            error: t.error.message
        } : {
            success: !0
        }
    },
    async getReplies(s, t=1, n=10, a="popular") {
        const l = await Ae.get(Re.comments.replies(s), {
            page: t,
            limit: n,
            sort: a
        });
        return l.error ? {
            error: l.error.message
        } : {
            data: l.data
        }
    },
    async createReply(s, t) {
        const n = await Ae.post(Re.comments.replies(s), t);
        return n.error ? {
            error: n.error.message
        } : {
            data: n.data
        }
    }
};
function ca() {
    const s = {}
      , t = ga.getAccessToken();
    return t && (s.Authorization = `Bearer ${t}`),
    s
}
const Dt = {
    async uploadFile(s) {
        const t = new FormData;
        t.append("file", s);
        try {
            let n = await fetch(`${la}${Re.files.upload}`, {
                method: "POST",
                credentials: "include",
                headers: ca(),
                body: t
            });
            if (n.status === 401 && await Qa()) {
                const f = new FormData;
                f.append("file", s),
                n = await fetch(`${la}${Re.files.upload}`, {
                    method: "POST",
                    credentials: "include",
                    headers: ca(),
                    body: f
                })
            }
            const a = await n.json().catch( () => null);
            return n.ok ? {
                data: a
            } : {
                error: a?.error?.message || "Failed to upload file",
                errorCode: a?.error?.code
            }
        } catch {
            return {
                error: "Network error during upload"
            }
        }
    },
    async deleteFile(s) {
        try {
            let t = await fetch(`${la}${Re.files.delete(s)}`, {
                method: "DELETE",
                credentials: "include",
                headers: ca()
            });
            return t.status === 401 && await Qa() && (t = await fetch(`${la}${Re.files.delete(s)}`, {
                method: "DELETE",
                credentials: "include",
                headers: ca()
            })),
            t.ok ? {
                success: !0
            } : {
                success: !1,
                error: (await t.json().catch( () => null))?.error?.message || "Failed to delete file"
            }
        } catch {
            return {
                success: !1,
                error: "Network error"
            }
        }
    }
}
  , _r = xt(!1)
  , pr = "nowkie_scroll_positions";
function wr() {
    try {
        const s = sessionStorage.getItem(pr);
        return s ? JSON.parse(s) : {}
    } catch {
        return {}
    }
}
function Ds(s) {
    try {
        sessionStorage.setItem(pr, JSON.stringify(s))
    } catch {}
}
function oc(s) {
    const t = wr();
    t[s] = window.scrollY,
    Ds(t)
}
function ic(s) {
    return wr()[s] ?? 0
}
const js = xt(0);
function br() {
    js.update(s => s + 1)
}
function Kt(s, t, n, a) {
    const l = s % 10
      , f = s % 100;
    return f >= 11 && f <= 14 ? a : l === 1 ? t : l >= 2 && l <= 4 ? n : a
}
function qs(s) {
    const t = new Date
      , n = t.getTime() - s.getTime()
      , a = Math.floor(n / 1e3)
      , l = Math.floor(a / 60)
      , f = Math.floor(l / 60)
      , v = Math.floor(f / 24)
      , c = Math.floor(v / 7)
      , h = Math.floor(v / 30)
      , m = Math.floor(v / 365);
    if (a < 60)
        return {
            text: "только что",
            nextUpdateMs: (60 - a) * 1e3
        };
    if (l < 60) {
        const C = (60 - a % 60) * 1e3;
        if (l === 1)
            return {
                text: "минуту назад",
                nextUpdateMs: C
            };
        const I = Kt(l, "минуту", "минуты", "минут");
        return {
            text: `${l} ${I} назад`,
            nextUpdateMs: C
        }
    }
    if (f < 24) {
        const b = l % 60
          , C = a % 60
          , I = ((60 - b - 1) * 60 + (60 - C)) * 1e3;
        if (f === 1)
            return {
                text: "час назад",
                nextUpdateMs: I
            };
        const R = Kt(f, "час", "часа", "часов");
        return {
            text: `${f} ${R} назад`,
            nextUpdateMs: I
        }
    }
    if (v < 7) {
        const b = new Date(t);
        b.setDate(b.getDate() + 1),
        b.setHours(0, 0, 0, 0);
        const C = b.getTime() - t.getTime();
        if (v === 1)
            return {
                text: "вчера",
                nextUpdateMs: C
            };
        const I = Kt(v, "день", "дня", "дней");
        return {
            text: `${v} ${I} назад`,
            nextUpdateMs: C
        }
    }
    if (c < 4) {
        const b = new Date(t);
        b.setDate(b.getDate() + 1),
        b.setHours(0, 0, 0, 0);
        const C = b.getTime() - t.getTime();
        if (c === 1)
            return {
                text: "неделю назад",
                nextUpdateMs: C
            };
        const I = Kt(c, "неделю", "недели", "недель");
        return {
            text: `${c} ${I} назад`,
            nextUpdateMs: C
        }
    }
    if (h < 12) {
        const b = new Date(t);
        b.setDate(b.getDate() + 1),
        b.setHours(0, 0, 0, 0);
        const C = b.getTime() - t.getTime();
        if (h === 1)
            return {
                text: "месяц назад",
                nextUpdateMs: C
            };
        const I = Kt(h, "месяц", "месяца", "месяцев");
        return {
            text: `${h} ${I} назад`,
            nextUpdateMs: C
        }
    }
    const z = new Date(t);
    z.setDate(z.getDate() + 1),
    z.setHours(0, 0, 0, 0);
    const P = z.getTime() - t.getTime();
    if (m === 1)
        return {
            text: "год назад",
            nextUpdateMs: P
        };
    const _ = Kt(m, "год", "года", "лет");
    return {
        text: `${m} ${_} назад`,
        nextUpdateMs: P
    }
}
function Rt(s) {
    return s == null ? "0" : s >= 1e6 ? `${(s / 1e6).toFixed(1)}M` : s >= 1e3 ? `${(s / 1e3).toFixed(1)}K` : s.toString()
}
function pa(s, t) {
    const n = a => {
        s && !s.contains(a.target) && !a.defaultPrevented && t()
    }
    ;
    return setTimeout( () => {
        document.addEventListener("click", n, !0)
    }
    , 0),
    {
        update(a) {
            t = a
        },
        destroy() {
            document.removeEventListener("click", n, !0)
        }
    }
}
function As(s) {
    return {
        id: s.id,
        author: s.author.displayName,
        authorId: s.author.id,
        username: s.author.username || null,
        avatar: s.author.avatar || "",
        verified: s.author.verified,
        content: s.content,
        time: s.createdAt,
        createdAt: s.createdAt,
        likes: s.likesCount,
        isLiked: s.isLiked,
        replyTo: s.replyTo || null,
        attachments: s.attachments?.map(t => ({
            id: t.id,
            type: t.type,
            url: t.url,
            thumbnailUrl: t.thumbnailUrl || void 0,
            width: t.width || void 0,
            height: t.height || void 0,
            duration: t.duration || void 0
        }))
    }
}
function Ls(s) {
    return {
        id: s.id,
        author: s.author.displayName,
        authorId: s.author.id,
        username: s.author.username || null,
        avatar: s.author.avatar || "",
        verified: s.author.verified,
        content: s.content,
        time: s.createdAt,
        createdAt: s.createdAt,
        likes: s.likesCount,
        isLiked: s.isLiked,
        repliesCount: s.repliesCount,
        replies: s.replies?.map(As) || [],
        attachments: s.attachments?.map(t => ({
            id: t.id,
            type: t.type,
            url: t.url,
            thumbnailUrl: t.thumbnailUrl || void 0,
            width: t.width || void 0,
            height: t.height || void 0,
            duration: t.duration || void 0
        }))
    }
}
function jt() {
    return wt(Ta) ? !0 : (Ft("/login"),
    !1)
}
var Us = p('<span class="notification-badge svelte-13vg9xt"> </span>')
  , Os = p('<div class="sidebar-menu svelte-13vg9xt" role="menu" tabindex="-1"><button class="sidebar-menu-item svelte-13vg9xt"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="3"></circle><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path></svg> <span>Настройки</span></button> <button class="sidebar-menu-item danger svelte-13vg9xt"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path><polyline points="16 17 21 12 16 7"></polyline><line x1="21" y1="12" x2="9" y2="12"></line></svg> <span>Выйти</span></button></div>')
  , Bs = p('<div class="sidebar-desktop svelte-13vg9xt"><div class="sidebar-top svelte-13vg9xt"><a href="/feed" class="sidebar-logo svelte-13vg9xt" aria-label="На главную"><svg xmlns="http://www.w3.org/2000/svg" width="36" height="18" fill="none" viewBox="0 0 36 18"><path fill="currentColor" d="m3 9 6-9h3v14H9V5l-6 9H0V0h3zM12 3V0h12v3h-4v11h-4V3z"></path><path fill="currentColor" d="M21 11h3v7h-3zM33 11h3v7h-3zM24 11.091h9v3h-9z"></path><path fill="currentColor" d="M31 0h3v11.09h-3zM24 0h3v11.34s-8.167 1.688-5.444 0S23.667 4.773 24 0"></path><path fill="currentColor" d="M27 0h7l-3 3.09h-4z"></path></svg></a> <div class="sidebar-pill svelte-13vg9xt"><nav class="sidebar-nav svelte-13vg9xt"><a href="/feed"><!></a> <a href="/explore"><!></a> <a><!> <!></a> <a><!></a></nav></div></div> <div class="sidebar-avatar-wrapper svelte-13vg9xt"><button class="sidebar-avatar svelte-13vg9xt" aria-label="Меню профиля"><!></button> <!></div></div> <!>', 1);
function lc(s, t) {
    We(t, !0);
    const n = () => Ke(ma, "$page", v)
      , a = () => Ke(Ot, "$currentUser", v)
      , l = () => Ke(Ta, "$isAuthenticated", v)
      , f = () => Ke(or, "$unreadCount", v)
      , [v,c] = Ct();
    let h = S(!1)
      , m = S(!1);
    const z = new Set(["/", "/feed", "/explore", "/notifications", "/login", "/register"]);
    let P = V( () => ( () => {
        const g = n().url.pathname;
        if (g === "/feed")
            return "feed";
        if (g === "/explore")
            return "explore";
        if (g === "/notifications")
            return "notifications";
        if (g === "/login" || g === "/register")
            return "none";
        const T = a()?.username || a()?.id;
        return T && g === `/${T}` ? "profile" : (!z.has(g) && g.match(/^\/[^/]+$/),
        "none")
    }
    )())
      , _ = V( () => a()?.username ? `/${a().username}` : a()?.id ? `/${a().id}` : "/feed");
    function b() {
        r(h, !e(h))
    }
    function C() {
        r(h, !1)
    }
    async function I() {
        r(h, !1),
        await ir.logout(),
        ga.logout(),
        Ft("/login")
    }
    var R = Bs()
      , L = Pe(R)
      , j = i(L)
      , E = u(i(j), 2)
      , F = i(E)
      , ee = i(F);
    let ae;
    ee.__click = g => {
        n().url.pathname === "/feed" && (g.preventDefault(),
        br())
    }
    ;
    var J = i(ee);
    vr(J, {}),
    o(ee);
    var re = u(ee, 2);
    let ue;
    var ie = i(re);
    ur(ie, {}),
    o(re);
    var ce = u(re, 2);
    let oe;
    var O = i(ce);
    {
        var D = g => {
            var T = Us()
              , y = i(T, !0);
            o(T),
            q( () => de(y, f() > 99 ? "99+" : f())),
            d(g, T)
        }
        ;
        M(O, g => {
            f() > 0 && g(D)
        }
        )
    }
    var H = u(O, 2);
    fr(H, {}),
    o(ce);
    var X = u(ce, 2);
    let te;
    var ke = i(X);
    gs(ke, {}),
    o(X),
    o(F),
    o(E),
    o(j);
    var Y = u(j, 2)
      , we = i(Y);
    we.__click = g => {
        if (g.stopPropagation(),
        !l()) {
            Ft("/login");
            return
        }
        b()
    }
    ;
    var K = i(we);
    {
        let g = V( () => a()?.avatar)
          , T = V( () => a()?.displayName);
        kt(K, {
            get avatar() {
                return e(g)
            },
            get name() {
                return e(T)
            },
            size: 40
        })
    }
    o(we);
    var Z = u(we, 2);
    {
        var N = g => {
            var T = Os();
            T.__click = x => x.stopPropagation();
            var y = i(T);
            y.__click = () => {
                r(h, !1),
                r(m, !0)
            }
            ;
            var k = u(y, 2);
            k.__click = I,
            o(T),
            Yt(T, (x, w) => pa?.(x, w), () => C),
            d(g, T)
        }
        ;
        M(Z, g => {
            e(h) && g(N)
        }
        )
    }
    o(Y),
    o(L);
    var $ = u(L, 2);
    mi($, {
        get isOpen() {
            return e(m)
        },
        onClose: () => r(m, !1)
    }),
    q( () => {
        ae = ye(ee, 1, "sidebar-nav-item svelte-13vg9xt", null, ae, {
            active: e(P) === "feed"
        }),
        ue = ye(re, 1, "sidebar-nav-item svelte-13vg9xt", null, ue, {
            active: e(P) === "explore"
        }),
        se(ce, "href", l() ? "/notifications" : "/login"),
        oe = ye(ce, 1, "sidebar-nav-item svelte-13vg9xt", null, oe, {
            active: e(P) === "notifications"
        }),
        se(X, "href", l() ? e(_) : "/login"),
        te = ye(X, 1, "sidebar-nav-item svelte-13vg9xt", null, te, {
            active: e(P) === "profile"
        })
    }
    ),
    d(s, R),
    Ye(),
    c()
}
Ze(["click"]);
var Es = p('<div class="mobile-nav-slider svelte-16uf3bx"></div>')
  , Hs = p('<span class="notification-badge mobile svelte-16uf3bx"> </span>')
  , Ns = p('<div class="sidebar-mobile svelte-16uf3bx"><nav class="mobile-nav svelte-16uf3bx"><!> <a href="/feed"><!> <span class="mobile-nav-label svelte-16uf3bx">Лента</span></a> <a href="/explore"><!> <span class="mobile-nav-label svelte-16uf3bx">Поиск</span></a> <a href="/notifications"><!> <!> <span class="mobile-nav-label svelte-16uf3bx">Уведомления</span></a> <a><!> <span class="mobile-nav-label svelte-16uf3bx">Профиль</span></a></nav></div>');
function cc(s, t) {
    We(t, !0);
    const n = () => Ke(ma, "$page", f)
      , a = () => Ke(Ot, "$currentUser", f)
      , l = () => Ke(or, "$unreadCount", f)
      , [f,v] = Ct()
      , c = new Set(["/", "/feed", "/explore", "/notifications", "/login", "/register"]);
    let h = V( () => ( () => {
        const O = n().url.pathname;
        if (O === "/feed")
            return "feed";
        if (O === "/explore")
            return "explore";
        if (O === "/notifications")
            return "notifications";
        if (O === "/login" || O === "/register")
            return "none";
        const D = a()?.username || a()?.id;
        return D && O === `/${D}` ? "profile" : (!c.has(O) && O.match(/^\/[^/]+$/),
        "none")
    }
    )())
      , m = V( () => ( () => {
        switch (e(h)) {
        case "feed":
            return 0;
        case "explore":
            return 1;
        case "notifications":
            return 2;
        case "profile":
            return 3;
        default:
            return -1
        }
    }
    )())
      , z = V( () => a()?.username ? `/${a().username}` : a()?.id ? `/${a().id}` : "/feed");
    var P = Ns()
      , _ = i(P)
      , b = i(_);
    {
        var C = O => {
            var D = Es();
            q( () => lt(D, `transform: translateX(${e(m) * 100}%)`)),
            d(O, D)
        }
        ;
        M(b, O => {
            e(m) >= 0 && O(C)
        }
        )
    }
    var I = u(b, 2);
    let R;
    I.__click = O => {
        n().url.pathname === "/feed" && (O.preventDefault(),
        br())
    }
    ;
    var L = i(I);
    vr(L, {}),
    Ge(2),
    o(I);
    var j = u(I, 2);
    let E;
    var F = i(j);
    ur(F, {}),
    Ge(2),
    o(j);
    var ee = u(j, 2);
    let ae;
    var J = i(ee);
    {
        var re = O => {
            var D = Hs()
              , H = i(D, !0);
            o(D),
            q( () => de(H, l() > 99 ? "99+" : l())),
            d(O, D)
        }
        ;
        M(J, O => {
            l() > 0 && O(re)
        }
        )
    }
    var ue = u(J, 2);
    fr(ue, {}),
    Ge(2),
    o(ee);
    var ie = u(ee, 2);
    let ce;
    var oe = i(ie);
    {
        let O = V( () => a()?.avatar)
          , D = V( () => a()?.displayName);
        kt(oe, {
            get avatar() {
                return e(O)
            },
            get name() {
                return e(D)
            },
            size: 24
        })
    }
    Ge(2),
    o(ie),
    o(_),
    o(P),
    q( () => {
        R = ye(I, 1, "mobile-nav-item svelte-16uf3bx", null, R, {
            active: e(h) === "feed"
        }),
        E = ye(j, 1, "mobile-nav-item svelte-16uf3bx", null, E, {
            active: e(h) === "explore"
        }),
        ae = ye(ee, 1, "mobile-nav-item svelte-16uf3bx", null, ae, {
            active: e(h) === "notifications"
        }),
        se(ie, "href", e(z)),
        ce = ye(ie, 1, "mobile-nav-item svelte-16uf3bx", null, ce, {
            active: e(h) === "profile"
        })
    }
    ),
    d(s, P),
    Ye(),
    v()
}
Ze(["click"]);
const $a = {
    async search(s, t=10) {
        const n = {
            limit: t
        };
        s && (n.q = s);
        const a = await Ae.get(Re.hashtags.search, n);
        return a.error ? {
            error: a.error.message
        } : {
            data: a.data
        }
    },
    async getTrending(s=10) {
        const t = await Ae.get(Re.hashtags.trending, {
            limit: s
        });
        return t.error ? {
            error: t.error.message
        } : {
            data: t.data
        }
    },
    async getPostsByHashtag(s, t={}) {
        const n = {
            limit: t.limit || 20
        };
        t.cursor && (n.cursor = t.cursor);
        const a = await Ae.get(Re.hashtags.posts(s), n);
        return a.error ? {
            error: a.error.message
        } : {
            data: a.data
        }
    }
};
function Fs() {
    const {subscribe: s, update: t} = xt([]);
    return {
        subscribe: s,
        show(n, a=5e3) {
            const l = crypto.randomUUID();
            return t(f => [...f, {
                id: l,
                message: n,
                duration: a
            }]),
            a > 0 && setTimeout( () => {
                this.dismiss(l)
            }
            , a),
            l
        },
        dismiss(n) {
            t(a => a.filter(l => l.id !== n))
        },
        clear() {
            t( () => [])
        }
    }
}
const Mt = Fs()
  , It = xt(new Map)
  , vt = {
    subscribe: It.subscribe,
    set(s, t) {
        It.update(n => (n.set(s, t),
        new Map(n)))
    },
    get(s) {
        return wt(It).get(s)
    },
    toggleLike(s, t) {
        It.update(n => {
            const a = n.get(s);
            if (a) {
                const l = a.isLiked
                  , f = t ? l ? 0 : 1 : l ? -1 : 0;
                n.set(s, {
                    ...a,
                    isLiked: t,
                    likesCount: a.likesCount + f
                })
            }
            return new Map(n)
        }
        )
    },
    toggleRepost(s, t) {
        It.update(n => {
            const a = n.get(s);
            if (a) {
                const l = a.isReposted
                  , f = t ? l ? 0 : 1 : l ? -1 : 0;
                n.set(s, {
                    ...a,
                    isReposted: t,
                    repostsCount: a.repostsCount + f
                })
            }
            return new Map(n)
        }
        )
    },
    incrementComments(s) {
        It.update(t => {
            const n = t.get(s);
            return n && t.set(s, {
                ...n,
                commentsCount: n.commentsCount + 1
            }),
            new Map(t)
        }
        )
    },
    decrementComments(s) {
        It.update(t => {
            const n = t.get(s);
            return n && t.set(s, {
                ...n,
                commentsCount: Math.max(0, n.commentsCount - 1)
            }),
            new Map(t)
        }
        )
    },
    getPostStore(s) {
        return rs(It, t => t.get(s))
    },
    clear() {
        It.set(new Map)
    }
}
  , Ma = "nowkie_theme";
function er() {
    const s = localStorage.getItem(Ma);
    return s === "dark" || s === "light" ? s : window.matchMedia("(prefers-color-scheme: dark)").matches ? "dark" : "light"
}
function Vs() {
    const {subscribe: s, set: t, update: n} = xt(er());
    return {
        subscribe: s,
        set: a => {
            localStorage.setItem(Ma, a),
            document.documentElement.setAttribute("data-theme", a),
            t(a)
        }
        ,
        toggle: () => {
            n(a => {
                const l = a === "light" ? "dark" : "light";
                return localStorage.setItem(Ma, l),
                document.documentElement.setAttribute("data-theme", l),
                l
            }
            )
        }
        ,
        init: () => {
            {
                const a = er();
                document.documentElement.setAttribute("data-theme", a),
                t(a)
            }
        }
    }
}
const tr = Vs()
  , fa = "nowkie_snow_enabled";
function ar() {
    return localStorage.getItem(fa) === "true"
}
function Ws() {
    const {subscribe: s, set: t} = xt(ar());
    return {
        subscribe: s,
        set: n => {
            localStorage.setItem(fa, String(n)),
            t(n)
        }
        ,
        toggle: () => {
            {
                const l = !(localStorage.getItem(fa) !== "false");
                localStorage.setItem(fa, String(l)),
                t(l)
            }
        }
        ,
        init: () => {
            {
                const n = ar();
                t(n)
            }
        }
    }
}
const rr = Ws();
function Ys() {
    const {subscribe: s, set: t, update: n} = xt({
        isOpen: !1,
        postId: null
    });
    return {
        subscribe: s,
        open: a => {
            t({
                isOpen: !0,
                postId: a
            })
        }
        ,
        close: () => {
            t({
                isOpen: !1,
                postId: null
            })
        }
    }
}
const Xs = Ys();
var Zs = p('<div class="create-post__error svelte-1qnpi43"> </div>')
  , Ks = p('<div class="upload-overlay svelte-1qnpi43"><svg class="spinner svelte-1qnpi43" width="24" height="24" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="3" fill="none" stroke-dasharray="31.4" stroke-linecap="round"><animateTransform attributeName="transform" type="rotate" from="0 12 12" to="360 12 12" dur="1s" repeatCount="indefinite"></animateTransform></circle></svg></div>')
  , Gs = p('<div class="upload-error-overlay svelte-1qnpi43"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="8" x2="12" y2="12"></line><line x1="12" y1="16" x2="12.01" y2="16"></line></svg></div>')
  , Qs = p('<button class="create-post__edit-drawing-btn svelte-1qnpi43" title="Редактировать рисунок"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18.37 2.63 14 7l-1.59-1.59a2 2 0 0 0-2.82 0L8 7l9 9 1.59-1.59a2 2 0 0 0 0-2.82L17 10l4.37-4.37a2.12 2.12 0 1 0-3-3Z"></path><path d="M9 8c-2 3-4 3.5-7 4l8 10c2-1 6-5 6-7"></path></svg></button>')
  , Js = p('<div><img alt="Превью"/> <!> <!> <button class="create-post__remove-media-btn svelte-1qnpi43"><!></button></div>')
  , $s = p("<div></div>")
  , en = p('<span class="create-post__counter svelte-1qnpi43"> </span>')
  , tn = p('<div class="create-post svelte-1qnpi43"><!> <div class="create-post__inner svelte-1qnpi43"><div class="create-post__avatar svelte-1qnpi43"><!></div> <div class="create-post__content svelte-1qnpi43"><textarea placeholder="Что нового?" class="create-post__textarea svelte-1qnpi43"></textarea> <!> <!></div></div> <div class="create-post__toolbar svelte-1qnpi43"><div class="create-post__attach svelte-1qnpi43"><input type="file" class="create-post__file-input svelte-1qnpi43" accept="image/*" multiple/> <button class="create-post__attach-btn svelte-1qnpi43" title="Прикрепить файлы"><svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l9.19-9.19a4 4 0 0 1 5.66 5.66l-9.2 9.19a2 2 0 0 1-2.83-2.83l8.49-8.48"></path></svg></button> <button class="create-post__attach-btn svelte-1qnpi43" title="Нарисовать"><svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="13.5" cy="6.5" r=".5" fill="currentColor"></circle><circle cx="17.5" cy="10.5" r=".5" fill="currentColor"></circle><circle cx="8.5" cy="7.5" r=".5" fill="currentColor"></circle><circle cx="6.5" cy="12.5" r=".5" fill="currentColor"></circle><path d="M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.555C21.965 6.012 17.461 2 12 2z"></path></svg></button> <!></div> <button class="create-post__submit svelte-1qnpi43"> </button></div></div>')
  , an = p("<!> <!>", 1);
function dc(s, t) {
    We(t, !0);
    const n = () => Ke(_r, "$isMobile", l)
      , a = () => Ke(Ot, "$currentUser", l)
      , [l,f] = Ct()
      , v = 10;
    let c = S(""), h = S(rt([])), m, z, P = S(!1), _ = S(""), b = S(!1), C = S(""), I = S(rt({
        top: 0,
        left: 0
    })), R = S(0), L = S(!1), j = S(null), E = S(void 0), F = V( () => e(h).some(g => g.isUploading)), ee = V( () => e(h).filter(g => g.uploaded).map(g => g.uploaded)), ae = V( () => !e(c).trim() && e(ee).length === 0 || e(P) || e(F)), J = V( () => e(h).length < v);
    function re(g) {
        const T = g.target;
        r(c, T.value, !0),
        T.style.height = "auto",
        T.style.height = `${Math.min(T.scrollHeight, 200)}px`,
        ie(T)
    }
    function ue(g) {
        const T = g.clipboardData?.items;
        if (!T)
            return;
        const y = v - e(h).length;
        if (y <= 0)
            return;
        const k = [];
        for (let x = 0; x < T.length && k.length < y; x++) {
            const w = T[x];
            if (w.type.startsWith("image/")) {
                const A = w.getAsFile();
                A && k.push(A)
            }
        }
        if (k.length !== 0) {
            g.preventDefault();
            for (const x of k) {
                const w = crypto.randomUUID()
                  , A = new FileReader;
                A.onload = Q => {
                    const le = Q.target?.result
                      , xe = {
                        id: w,
                        preview: le,
                        file: x,
                        isUploading: !0
                    };
                    r(h, [...e(h), xe], !0),
                    D(w, x)
                }
                ,
                A.readAsDataURL(x)
            }
        }
    }
    function ie(g) {
        const T = g.selectionStart
          , y = e(c).slice(0, T)
          , k = y.match(/#([a-zA-Zа-яА-ЯёЁ0-9_]*)$/);
        if (k) {
            r(R, T - k[0].length),
            r(C, k[1], !0);
            const x = parseInt(getComputedStyle(g).lineHeight) || 22
              , A = y.split(`
`).length - 1;
            r(I, {
                top: (A + 1) * x + 4,
                left: 0
            }, !0),
            r(b, !0)
        } else
            r(b, !1),
            r(C, "")
    }
    function ce(g) {
        const T = e(c).slice(0, e(R))
          , y = e(c).slice(z.selectionStart);
        r(c, T + "#" + g.name + " " + y),
        r(b, !1),
        r(C, ""),
        setTimeout( () => {
            z?.focus();
            const k = e(R) + g.name.length + 2;
            z.setSelectionRange(k, k)
        }
        , 0)
    }
    function oe() {
        r(b, !1),
        r(C, "")
    }
    async function O(g) {
        const y = g.target.files;
        if (!y || y.length === 0)
            return;
        const k = v - e(h).length
          , x = Array.from(y).slice(0, k);
        for (const w of x) {
            const A = crypto.randomUUID()
              , Q = new FileReader;
            Q.onload = le => {
                const xe = le.target?.result
                  , he = {
                    id: A,
                    preview: xe,
                    file: w,
                    isUploading: !0
                };
                r(h, [...e(h), he], !0),
                D(A, w)
            }
            ,
            Q.readAsDataURL(w)
        }
        m && (m.value = "")
    }
    async function D(g, T) {
        const y = await Dt.uploadFile(T);
        r(h, e(h).map(k => {
            if (k.id === g) {
                if (y.error)
                    return Mt.show(y.error),
                    {
                        ...k,
                        isUploading: !1,
                        error: y.error
                    };
                if (y.data)
                    return {
                        ...k,
                        isUploading: !1,
                        uploaded: y.data
                    }
            }
            return k
        }
        ), !0)
    }
    async function H(g) {
        const T = e(h).find(y => y.id === g);
        T?.uploaded && await Dt.deleteFile(T.uploaded.id),
        r(h, e(h).filter(y => y.id !== g), !0)
    }
    async function X() {
        if (!e(c).trim() && e(ee).length === 0)
            return;
        r(P, !0),
        r(_, "");
        const g = e(ee).length > 0 ? e(ee).map(y => y.id) : void 0
          , T = await ut.createPost({
            content: e(c),
            attachmentIds: g
        });
        T.error ? (r(_, T.error, !0),
        Mt.show(T.error)) : T.data && (r(c, ""),
        r(h, [], !0),
        z && (z.style.height = "auto"),
        t.onPostCreated?.(T.data)),
        r(P, !1)
    }
    function te() {
        r(j, null),
        r(E, void 0),
        r(L, !0)
    }
    function ke(g) {
        g.isDrawing && (r(j, g.id, !0),
        r(E, g.preview, !0),
        r(L, !0))
    }
    function Y() {
        r(L, !1),
        r(j, null),
        r(E, void 0)
    }
    async function we(g, T) {
        const y = e(j) || crypto.randomUUID()
          , k = new File([g],`drawing-${y}.png`,{
            type: "image/png"
        });
        if (e(j)) {
            const x = e(h).find(w => w.id === e(j));
            x?.uploaded && await Dt.deleteFile(x.uploaded.id),
            r(h, e(h).map(w => w.id === e(j) ? {
                ...w,
                preview: T,
                file: k,
                isUploading: !0,
                uploaded: void 0
            } : w), !0),
            D(e(j), k)
        } else {
            const x = {
                id: y,
                preview: T,
                file: k,
                isUploading: !0,
                isDrawing: !0
            };
            r(h, [...e(h), x], !0),
            D(y, k)
        }
        Y()
    }
    var K = an()
      , Z = Pe(K);
    {
        var N = g => {
            var T = tn()
              , y = i(T);
            {
                var k = ve => {
                    var be = Zs()
                      , _e = i(be, !0);
                    o(be),
                    q( () => de(_e, e(_))),
                    d(ve, be)
                }
                ;
                M(y, ve => {
                    e(_) && ve(k)
                }
                )
            }
            var x = u(y, 2)
              , w = i(x)
              , A = i(w);
            {
                let ve = V( () => a()?.avatar)
                  , be = V( () => a()?.displayName);
                kt(A, {
                    get avatar() {
                        return e(ve)
                    },
                    get name() {
                        return e(be)
                    },
                    size: 40
                })
            }
            o(w);
            var Q = u(w, 2)
              , le = i(Q);
            Vt(le),
            le.__input = re,
            et(le, ve => z = ve, () => z);
            var xe = u(le, 2);
            {
                var he = ve => {
                    Sr(ve, {
                        get query() {
                            return e(C)
                        },
                        get position() {
                            return e(I)
                        },
                        onSelect: ce,
                        onClose: oe
                    })
                }
                ;
                M(xe, ve => {
                    e(b) && ve(he)
                }
                )
            }
            var Se = u(xe, 2);
            {
                var fe = ve => {
                    var be = $s();
                    let _e;
                    Qe(be, 21, () => e(h), Me => Me.id, (Me, ge) => {
                        var Te = Js();
                        let Ne;
                        var Ie = i(Te);
                        let qe;
                        var Fe = u(Ie, 2);
                        {
                            var Xe = Be => {
                                var ne = Ks();
                                d(Be, ne)
                            }
                              , Je = Be => {
                                var ne = He()
                                  , pe = Pe(ne);
                                {
                                    var Ue = tt => {
                                        var $e = Gs();
                                        q( () => se($e, "title", e(ge).error)),
                                        d(tt, $e)
                                    }
                                    ;
                                    M(pe, tt => {
                                        e(ge).error && tt(Ue)
                                    }
                                    , !0)
                                }
                                d(Be, ne)
                            }
                            ;
                            M(Fe, Be => {
                                e(ge).isUploading ? Be(Xe) : Be(Je, !1)
                            }
                            )
                        }
                        var st = u(Fe, 2);
                        {
                            var ct = Be => {
                                var ne = Qs();
                                ne.__click = () => ke(e(ge)),
                                d(Be, ne)
                            }
                            ;
                            M(st, Be => {
                                e(ge).isDrawing && !e(ge).isUploading && Be(ct)
                            }
                            )
                        }
                        var it = u(st, 2);
                        it.__click = () => H(e(ge).id);
                        var dt = i(it);
                        Lt(dt, {
                            size: 14
                        }),
                        o(it),
                        o(Te),
                        q( () => {
                            Ne = ye(Te, 1, "create-post__preview-item svelte-1qnpi43", null, Ne, {
                                "is-drawing": e(ge).isDrawing,
                                "has-error": e(ge).error
                            }),
                            se(Ie, "src", e(ge).preview),
                            qe = ye(Ie, 1, "svelte-1qnpi43", null, qe, {
                                uploading: e(ge).isUploading
                            }),
                            it.disabled = e(ge).isUploading
                        }
                        ),
                        d(Me, Te)
                    }
                    ),
                    o(be),
                    q( () => _e = ye(be, 1, "create-post__previews svelte-1qnpi43", null, _e, {
                        single: e(h).length === 1
                    })),
                    d(ve, be)
                }
                ;
                M(Se, ve => {
                    e(h).length > 0 && ve(fe)
                }
                )
            }
            o(Q),
            o(x);
            var ze = u(x, 2)
              , je = i(ze)
              , Oe = i(je);
            Oe.__change = O,
            et(Oe, ve => m = ve, () => m);
            var U = u(Oe, 2);
            U.__click = () => m?.click();
            var W = u(U, 2);
            W.__click = te;
            var B = u(W, 2);
            {
                var G = ve => {
                    var be = en()
                      , _e = i(be);
                    o(be),
                    q( () => de(_e, `${e(h).length ?? ""}/10`)),
                    d(ve, be)
                }
                ;
                M(B, ve => {
                    e(h).length > 0 && ve(G)
                }
                )
            }
            o(je);
            var Ce = u(je, 2);
            Ce.__click = X;
            var De = i(Ce, !0);
            o(Ce),
            o(ze),
            o(T),
            q( () => {
                $t(le, e(c)),
                U.disabled = !e(J),
                W.disabled = !e(J),
                Ce.disabled = e(ae),
                de(De, e(P) ? "Публикация..." : "Опубликовать")
            }
            ),
            mt("paste", le, ue),
            d(g, T)
        }
        ;
        M(Z, g => {
            n() || g(N)
        }
        )
    }
    var $ = u(Z, 2);
    Tr($, {
        get isOpen() {
            return e(L)
        },
        get initialImage() {
            return e(E)
        },
        onSave: we,
        onClose: Y
    }),
    d(s, K),
    Ye(),
    f()
}
Ze(["input", "click", "change"]);
var rn = p('<div class="modal-error svelte-1eielbp"> </div>')
  , sn = p('<div class="upload-overlay svelte-1eielbp"><svg class="spinner svelte-1eielbp" width="24" height="24" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="3" fill="none" stroke-dasharray="31.4" stroke-linecap="round"><animateTransform attributeName="transform" type="rotate" from="0 12 12" to="360 12 12" dur="1s" repeatCount="indefinite"></animateTransform></circle></svg></div>')
  , nn = p('<div class="upload-error-overlay svelte-1eielbp"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="8" x2="12" y2="12"></line><line x1="12" y1="16" x2="12.01" y2="16"></line></svg></div>')
  , on = p('<button class="modal-edit-drawing svelte-1eielbp" title="Редактировать рисунок"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18.37 2.63 14 7l-1.59-1.59a2 2 0 0 0-2.82 0L8 7l9 9 1.59-1.59a2 2 0 0 0 0-2.82L17 10l4.37-4.37a2.12 2.12 0 1 0-3-3Z"></path><path d="M9 8c-2 3-4 3.5-7 4l8 10c2-1 6-5 6-7"></path></svg></button>')
  , ln = p('<div><img alt="Превью"/> <!> <!> <button class="modal-remove-media svelte-1eielbp"><!></button></div>')
  , cn = p('<div class="modal-previews svelte-1eielbp"></div>')
  , dn = p('<span class="modal-counter svelte-1eielbp"> </span>')
  , vn = p('<div class="create-post-modal svelte-1eielbp"><div class="modal-header svelte-1eielbp"><button class="modal-close svelte-1eielbp"><!></button> <button class="modal-submit svelte-1eielbp"> </button></div> <!> <div class="modal-body svelte-1eielbp"><div class="modal-avatar svelte-1eielbp"><!></div> <div class="modal-content svelte-1eielbp"><textarea placeholder="Что нового?" class="modal-textarea svelte-1eielbp"></textarea> <!> <!></div></div> <div class="modal-footer svelte-1eielbp"><input type="file" class="file-input svelte-1eielbp" accept="image/*" multiple/> <button class="modal-attach svelte-1eielbp" title="Прикрепить файлы"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l9.19-9.19a4 4 0 0 1 5.66 5.66l-9.2 9.19a2 2 0 0 1-2.83-2.83l8.49-8.48"></path></svg></button> <button class="modal-attach svelte-1eielbp" title="Нарисовать"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="13.5" cy="6.5" r=".5" fill="currentColor"></circle><circle cx="17.5" cy="10.5" r=".5" fill="currentColor"></circle><circle cx="8.5" cy="7.5" r=".5" fill="currentColor"></circle><circle cx="6.5" cy="12.5" r=".5" fill="currentColor"></circle><path d="M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.555C21.965 6.012 17.461 2 12 2z"></path></svg></button> <!></div></div>')
  , un = p("<!> <!>", 1);
function fn(s, t) {
    We(t, !0);
    const n = () => Ke(Ot, "$currentUser", a)
      , [a,l] = Ct()
      , f = 10;
    let v = S(""), c = S(rt([])), h, m, z = S(!1), P = S(""), _ = S(!1), b = S(""), C = S(rt({
        top: 0,
        left: 0
    })), I = S(0), R = S(!1), L = S(null), j = S(void 0), E = V( () => e(c).some(g => g.isUploading)), F = V( () => e(c).filter(g => g.uploaded).map(g => g.uploaded)), ee = V( () => !e(v).trim() && e(F).length === 0 || e(z) || e(E)), ae = V( () => e(c).length < f);
    function J(g) {
        const T = g.target;
        r(v, T.value, !0),
        ue(T)
    }
    function re(g) {
        const T = g.clipboardData?.items;
        if (!T)
            return;
        const y = f - e(c).length;
        if (y <= 0)
            return;
        const k = [];
        for (let x = 0; x < T.length && k.length < y; x++) {
            const w = T[x];
            if (w.type.startsWith("image/")) {
                const A = w.getAsFile();
                A && k.push(A)
            }
        }
        if (k.length !== 0) {
            g.preventDefault();
            for (const x of k) {
                const w = crypto.randomUUID()
                  , A = new FileReader;
                A.onload = Q => {
                    const le = Q.target?.result
                      , xe = {
                        id: w,
                        preview: le,
                        file: x,
                        isUploading: !0
                    };
                    r(c, [...e(c), xe], !0),
                    O(w, x)
                }
                ,
                A.readAsDataURL(x)
            }
        }
    }
    function ue(g) {
        const T = g.selectionStart
          , y = e(v).slice(0, T)
          , k = y.match(/#([a-zA-Zа-яА-ЯёЁ0-9_]*)$/);
        if (k) {
            r(I, T - k[0].length),
            r(b, k[1], !0);
            const x = parseInt(getComputedStyle(g).lineHeight) || 22
              , A = y.split(`
`).length - 1;
            r(C, {
                top: (A + 1) * x + 4,
                left: 0
            }, !0),
            r(_, !0)
        } else
            r(_, !1),
            r(b, "")
    }
    function ie(g) {
        const T = e(v).slice(0, e(I))
          , y = e(v).slice(m.selectionStart);
        r(v, T + "#" + g.name + " " + y),
        r(_, !1),
        r(b, ""),
        setTimeout( () => {
            m?.focus();
            const k = e(I) + g.name.length + 2;
            m.setSelectionRange(k, k)
        }
        , 0)
    }
    function ce() {
        r(_, !1),
        r(b, "")
    }
    async function oe(g) {
        const y = g.target.files;
        if (!y || y.length === 0)
            return;
        const k = f - e(c).length
          , x = Array.from(y).slice(0, k);
        for (const w of x) {
            const A = crypto.randomUUID()
              , Q = new FileReader;
            Q.onload = le => {
                const xe = le.target?.result
                  , he = {
                    id: A,
                    preview: xe,
                    file: w,
                    isUploading: !0
                };
                r(c, [...e(c), he], !0),
                O(A, w)
            }
            ,
            Q.readAsDataURL(w)
        }
        h && (h.value = "")
    }
    async function O(g, T) {
        const y = await Dt.uploadFile(T);
        r(c, e(c).map(k => {
            if (k.id === g) {
                if (y.error)
                    return Mt.show(y.error),
                    {
                        ...k,
                        isUploading: !1,
                        error: y.error
                    };
                if (y.data)
                    return {
                        ...k,
                        isUploading: !1,
                        uploaded: y.data
                    }
            }
            return k
        }
        ), !0)
    }
    async function D(g) {
        const T = e(c).find(y => y.id === g);
        T?.uploaded && await Dt.deleteFile(T.uploaded.id),
        r(c, e(c).filter(y => y.id !== g), !0)
    }
    async function H() {
        if (!e(v).trim() && e(F).length === 0)
            return;
        r(z, !0),
        r(P, "");
        const g = e(F).length > 0 ? e(F).map(y => y.id) : void 0
          , T = await ut.createPost({
            content: e(v),
            attachmentIds: g
        });
        T.error ? (r(P, T.error, !0),
        Mt.show(T.error)) : T.data && (r(v, ""),
        r(c, [], !0),
        t.onPostCreated?.(T.data),
        t.onClose()),
        r(z, !1)
    }
    function X() {
        e(z) || (r(v, ""),
        r(c, [], !0),
        r(P, ""),
        t.onClose())
    }
    function te() {
        r(L, null),
        r(j, void 0),
        r(R, !0)
    }
    function ke(g) {
        g.isDrawing && (r(L, g.id, !0),
        r(j, g.preview, !0),
        r(R, !0))
    }
    function Y() {
        r(R, !1),
        r(L, null),
        r(j, void 0)
    }
    async function we(g, T) {
        const y = e(L) || crypto.randomUUID()
          , k = new File([g],`drawing-${y}.png`,{
            type: "image/png"
        });
        if (e(L)) {
            const x = e(c).find(w => w.id === e(L));
            x?.uploaded && await Dt.deleteFile(x.uploaded.id),
            r(c, e(c).map(w => w.id === e(L) ? {
                ...w,
                preview: T,
                file: k,
                isUploading: !0,
                uploaded: void 0
            } : w), !0),
            O(e(L), k)
        } else {
            const x = {
                id: y,
                preview: T,
                file: k,
                isUploading: !0,
                isDrawing: !0
            };
            r(c, [...e(c), x], !0),
            O(y, k)
        }
        Y()
    }
    var K = un()
      , Z = Pe(K);
    {
        var N = g => {
            var T = vn()
              , y = i(T)
              , k = i(y);
            k.__click = X;
            var x = i(k);
            Lt(x, {
                size: 24
            }),
            o(k);
            var w = u(k, 2);
            w.__click = H;
            var A = i(w, !0);
            o(w),
            o(y);
            var Q = u(y, 2);
            {
                var le = _e => {
                    var Me = rn()
                      , ge = i(Me, !0);
                    o(Me),
                    q( () => de(ge, e(P))),
                    d(_e, Me)
                }
                ;
                M(Q, _e => {
                    e(P) && _e(le)
                }
                )
            }
            var xe = u(Q, 2)
              , he = i(xe)
              , Se = i(he);
            {
                let _e = V( () => n()?.avatar)
                  , Me = V( () => n()?.displayName);
                kt(Se, {
                    get avatar() {
                        return e(_e)
                    },
                    get name() {
                        return e(Me)
                    },
                    size: 40
                })
            }
            o(he);
            var fe = u(he, 2)
              , ze = i(fe);
            Vt(ze),
            ze.__input = J,
            et(ze, _e => m = _e, () => m);
            var je = u(ze, 2);
            {
                var Oe = _e => {
                    Sr(_e, {
                        get query() {
                            return e(b)
                        },
                        get position() {
                            return e(C)
                        },
                        onSelect: ie,
                        onClose: ce
                    })
                }
                ;
                M(je, _e => {
                    e(_) && _e(Oe)
                }
                )
            }
            var U = u(je, 2);
            {
                var W = _e => {
                    var Me = cn();
                    Qe(Me, 21, () => e(c), ge => ge.id, (ge, Te) => {
                        var Ne = ln();
                        let Ie;
                        var qe = i(Ne);
                        let Fe;
                        var Xe = u(qe, 2);
                        {
                            var Je = ne => {
                                var pe = sn();
                                d(ne, pe)
                            }
                              , st = ne => {
                                var pe = He()
                                  , Ue = Pe(pe);
                                {
                                    var tt = $e => {
                                        var ht = nn();
                                        q( () => se(ht, "title", e(Te).error)),
                                        d($e, ht)
                                    }
                                    ;
                                    M(Ue, $e => {
                                        e(Te).error && $e(tt)
                                    }
                                    , !0)
                                }
                                d(ne, pe)
                            }
                            ;
                            M(Xe, ne => {
                                e(Te).isUploading ? ne(Je) : ne(st, !1)
                            }
                            )
                        }
                        var ct = u(Xe, 2);
                        {
                            var it = ne => {
                                var pe = on();
                                pe.__click = () => ke(e(Te)),
                                d(ne, pe)
                            }
                            ;
                            M(ct, ne => {
                                e(Te).isDrawing && !e(Te).isUploading && ne(it)
                            }
                            )
                        }
                        var dt = u(ct, 2);
                        dt.__click = () => D(e(Te).id);
                        var Be = i(dt);
                        Lt(Be, {
                            size: 14
                        }),
                        o(dt),
                        o(Ne),
                        q( () => {
                            Ie = ye(Ne, 1, "modal-preview-item svelte-1eielbp", null, Ie, {
                                "is-drawing": e(Te).isDrawing,
                                "has-error": e(Te).error
                            }),
                            se(qe, "src", e(Te).preview),
                            Fe = ye(qe, 1, "svelte-1eielbp", null, Fe, {
                                uploading: e(Te).isUploading
                            }),
                            dt.disabled = e(Te).isUploading
                        }
                        ),
                        d(ge, Ne)
                    }
                    ),
                    o(Me),
                    d(_e, Me)
                }
                ;
                M(U, _e => {
                    e(c).length > 0 && _e(W)
                }
                )
            }
            o(fe),
            o(xe);
            var B = u(xe, 2)
              , G = i(B);
            G.__change = oe,
            et(G, _e => h = _e, () => h);
            var Ce = u(G, 2);
            Ce.__click = () => h?.click();
            var De = u(Ce, 2);
            De.__click = te;
            var ve = u(De, 2);
            {
                var be = _e => {
                    var Me = dn()
                      , ge = i(Me);
                    o(Me),
                    q( () => de(ge, `${e(c).length ?? ""}/10`)),
                    d(_e, Me)
                }
                ;
                M(ve, _e => {
                    e(c).length > 0 && _e(be)
                }
                )
            }
            o(B),
            o(T),
            q( () => {
                k.disabled = e(z),
                w.disabled = e(ee),
                de(A, e(z) ? "..." : "Опубликовать"),
                $t(ze, e(v)),
                Ce.disabled = !e(ae),
                De.disabled = !e(ae)
            }
            ),
            mt("paste", ze, re),
            d(g, T)
        }
        ;
        M(Z, g => {
            t.isOpen && g(N)
        }
        )
    }
    var $ = u(Z, 2);
    Tr($, {
        get isOpen() {
            return e(R)
        },
        get initialImage() {
            return e(j)
        },
        onSave: we,
        onClose: Y
    }),
    d(s, K),
    Ye(),
    l()
}
Ze(["click", "input", "change"]);
var hn = p('<button class="fab svelte-5ery86" aria-label="Создать пост"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg></button> <!>', 1);
function vc(s, t) {
    We(t, !0);
    const n = () => Ke(ma, "$page", l)
      , a = () => Ke(Ot, "$currentUser", l)
      , [l,f] = Ct();
    let v = S(!1)
      , c = V( () => n().url.pathname === "/" || n().url.pathname === "/feed")
      , h = V( () => a() && (n().url.pathname === `/${a().username}` || n().url.pathname === `/${a().id}`))
      , m = V( () => e(c) || e(h));
    function z() {
        r(v, !0)
    }
    function P() {
        r(v, !1)
    }
    async function _() {
        await ls(),
        window.location.reload()
    }
    var b = He()
      , C = Pe(b);
    {
        var I = R => {
            var L = hn()
              , j = Pe(L);
            j.__click = z;
            var E = u(j, 2);
            fn(E, {
                get isOpen() {
                    return e(v)
                },
                onClose: P,
                onPostCreated: _
            }),
            d(R, L)
        }
        ;
        M(C, R => {
            a() && e(m) && R(I)
        }
        )
    }
    d(s, b),
    Ye(),
    f()
}
Ze(["click"]);
var gn = p('<div style="display: contents;"><!></div>');
function ra(s, t) {
    let n = me(t, "target", 3, "body");
    function a(v) {
        const c = typeof n() == "string" ? document.querySelector(n()) : n();
        return c && c.appendChild(v),
        {
            destroy() {
                v.remove()
            }
        }
    }
    var l = gn()
      , f = i(l);
    ua(f, () => t.children),
    o(l),
    Yt(l, v => a?.(v)),
    d(s, l)
}
var mn = p('<div class="pin-hint"><span class="pin-hint__row"><span class="pin-hint__label">Пин:</span> </span> <span class="pin-hint__row"><span class="pin-hint__label">Ивент:</span> </span> <div class="pin-hint__arrow"></div></div>')
  , _n = p('<span class="pin-badge svelte-1ibpnsz" role="img"><img class="pin-badge__icon svelte-1ibpnsz"/></span> <!>', 1);
function na(s, t) {
    We(t, !0);
    let n = me(t, "size", 3, 16)
      , a = S(null)
      , l = S(!1)
      , f = S(0)
      , v = S(0);
    function c() {
        if (!e(a))
            return;
        const C = e(a).getBoundingClientRect();
        r(f, C.left + C.width / 2),
        r(v, C.top, !0),
        r(l, !0)
    }
    function h() {
        r(l, !1)
    }
    var m = _n()
      , z = Pe(m)
      , P = i(z);
    o(z),
    et(z, C => r(a, C), () => e(a));
    var _ = u(z, 2);
    {
        var b = C => {
            ra(C, {
                children: (I, R) => {
                    var L = mn()
                      , j = i(L)
                      , E = u(i(j));
                    o(j);
                    var F = u(j, 2)
                      , ee = u(i(F));
                    o(F),
                    Ge(2),
                    o(L),
                    q( () => {
                        lt(L, `left: ${e(f) ?? ""}px; top: ${e(v) ?? ""}px;`),
                        de(E, ` «${t.pin.name ?? ""}»`),
                        de(ee, ` «${t.pin.description ?? ""}»`)
                    }
                    ),
                    d(I, L)
                }
                ,
                $$slots: {
                    default: !0
                }
            })
        }
        ;
        M(_, C => {
            e(l) && C(b)
        }
        )
    }
    q( () => {
        se(z, "aria-label", t.pin.name),
        se(P, "src", `/assets/pins/${t.pin.slug ?? ""}.png`),
        se(P, "alt", t.pin.name),
        se(P, "width", n()),
        se(P, "height", n())
    }
    ),
    mt("mouseenter", z, c),
    mt("mouseleave", z, h),
    d(s, m),
    Ye()
}
var pn = p("<span> </span>");
function oa(s, t) {
    We(t, !0);
    let n = me(t, "class", 3, "")
      , a = S("")
      , l = null;
    function f() {
        const h = typeof t.date == "string" ? new Date(t.date) : t.date
          , m = qs(h);
        r(a, m.text, !0),
        l && clearTimeout(l),
        l = setTimeout(f, m.nextUpdateMs)
    }
    sa( () => {
        f()
    }
    ),
    Sa( () => {
        l && clearTimeout(l)
    }
    ),
    ft( () => {
        t.date,
        f()
    }
    );
    var v = pn()
      , c = i(v, !0);
    o(v),
    q( () => {
        ye(v, 1, lr(n())),
        de(c, e(a))
    }
    ),
    d(s, v),
    Ye()
}
var wn = p('<a class="post-avatar-wrapper svelte-kvcx9g"><!></a>')
  , bn = p('<div class="post-avatar-wrapper svelte-kvcx9g"><!></div>')
  , yn = p('<a class="post-author svelte-kvcx9g"> </a>')
  , kn = p('<span class="post-author svelte-kvcx9g"> </span>')
  , xn = p('<span class="post-verified svelte-kvcx9g"><!></span>')
  , Cn = p('<button class="post-dropdown-item svelte-kvcx9g"><!> <span>Редактировать</span></button>')
  , zn = p('<button class="post-dropdown-item svelte-kvcx9g"><!> <span>Открепить</span></button>')
  , Pn = p('<button class="post-dropdown-item svelte-kvcx9g"><!> <span>Закрепить</span></button>')
  , Mn = p('<button class="post-dropdown-item danger svelte-kvcx9g"><!> <span>Удалить</span></button>')
  , Sn = p('<button class="post-dropdown-item danger svelte-kvcx9g"><!> <span>Пожаловаться</span></button>')
  , In = p('<div class="post-dropdown svelte-kvcx9g" role="menu" tabindex="-1"><button class="post-dropdown-item svelte-kvcx9g"><!> <span>Поделиться</span></button> <!> <!> <!> <!></div>')
  , Tn = p('<div class="post-header svelte-kvcx9g"><div class="post-header-left svelte-kvcx9g"><!> <div class="post-meta svelte-kvcx9g"><div class="post-meta__top svelte-kvcx9g"><!> <!> <!></div> <!></div></div> <div class="post-menu svelte-kvcx9g"><button class="post-menu-btn svelte-kvcx9g" aria-label="Меню поста"><!></button> <!></div></div>');
function Rn(s, t) {
    We(t, !0);
    let n = me(t, "verified", 3, !1)
      , a = me(t, "pin", 3, null)
      , l = me(t, "isOwner", 3, !1)
      , f = me(t, "canDelete", 3, !1)
      , v = me(t, "isPinned", 3, !1)
      , c = me(t, "canPin", 3, !1)
      , h = S(!1)
      , m = V( () => {
        const N = t.username || t.authorId;
        return N ? `/${N}` : null
    }
    );
    function z(N) {
        N.preventDefault(),
        N.stopPropagation(),
        e(m) && Ft(e(m))
    }
    function P(N) {
        N.stopPropagation(),
        r(h, !e(h))
    }
    function _() {
        r(h, !1)
    }
    function b(N) {
        N.stopPropagation(),
        t.onShare?.(),
        r(h, !1)
    }
    function C(N) {
        N.stopPropagation(),
        t.onEdit?.(),
        r(h, !1)
    }
    function I(N) {
        N.stopPropagation(),
        t.onDelete?.(),
        r(h, !1)
    }
    function R(N) {
        N.stopPropagation(),
        t.onReport?.(),
        r(h, !1)
    }
    function L(N) {
        N.stopPropagation(),
        t.onPin?.(),
        r(h, !1)
    }
    function j(N) {
        N.stopPropagation(),
        t.onUnpin?.(),
        r(h, !1)
    }
    var E = Tn()
      , F = i(E)
      , ee = i(F);
    {
        var ae = N => {
            var $ = wn();
            $.__click = z;
            var g = i($);
            kt(g, {
                get avatar() {
                    return t.avatar
                },
                get name() {
                    return t.author
                },
                size: 40
            }),
            o($),
            q( () => se($, "href", e(m))),
            d(N, $)
        }
          , J = N => {
            var $ = bn()
              , g = i($);
            kt(g, {
                get avatar() {
                    return t.avatar
                },
                get name() {
                    return t.author
                },
                size: 40
            }),
            o($),
            d(N, $)
        }
        ;
        M(ee, N => {
            e(m) ? N(ae) : N(J, !1)
        }
        )
    }
    var re = u(ee, 2)
      , ue = i(re)
      , ie = i(ue);
    {
        var ce = N => {
            var $ = yn();
            $.__click = z;
            var g = i($, !0);
            o($),
            q( () => {
                se($, "href", e(m)),
                de(g, t.author)
            }
            ),
            d(N, $)
        }
          , oe = N => {
            var $ = kn()
              , g = i($, !0);
            o($),
            q( () => de(g, t.author)),
            d(N, $)
        }
        ;
        M(ie, N => {
            e(m) ? N(ce) : N(oe, !1)
        }
        )
    }
    var O = u(ie, 2);
    {
        var D = N => {
            var $ = xn()
              , g = i($);
            mr(g, {
                size: 16
            }),
            o($),
            d(N, $)
        }
        ;
        M(O, N => {
            n() && N(D)
        }
        )
    }
    var H = u(O, 2);
    {
        var X = N => {
            na(N, {
                get pin() {
                    return a()
                }
            })
        }
        ;
        M(H, N => {
            a() && N(X)
        }
        )
    }
    o(ue);
    var te = u(ue, 2);
    oa(te, {
        get date() {
            return t.time
        },
        class: "post-time"
    }),
    o(re),
    o(F);
    var ke = u(F, 2)
      , Y = i(ke);
    Y.__click = P;
    var we = i(Y);
    Da(we, {}),
    o(Y);
    var K = u(Y, 2);
    {
        var Z = N => {
            var $ = In();
            $.__click = he => he.stopPropagation();
            var g = i($);
            g.__click = b;
            var T = i(g);
            gr(T, {
                size: 16
            }),
            Ge(2),
            o(g);
            var y = u(g, 2);
            {
                var k = he => {
                    var Se = Cn();
                    Se.__click = C;
                    var fe = i(Se);
                    Ps(fe, {
                        size: 16
                    }),
                    Ge(2),
                    o(Se),
                    d(he, Se)
                }
                ;
                M(y, he => {
                    l() && he(k)
                }
                )
            }
            var x = u(y, 2);
            {
                var w = he => {
                    var Se = He()
                      , fe = Pe(Se);
                    {
                        var ze = Oe => {
                            var U = zn();
                            U.__click = j;
                            var W = i(U);
                            Ja(W, {
                                size: 16
                            }),
                            Ge(2),
                            o(U),
                            d(Oe, U)
                        }
                          , je = Oe => {
                            var U = Pn();
                            U.__click = L;
                            var W = i(U);
                            Ja(W, {
                                size: 16
                            }),
                            Ge(2),
                            o(U),
                            d(Oe, U)
                        }
                        ;
                        M(fe, Oe => {
                            v() ? Oe(ze) : Oe(je, !1)
                        }
                        )
                    }
                    d(he, Se)
                }
                ;
                M(x, he => {
                    c() && he(w)
                }
                )
            }
            var A = u(x, 2);
            {
                var Q = he => {
                    var Se = Mn();
                    Se.__click = I;
                    var fe = i(Se);
                    qa(fe, {
                        size: 16
                    }),
                    Ge(2),
                    o(Se),
                    d(he, Se)
                }
                ;
                M(A, he => {
                    (l() || f()) && he(Q)
                }
                )
            }
            var le = u(A, 2);
            {
                var xe = he => {
                    var Se = Sn();
                    Se.__click = R;
                    var fe = i(Se);
                    ja(fe, {
                        size: 16
                    }),
                    Ge(2),
                    o(Se),
                    d(he, Se)
                }
                ;
                M(le, he => {
                    !l() && !f() && he(xe)
                }
                )
            }
            o($),
            Yt($, (he, Se) => pa?.(he, Se), () => _),
            d(N, $)
        }
        ;
        M(K, N => {
            e(h) && N(Z)
        }
        )
    }
    o(ke),
    o(E),
    d(s, E),
    Ye()
}
Ze(["click"]);
var Dn = p('<div class="mosaic__overlay svelte-1jfdpkh"><span> </span></div>')
  , jn = p("<button><!> <!></button>")
  , qn = p("<div></div> <!>", 1);
function Aa(s, t) {
    We(t, !0);
    let n = me(t, "disableGallery", 3, !1)
      , a = S(!1)
      , l = S(0);
    function f(P, _) {
        _.stopPropagation(),
        !n() && (r(l, P, !0),
        r(a, !0))
    }
    function v() {
        r(a, !1)
    }
    function c(P) {
        if (P.width && P.height) {
            const _ = P.width / P.height;
            return `aspect-ratio: ${Math.max(.5, Math.min(2, _))};`
        }
        return ""
    }
    var h = He()
      , m = Pe(h);
    {
        var z = P => {
            var _ = qn()
              , b = Pe(_);
            let C;
            Qe(b, 23, () => t.attachments.slice(0, 4), (L, j) => L.id || j, (L, j, E) => {
                var F = jn();
                F.__click = re => f(e(E), re);
                var ee = i(F);
                {
                    let re = V( () => e(j).alt || "");
                    Ti(ee, {
                        get src() {
                            return e(j).url
                        },
                        get alt() {
                            return e(re)
                        },
                        get width() {
                            return e(j).width
                        },
                        get height() {
                            return e(j).height
                        }
                    })
                }
                var ae = u(ee, 2);
                {
                    var J = re => {
                        var ue = Dn()
                          , ie = i(ue)
                          , ce = i(ie);
                        o(ie),
                        o(ue),
                        q( () => de(ce, `+${t.attachments.length - 4}`)),
                        d(re, ue)
                    }
                    ;
                    M(ae, re => {
                        e(E) === 3 && t.attachments.length > 4 && re(J)
                    }
                    )
                }
                o(F),
                q( () => ye(F, 1, `mosaic__item mosaic__item--${e(E) + 1}`, "svelte-1jfdpkh")),
                d(L, F)
            }
            ),
            o(b);
            var I = u(b, 2);
            {
                var R = L => {
                    Mr(L, {
                        get isOpen() {
                            return e(a)
                        },
                        get attachments() {
                            return t.attachments
                        },
                        get initialIndex() {
                            return e(l)
                        },
                        onClose: v
                    })
                }
                ;
                M(I, L => {
                    n() || L(R)
                }
                )
            }
            q(L => {
                C = ye(b, 1, "mosaic svelte-1jfdpkh", null, C, {
                    "mosaic--1": t.attachments.length === 1,
                    "mosaic--2": t.attachments.length === 2,
                    "mosaic--3": t.attachments.length === 3,
                    "mosaic--4": t.attachments.length >= 4
                }),
                lt(b, L)
            }
            , [ () => t.attachments.length === 1 ? c(t.attachments[0]) : ""]),
            d(P, _)
        }
        ;
        M(m, P => {
            t.attachments.length > 0 && P(z)
        }
        )
    }
    d(s, h),
    Ye()
}
Ze(["click"]);
var An = p('<div class="post-actions svelte-1055p8k"><div class="post-actions-left svelte-1055p8k"><button><!> <span class="svelte-1055p8k"> </span></button> <button class="post-action svelte-1055p8k"><!> <span class="svelte-1055p8k"> </span></button> <button><!> <span class="svelte-1055p8k"> </span></button></div> <div class="post-actions-right svelte-1055p8k"><div class="post-views svelte-1055p8k"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-1055p8k"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z" class="svelte-1055p8k"></path><circle cx="12" cy="12" r="3" class="svelte-1055p8k"></circle></svg> <span class="svelte-1055p8k"> </span></div></div></div>');
function Ln(s, t) {
    We(t, !0);
    const n = () => Ke(e(f), "$postStateStore", a)
      , [a,l] = Ct();
    let f = V( () => vt.getPostStore(t.postId))
      , v = S(!1)
      , c = Promise.resolve()
      , h = V( () => n()?.isLiked ?? t.isLiked)
      , m = V( () => n()?.likesCount ?? t.likes)
      , z = V( () => n()?.isReposted ?? t.isReposted)
      , P = V( () => n()?.repostsCount ?? t.reposts)
      , _ = V( () => n()?.commentsCount ?? t.commentsCount);
    sa( () => {
        vt.get(t.postId) || vt.set(t.postId, {
            isLiked: t.isLiked,
            likesCount: t.likes,
            isReposted: t.isReposted,
            repostsCount: t.reposts,
            commentsCount: t.commentsCount
        })
    }
    );
    function b(Z) {
        if (Z.stopPropagation(),
        !jt())
            return;
        r(v, !0);
        const N = !e(h);
        vt.toggleLike(t.postId, N),
        c = c.then(async () => {
            (N ? await ut.likePost(t.postId) : await ut.unlikePost(t.postId)).success || vt.toggleLike(t.postId, !N)
        }
        )
    }
    async function C(Z) {
        Z.stopPropagation(),
        jt() && (t.isOwner || (e(z) ? (vt.toggleRepost(t.postId, !1),
        (await ut.unrepostPost(t.postId)).success || vt.toggleRepost(t.postId, !0)) : t.onRepostClick?.()))
    }
    function I(Z) {
        vt.toggleRepost(t.postId, Z)
    }
    var R = {
        setReposted: I
    }
      , L = An()
      , j = i(L)
      , E = i(j);
    let F;
    E.__click = b;
    var ee = i(E);
    Ra(ee, {
        size: 20,
        get filled() {
            return e(h)
        }
    });
    var ae = u(ee, 2)
      , J = i(ae, !0);
    o(ae),
    o(E);
    var re = u(E, 2);
    re.__click = Z => {
        Z.stopPropagation(),
        jt() && t.onCommentClick?.()
    }
    ;
    var ue = i(re);
    hr(ue, {
        size: 20
    });
    var ie = u(ue, 2)
      , ce = i(ie, !0);
    o(ie),
    o(re);
    var oe = u(re, 2);
    let O;
    oe.__click = C;
    var D = i(oe);
    _a(D, {
        size: 20
    });
    var H = u(D, 2)
      , X = i(H, !0);
    o(H),
    o(oe),
    o(j);
    var te = u(j, 2)
      , ke = i(te)
      , Y = u(i(ke), 2)
      , we = i(Y, !0);
    o(Y),
    o(ke),
    o(te),
    o(L),
    q( (Z, N, $, g) => {
        F = ye(E, 1, "post-action like svelte-1055p8k", null, F, {
            liked: e(h),
            animated: e(v)
        }),
        de(J, Z),
        de(ce, N),
        O = ye(oe, 1, "post-action repost svelte-1055p8k", null, O, {
            reposted: e(z),
            disabled: t.isOwner
        }),
        oe.disabled = t.isOwner,
        se(oe, "title", t.isOwner ? "Нельзя репостнуть свой пост" : e(z) ? "Убрать репост" : "Репост"),
        de(X, $),
        de(we, g)
    }
    , [ () => Rt(e(m)), () => Rt(e(_)), () => Rt(e(P)), () => Rt(t.views)]),
    d(s, L);
    var K = Ye(R);
    return l(),
    K
}
Ze(["click"]);
var Un = p('<div class="original-post__deleted svelte-9y6twa"><span>Оригинальный пост был удалён</span></div>')
  , On = p('<p class="original-post__content svelte-9y6twa"> </p>')
  , Bn = p('<div class="original-post__gallery svelte-9y6twa"><!></div>')
  , En = p('<div class="original-post__header svelte-9y6twa"><div class="original-post__repost-icon svelte-9y6twa"><!></div> <!> <div class="original-post__info svelte-9y6twa"><span class="original-post__name svelte-9y6twa"> <!> <!></span> <span class="original-post__meta svelte-9y6twa"><!><!></span></div></div> <!> <!>', 1)
  , Hn = p("<button><!></button>");
function yr(s, t) {
    We(t, !0);
    function n() {
        t.post.isDeleted || t.onPostClick?.(t.post.id)
    }
    var a = Hn();
    let l;
    a.__click = n;
    var f = i(a);
    {
        var v = h => {
            var m = Un();
            d(h, m)
        }
          , c = h => {
            var m = En()
              , z = Pe(m)
              , P = i(z)
              , _ = i(P);
            _a(_, {
                size: 16
            }),
            o(P);
            var b = u(P, 2);
            kt(b, {
                get avatar() {
                    return t.post.author.avatar
                },
                get name() {
                    return t.post.author.displayName
                },
                size: 32
            });
            var C = u(b, 2)
              , I = i(C)
              , R = i(I)
              , L = u(R);
            {
                var j = O => {
                    La(O, {})
                }
                ;
                M(L, O => {
                    t.post.author.verified && O(j)
                }
                )
            }
            var E = u(L, 2);
            {
                var F = O => {
                    na(O, {
                        get pin() {
                            return t.post.author.pin
                        }
                    })
                }
                ;
                M(E, O => {
                    t.post.author.pin && O(F)
                }
                )
            }
            o(I);
            var ee = u(I, 2)
              , ae = i(ee);
            {
                var J = O => {
                    var D = Wt();
                    q( () => de(D, `@${t.post.author.username ?? ""} ·`)),
                    d(O, D)
                }
                ;
                M(ae, O => {
                    t.post.author.username && O(J)
                }
                )
            }
            var re = u(ae);
            oa(re, {
                get date() {
                    return t.post.createdAt
                }
            }),
            o(ee),
            o(C),
            o(z);
            var ue = u(z, 2);
            {
                var ie = O => {
                    var D = On()
                      , H = i(D, !0);
                    o(D),
                    q( () => de(H, t.post.content)),
                    d(O, D)
                }
                ;
                M(ue, O => {
                    t.post.content && O(ie)
                }
                )
            }
            var ce = u(ue, 2);
            {
                var oe = O => {
                    var D = Bn()
                      , H = i(D);
                    Aa(H, {
                        get attachments() {
                            return t.post.attachments
                        },
                        compact: !0
                    }),
                    o(D),
                    d(O, D)
                }
                ;
                M(ce, O => {
                    t.post.attachments && t.post.attachments.length > 0 && O(oe)
                }
                )
            }
            q( () => de(R, `${t.post.author.displayName ?? ""} `)),
            d(h, m)
        }
        ;
        M(f, h => {
            t.post.isDeleted ? h(v) : h(c, !1)
        }
        )
    }
    o(a),
    q( () => l = ye(a, 1, "original-post svelte-9y6twa", null, l, {
        deleted: t.post.isDeleted
    })),
    d(s, a),
    Ye()
}
Ze(["click"]);
function Nn() {
    const {subscribe: s, set: t, update: n} = xt({
        topClans: null,
        whoToFollow: null,
        trendingHashtags: null
    });
    return {
        subscribe: s,
        setTopClans(a) {
            n(l => ({
                ...l,
                topClans: a
            }))
        },
        getTopClans() {
            return wt({
                subscribe: s
            }).topClans
        },
        setWhoToFollow(a) {
            n(l => ({
                ...l,
                whoToFollow: a
            }))
        },
        getWhoToFollow() {
            return wt({
                subscribe: s
            }).whoToFollow
        },
        setTrendingHashtags(a) {
            n(l => ({
                ...l,
                trendingHashtags: a
            }))
        },
        getTrendingHashtags() {
            return wt({
                subscribe: s
            }).trendingHashtags
        },
        clear() {
            t({
                topClans: null,
                whoToFollow: null,
                trendingHashtags: null
            })
        }
    }
}
const uc = Nn()
  , Ut = 300 * 1e3;
function Fn() {
    const {subscribe: s, set: t, update: n} = xt({
        popular: null,
        following: null
    });
    return {
        subscribe: s,
        setTab(a, l) {
            n(f => ({
                ...f,
                [a]: {
                    data: l,
                    timestamp: Date.now()
                }
            }))
        },
        appendPosts(a, l, f, v) {
            n(c => {
                const h = c[a];
                if (!h)
                    return c;
                const m = new Set(h.data.posts.map(P => P.id))
                  , z = l.filter(P => !m.has(P.id));
                return {
                    ...c,
                    [a]: {
                        data: {
                            posts: [...h.data.posts, ...z],
                            nextCursor: f,
                            hasMore: v
                        },
                        timestamp: h.timestamp
                    }
                }
            }
            )
        },
        prependPost(a, l) {
            n(f => {
                const v = f[a];
                return v ? {
                    ...f,
                    [a]: {
                        data: {
                            ...v.data,
                            posts: [l, ...v.data.posts]
                        },
                        timestamp: v.timestamp
                    }
                } : f
            }
            )
        },
        removePost(a) {
            n(l => {
                const f = {
                    ...l
                };
                for (const v of ["popular", "following"]) {
                    const c = f[v];
                    c && (f[v] = {
                        ...c,
                        data: {
                            ...c.data,
                            posts: c.data.posts.filter(h => h.id !== a)
                        }
                    })
                }
                return f
            }
            )
        },
        getTab(a) {
            const f = wt({
                subscribe: s
            })[a];
            return !f || Date.now() - f.timestamp > Ut ? null : f.data
        },
        isValid(a) {
            const f = wt({
                subscribe: s
            })[a];
            return f ? Date.now() - f.timestamp <= Ut : !1
        },
        clear() {
            t({
                popular: null,
                following: null
            })
        }
    }
}
function Vn() {
    const {subscribe: s, set: t, update: n} = xt(null);
    return {
        subscribe: s,
        setData(a) {
            t({
                ...a,
                timestamp: Date.now()
            })
        },
        getData() {
            const a = wt({
                subscribe: s
            });
            return !a || Date.now() - a.timestamp > Ut ? null : a
        },
        isValid() {
            const a = wt({
                subscribe: s
            });
            return a ? Date.now() - a.timestamp <= Ut : !1
        },
        clear() {
            t(null)
        }
    }
}
function Wn() {
    const {subscribe: s, set: t, update: n} = xt(null);
    return {
        subscribe: s,
        setData(a, l) {
            t({
                notifications: a,
                hasMore: l,
                timestamp: Date.now()
            })
        },
        appendNotifications(a, l) {
            n(f => {
                if (!f)
                    return null;
                const v = new Set(f.notifications.map(h => h.id))
                  , c = a.filter(h => !v.has(h.id));
                return {
                    notifications: [...f.notifications, ...c],
                    hasMore: l,
                    timestamp: f.timestamp
                }
            }
            )
        },
        getData() {
            const a = wt({
                subscribe: s
            });
            return !a || Date.now() - a.timestamp > Ut ? null : a
        },
        isValid() {
            const a = wt({
                subscribe: s
            });
            return a ? Date.now() - a.timestamp <= Ut : !1
        },
        clear() {
            t(null)
        }
    }
}
function Yn() {
    const {subscribe: s, set: t, update: n} = xt({});
    return {
        subscribe: s,
        setProfile(a, l, f, v="posts") {
            n(c => ({
                ...c,
                [a]: {
                    profile: l,
                    posts: v === "posts" ? f : c[a]?.posts || {
                        posts: [],
                        nextCursor: null,
                        hasMore: !1
                    },
                    liked: v === "liked" ? f : c[a]?.liked || {
                        posts: [],
                        nextCursor: null,
                        hasMore: !1
                    },
                    timestamp: Date.now()
                }
            }))
        },
        setPostsTab(a, l, f) {
            n(v => {
                const c = v[a];
                return c ? {
                    ...v,
                    [a]: {
                        ...c,
                        [l]: f,
                        timestamp: c.timestamp
                    }
                } : v
            }
            )
        },
        appendPosts(a, l, f, v, c) {
            n(h => {
                const m = h[a];
                if (!m)
                    return h;
                const z = m[l].posts
                  , P = new Set(z.map(b => b.id))
                  , _ = f.filter(b => !P.has(b.id));
                return {
                    ...h,
                    [a]: {
                        ...m,
                        [l]: {
                            posts: [...z, ..._],
                            nextCursor: v,
                            hasMore: c
                        }
                    }
                }
            }
            )
        },
        prependPost(a, l) {
            n(f => {
                const v = f[a];
                return v ? {
                    ...f,
                    [a]: {
                        ...v,
                        posts: {
                            ...v.posts,
                            posts: [l, ...v.posts.posts]
                        }
                    }
                } : f
            }
            )
        },
        removePost(a) {
            n(l => {
                const f = {
                    ...l
                };
                for (const v of Object.keys(f)) {
                    const c = f[v];
                    c && (f[v] = {
                        ...c,
                        posts: {
                            ...c.posts,
                            posts: c.posts.posts.filter(h => h.id !== a)
                        },
                        liked: {
                            ...c.liked,
                            posts: c.liked.posts.filter(h => h.id !== a)
                        }
                    })
                }
                return f
            }
            )
        },
        updateProfile(a, l) {
            n(f => {
                const v = f[a];
                return v ? {
                    ...f,
                    [a]: {
                        ...v,
                        profile: {
                            ...v.profile,
                            ...l
                        }
                    }
                } : f
            }
            )
        },
        getProfile(a) {
            const f = wt({
                subscribe: s
            })[a];
            return !f || Date.now() - f.timestamp > Ut ? null : f
        },
        isValid(a) {
            const f = wt({
                subscribe: s
            })[a];
            return f ? Date.now() - f.timestamp <= Ut : !1
        },
        clear(a) {
            a ? n(l => {
                const {[a]: f, ...v} = l;
                return v
            }
            ) : t({})
        }
    }
}
const kr = Fn();
Vn();
Wn();
const xr = Yn();
var Xn = p('<div class="post-deleted svelte-cvb24n"><span class="post-deleted-text svelte-cvb24n">Пост удалён.</span> <button class="post-restore-btn svelte-cvb24n"> </button></div>')
  , Zn = p('<div class="post-pinned-badge svelte-cvb24n"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-cvb24n"><line x1="12" y1="17" x2="12" y2="22" class="svelte-cvb24n"></line><path d="M5 17h14v-1.76a2 2 0 0 0-1.11-1.79l-1.78-.9A2 2 0 0 1 15 10.76V6h1a2 2 0 0 0 0-4H8a2 2 0 0 0 0 4h1v4.76a2 2 0 0 1-1.11 1.79l-1.78.9A2 2 0 0 0 5 15.24Z" class="svelte-cvb24n"></path></svg> <span class="svelte-cvb24n">Закреплённый пост</span></div>')
  , Kn = p('<div class="post svelte-cvb24n"><!> <!> <!> <!> <!> <!></div>')
  , Gn = p('<div role="article" tabindex="0"><!></div> <!> <!> <!>', 1);
function fc(s, t) {
    We(t, !0);
    let n = me(t, "isPinned", 3, !1)
      , a = me(t, "canPin", 3, !1)
      , l = me(t, "isHighlighted", 3, !1)
      , f = me(t, "isWallOwner", 3, !1)
      , v = V( () => t.post.id)
      , c = V( () => t.post.author.displayName)
      , h = V( () => t.post.author.id)
      , m = V( () => t.post.author.username)
      , z = V( () => t.post.author.avatar || "")
      , P = V( () => t.post.createdAt)
      , _ = V( () => t.post.author.verified)
      , b = V( () => t.post.author.pin || null)
      , C = V( () => t.post.attachments)
      , I = V( () => t.post.originalPost || null)
      , R = V( () => t.post.isOwner ?? !1)
      , L = V( () => e(R) || f())
      , j = t.post.isViewed ?? !1
      , E = t.post.commentsCount
      , F = t.post.content
      , ee = S(rt(j))
      , ae = S(!1)
      , J = S(!1)
      , re = S(!1)
      , ue = rt(E)
      , ie = S(null)
      , ce = S(!1)
      , oe = S(!1)
      , O = S(!1)
      , D = S(null)
      , H = S(rt(F));
    const X = 2e3;
    function te(B) {
        if (e(ee))
            return {
                destroy() {}
            };
        const G = e(v)
          , Ce = t.onView;
        let De = null;
        const ve = new IntersectionObserver(be => {
            be.forEach(_e => {
                _e.isIntersecting && _e.intersectionRatio >= .5 ? De || (De = setTimeout( () => {
                    r(ee, !0),
                    Ce?.(G),
                    ve.disconnect()
                }
                , X)) : De && (clearTimeout(De),
                De = null)
            }
            )
        }
        ,{
            threshold: .5
        });
        return ve.observe(B),
        {
            destroy() {
                De && clearTimeout(De),
                ve.disconnect()
            }
        }
    }
    function ke() {
        const B = `${window.location.origin}/@${e(m)}/post/${e(v)}`;
        navigator.clipboard.writeText(B),
        alert("Ссылка скопирована!")
    }
    async function Y() {
        if (!e(J)) {
            r(J, !0);
            try {
                (await ut.deletePost(e(v))).success && (r(ae, !0),
                kr.removePost(e(v)),
                xr.removePost(e(v)),
                t.onDelete?.())
            } catch {} finally {
                r(J, !1)
            }
        }
    }
    async function we() {
        if (!e(re)) {
            r(re, !0);
            try {
                (await ut.restorePost(e(v))).success && r(ae, !1)
            } catch {} finally {
                r(re, !1)
            }
        }
    }
    function K() {
        t.onModalOpen?.(e(v), e(m))
    }
    function Z() {
        r(ce, !0)
    }
    function N(B) {
        r(H, B, !0)
    }
    function $() {
        r(oe, !0)
    }
    function g(B) {
        e(ie)?.setReposted(!0),
        t.onRepost?.(B)
    }
    function T(B) {
        if (t.onModalOpen) {
            const G = e(I)?.author?.username || null;
            t.onModalOpen(B, G)
        } else
            r(D, B, !0),
            r(O, !0)
    }
    function y() {
        r(O, !1),
        r(D, null),
        t.onModalClose?.()
    }
    let k = V( () => ({
        id: e(v),
        content: e(H),
        author: {
            id: e(h),
            username: e(m) || null,
            displayName: e(c),
            avatar: e(z) || null,
            verified: e(_),
            pin: e(b)
        },
        createdAt: e(P)
    }));
    function x(B) {
        const G = B.target;
        G.closest("button") || G.closest("a") || G.closest("input") || G.closest("textarea") || G.closest("select") || G.closest(".post-dropdown") || t.onModalOpen?.(e(v), e(m))
    }
    function w(B) {
        if (B.key === "Enter" || B.key === " ") {
            const G = B.target;
            if (G.closest("button") || G.closest("a") || G.closest("input") || G.closest("textarea") || G.closest("select"))
                return;
            B.preventDefault(),
            t.onModalOpen?.(e(v), e(m))
        }
    }
    var A = Gn()
      , Q = Pe(A);
    let le;
    Q.__click = x,
    Q.__keydown = w;
    var xe = i(Q);
    {
        var he = B => {
            var G = Xn()
              , Ce = u(i(G), 2);
            Ce.__click = we;
            var De = i(Ce, !0);
            o(Ce),
            o(G),
            q( () => {
                Ce.disabled = e(re),
                de(De, e(re) ? "Восстановление..." : "Восстановить")
            }
            ),
            d(B, G)
        }
          , Se = B => {
            var G = Kn()
              , Ce = i(G);
            {
                var De = Ie => {
                    var qe = Zn();
                    d(Ie, qe)
                }
                ;
                M(Ce, Ie => {
                    n() && Ie(De)
                }
                )
            }
            var ve = u(Ce, 2);
            Rn(ve, {
                get author() {
                    return e(c)
                },
                get authorId() {
                    return e(h)
                },
                get username() {
                    return e(m)
                },
                get avatar() {
                    return e(z)
                },
                get time() {
                    return e(P)
                },
                get verified() {
                    return e(_)
                },
                get pin() {
                    return e(b)
                },
                get isOwner() {
                    return e(R)
                },
                get canDelete() {
                    return e(L)
                },
                get isPinned() {
                    return n()
                },
                get canPin() {
                    return a()
                },
                onShare: ke,
                onEdit: Z,
                onDelete: Y,
                get onReport() {
                    return t.onReport
                },
                get onPin() {
                    return t.onPin
                },
                get onUnpin() {
                    return t.onUnpin
                }
            });
            var be = u(ve, 2);
            {
                var _e = Ie => {
                    Ir(Ie, {
                        get content() {
                            return e(H)
                        },
                        maxHeight: 1e3
                    })
                }
                ;
                M(be, Ie => {
                    e(H) && Ie(_e)
                }
                )
            }
            var Me = u(be, 2);
            {
                var ge = Ie => {
                    yr(Ie, {
                        get post() {
                            return e(I)
                        },
                        onPostClick: T
                    })
                }
                ;
                M(Me, Ie => {
                    e(I) && Ie(ge)
                }
                )
            }
            var Te = u(Me, 2);
            Aa(Te, {
                get attachments() {
                    return e(C)
                }
            });
            var Ne = u(Te, 2);
            et(Ln(Ne, {
                get postId() {
                    return e(v)
                },
                get likes() {
                    return t.post.likesCount
                },
                get commentsCount() {
                    return ue
                },
                get reposts() {
                    return t.post.repostsCount
                },
                get views() {
                    return t.post.viewsCount
                },
                get isLiked() {
                    return t.post.isLiked
                },
                get isReposted() {
                    return t.post.isReposted
                },
                get isOwner() {
                    return e(R)
                },
                onCommentClick: K,
                onRepostClick: $
            }), Ie => r(ie, Ie, !0), () => e(ie)),
            o(G),
            d(B, G)
        }
        ;
        M(xe, B => {
            e(ae) ? B(he) : B(Se, !1)
        }
        )
    }
    o(Q),
    Yt(Q, B => te?.(B));
    var fe = u(Q, 2);
    {
        var ze = B => {
            ra(B, {
                children: (G, Ce) => {
                    Xo(G, {
                        get isOpen() {
                            return e(ce)
                        },
                        get postId() {
                            return e(v)
                        },
                        get initialContent() {
                            return e(H)
                        },
                        onClose: () => r(ce, !1),
                        onSave: N
                    })
                }
                ,
                $$slots: {
                    default: !0
                }
            })
        }
        ;
        M(fe, B => {
            e(ce) && B(ze)
        }
        )
    }
    var je = u(fe, 2);
    {
        var Oe = B => {
            ra(B, {
                children: (G, Ce) => {
                    zr(G, {
                        get isOpen() {
                            return e(oe)
                        },
                        get originalPost() {
                            return e(k)
                        },
                        onClose: () => r(oe, !1),
                        onRepost: g
                    })
                }
                ,
                $$slots: {
                    default: !0
                }
            })
        }
        ;
        M(je, B => {
            e(oe) && B(Oe)
        }
        )
    }
    var U = u(je, 2);
    {
        var W = B => {
            ra(B, {
                children: (G, Ce) => {
                    Kl(G, {
                        get isOpen() {
                            return e(O)
                        },
                        get postId() {
                            return e(D)
                        },
                        onClose: y
                    })
                }
                ,
                $$slots: {
                    default: !0
                }
            })
        }
        ;
        M(U, B => {
            e(O) && e(D) && B(W)
        }
        )
    }
    q( () => {
        le = ye(Q, 1, "post-container svelte-cvb24n", null, le, {
            deleting: e(J),
            highlighted: l()
        }),
        se(Q, "data-post-id", e(v))
    }
    ),
    d(s, A),
    Ye()
}
Ze(["click", "keydown"]);
var Qn = p('<div><span class="item-deleted-text svelte-4g9e7z"> </span> <button class="item-restore-btn svelte-4g9e7z"> </button></div>')
  , Jn = p('<a class="item-avatar-wrapper svelte-4g9e7z"><!></a>')
  , $n = p('<div class="item-avatar-wrapper svelte-4g9e7z"><!></div>')
  , eo = p('<a class="item-author svelte-4g9e7z"> </a>')
  , to = p('<span class="item-author svelte-4g9e7z"> </span>')
  , ao = p('<button class="item-dropdown-item delete svelte-4g9e7z"><!> <span class="svelte-4g9e7z">Удалить</span></button>')
  , ro = p('<button class="item-dropdown-item svelte-4g9e7z"><!> <span class="svelte-4g9e7z">Пожаловаться</span></button>')
  , so = p('<div class="item-dropdown svelte-4g9e7z" role="menu" tabindex="-1"><!> <!></div>')
  , no = p('<div class="item-menu svelte-4g9e7z"><button aria-label="Меню"><!></button> <!></div>')
  , oo = p('<a class="item-mention svelte-4g9e7z"> </a> ', 1)
  , io = p('<span class="item-mention svelte-4g9e7z"> </span> ', 1)
  , lo = p('<div class="item-voice-messages svelte-4g9e7z"></div>')
  , co = p('<button class="item-attachment svelte-4g9e7z"><img class="svelte-4g9e7z"/></button>')
  , vo = p("<div></div>")
  , uo = p("<!> <!>", 1)
  , fo = p('<span class="svelte-4g9e7z"> </span>')
  , ho = p('<div><!> <div class="item-content svelte-4g9e7z"><div class="item-header svelte-4g9e7z"><div class="item-header-left svelte-4g9e7z"><!> <!> <!></div> <!></div> <!> <p class="item-text svelte-4g9e7z"><!><!></p> <!> <div class="item-actions svelte-4g9e7z"><button class="item-action-btn svelte-4g9e7z"><span class="svelte-4g9e7z">Ответить</span></button> <button><!> <!></button></div></div></div>')
  , go = p("<!> <!>", 1);
function sr(s, t) {
    We(t, !0);
    const n = () => Ke(Ot, "$currentUser", f)
      , a = () => Ke(Ta, "$isAuthenticated", f)
      , l = () => Ke(_r, "$isMobile", f)
      , [f,v] = Ct();
    let c = me(t, "likes", 3, 0)
      , h = me(t, "isLiked", 3, !1)
      , m = me(t, "replyTo", 3, null)
      , z = me(t, "variant", 3, "comment")
      , P = me(t, "canDelete", 3, !1)
      , _ = me(t, "attachments", 19, () => [])
      , b = me(t, "isHighlighted", 3, !1)
      , C = S(!1)
      , I = S(0);
    function R(w) {
        r(I, w, !0),
        r(C, !0)
    }
    function L() {
        r(C, !1)
    }
    let j = S(rt(h()))
      , E = S(0)
      , F = V( () => c() + e(E))
      , ee = S(!1)
      , ae = Promise.resolve()
      , J = S(!1)
      , re = S(!1)
      , ue = S(!1)
      , ie = S(!1)
      , ce = V( () => n()?.id === t.author.id)
      , oe = V( () => z() === "comment" ? 32 : 24)
      , O = V( () => z() === "reply")
      , D = V( () => {
        const w = t.author.username || t.author.id;
        return w ? `/${w}` : null
    }
    )
      , H = V( () => {
        if (!m())
            return null;
        const w = m().username || m().id;
        return w ? `/${w}` : null
    }
    )
      , X = V( () => {
        if (!t.content)
            return "";
        if (!m())
            return t.content;
        const w = [`@${m().displayName},`, `@${m().displayName} `, `@${m().username},`, `@${m().username} `].filter(Boolean);
        for (const A of w)
            if (t.content.startsWith(A))
                return t.content.slice(A.length).trimStart();
        return t.content
    }
    );
    function te(w) {
        if (w.stopPropagation(),
        !jt())
            return;
        r(ee, !0);
        const A = !e(j);
        r(j, A),
        r(E, A ? e(E) + 1 : e(E) - 1, !0),
        ae = ae.then(async () => {
            !(A ? await Tt.likeComment(t.id) : await Tt.unlikeComment(t.id)).success && e(j) === A && (r(j, !A),
            r(E, A ? e(E) - 1 : e(E) + 1, !0))
        }
        )
    }
    function ke(w) {
        w.stopPropagation(),
        jt() && t.onReplyClick?.()
    }
    function Y(w) {
        w.stopPropagation(),
        r(J, !e(J))
    }
    function we() {
        r(J, !1)
    }
    async function K(w) {
        if (w.stopPropagation(),
        !e(re)) {
            r(re, !0),
            r(J, !1);
            try {
                (await Tt.deleteComment(t.id)).success && (r(ue, !0),
                t.onDelete?.())
            } catch {} finally {
                r(re, !1)
            }
        }
    }
    async function Z() {
        if (!e(ie)) {
            r(ie, !0);
            try {
                (await Tt.restoreComment(t.id)).success && (r(ue, !1),
                t.onRestore?.())
            } catch {} finally {
                r(ie, !1)
            }
        }
    }
    function N(w) {
        w.stopPropagation(),
        r(J, !1),
        t.onReport?.()
    }
    var $ = go()
      , g = Pe($);
    {
        var T = w => {
            var A = Qn();
            let Q;
            var le = i(A)
              , xe = i(le, !0);
            o(le);
            var he = u(le, 2);
            he.__click = Z;
            var Se = i(he, !0);
            o(he),
            o(A),
            q( () => {
                Q = ye(A, 1, "item-deleted svelte-4g9e7z", null, Q, {
                    "is-reply": e(O)
                }),
                de(xe, e(O) ? "Ответ удалён." : "Комментарий удалён."),
                he.disabled = e(ie),
                de(Se, e(ie) ? "Восстановление..." : "Восстановить")
            }
            ),
            d(w, A)
        }
          , y = w => {
            var A = ho();
            let Q;
            var le = i(A);
            {
                var xe = ne => {
                    var pe = Jn()
                      , Ue = i(pe);
                    kt(Ue, {
                        get avatar() {
                            return t.author.avatar
                        },
                        get name() {
                            return t.author.displayName
                        },
                        get size() {
                            return e(oe)
                        }
                    }),
                    o(pe),
                    q( () => se(pe, "href", e(D))),
                    d(ne, pe)
                }
                  , he = ne => {
                    var pe = $n()
                      , Ue = i(pe);
                    kt(Ue, {
                        get avatar() {
                            return t.author.avatar
                        },
                        get name() {
                            return t.author.displayName
                        },
                        get size() {
                            return e(oe)
                        }
                    }),
                    o(pe),
                    d(ne, pe)
                }
                ;
                M(le, ne => {
                    e(D) ? ne(xe) : ne(he, !1)
                }
                )
            }
            var Se = u(le, 2)
              , fe = i(Se)
              , ze = i(fe)
              , je = i(ze);
            {
                var Oe = ne => {
                    var pe = eo()
                      , Ue = i(pe, !0);
                    o(pe),
                    q( () => {
                        se(pe, "href", e(D)),
                        de(Ue, t.author.displayName)
                    }
                    ),
                    d(ne, pe)
                }
                  , U = ne => {
                    var pe = to()
                      , Ue = i(pe, !0);
                    o(pe),
                    q( () => de(Ue, t.author.displayName)),
                    d(ne, pe)
                }
                ;
                M(je, ne => {
                    e(D) ? ne(Oe) : ne(U, !1)
                }
                )
            }
            var W = u(je, 2);
            {
                var B = ne => {
                    {
                        let pe = V( () => e(O) ? 12 : 14);
                        La(ne, {
                            get size() {
                                return e(pe)
                            }
                        })
                    }
                }
                ;
                M(W, ne => {
                    t.author.verified && ne(B)
                }
                )
            }
            var G = u(W, 2);
            {
                var Ce = ne => {
                    na(ne, {
                        get pin() {
                            return t.author.pin
                        }
                    })
                }
                ;
                M(G, ne => {
                    t.author.pin && ne(Ce)
                }
                )
            }
            o(ze);
            var De = u(ze, 2);
            {
                var ve = ne => {
                    var pe = no()
                      , Ue = i(pe);
                    let tt;
                    Ue.__click = Y;
                    var $e = i(Ue);
                    {
                        let yt = V( () => e(O) ? 14 : 16);
                        Da($e, {
                            get size() {
                                return e(yt)
                            }
                        })
                    }
                    o(Ue);
                    var ht = u(Ue, 2);
                    {
                        var pt = yt => {
                            var at = so();
                            at.__click = gt => gt.stopPropagation();
                            var _t = i(at);
                            {
                                var qt = gt => {
                                    var ot = ao();
                                    ot.__click = K;
                                    var zt = i(ot);
                                    {
                                        let ea = V( () => e(O) ? 14 : 16);
                                        qa(zt, {
                                            get size() {
                                                return e(ea)
                                            }
                                        })
                                    }
                                    Ge(2),
                                    o(ot),
                                    d(gt, ot)
                                }
                                ;
                                M(_t, gt => {
                                    (e(ce) || P()) && gt(qt)
                                }
                                )
                            }
                            var At = u(_t, 2);
                            {
                                var Bt = gt => {
                                    var ot = ro();
                                    ot.__click = N;
                                    var zt = i(ot);
                                    {
                                        let ea = V( () => e(O) ? 14 : 16);
                                        ja(zt, {
                                            get size() {
                                                return e(ea)
                                            }
                                        })
                                    }
                                    Ge(2),
                                    o(ot),
                                    d(gt, ot)
                                }
                                ;
                                M(At, gt => {
                                    !e(ce) && !P() && gt(Bt)
                                }
                                )
                            }
                            o(at),
                            Yt(at, (gt, ot) => pa?.(gt, ot), () => we),
                            d(yt, at)
                        }
                        ;
                        M(ht, yt => {
                            e(J) && yt(pt)
                        }
                        )
                    }
                    o(pe),
                    q( () => tt = ye(Ue, 1, "item-menu-btn svelte-4g9e7z", null, tt, {
                        "is-mobile": l()
                    })),
                    d(ne, pe)
                }
                ;
                M(De, ne => {
                    a() && ne(ve)
                }
                )
            }
            o(fe);
            var be = u(fe, 2);
            {
                var _e = ne => {
                    oa(ne, {
                        get date() {
                            return t.time
                        },
                        class: "item-time"
                    })
                }
                ;
                M(be, ne => {
                    t.time && ne(_e)
                }
                )
            }
            var Me = u(be, 2)
              , ge = i(Me);
            {
                var Te = ne => {
                    var pe = oo()
                      , Ue = Pe(pe)
                      , tt = i(Ue);
                    o(Ue);
                    var $e = u(Ue, 1, !0);
                    $e.nodeValue = " ",
                    q( () => {
                        se(Ue, "href", e(H)),
                        de(tt, `@${m().displayName ?? ""},`)
                    }
                    ),
                    d(ne, pe)
                }
                  , Ne = ne => {
                    var pe = He()
                      , Ue = Pe(pe);
                    {
                        var tt = $e => {
                            var ht = io()
                              , pt = Pe(ht)
                              , yt = i(pt);
                            o(pt);
                            var at = u(pt, 1, !0);
                            at.nodeValue = " ",
                            q( () => de(yt, `@${m().displayName ?? ""},`)),
                            d($e, ht)
                        }
                        ;
                        M(Ue, $e => {
                            m() && $e(tt)
                        }
                        , !0)
                    }
                    d(ne, pe)
                }
                ;
                M(ge, ne => {
                    m() && e(H) ? ne(Te) : ne(Ne, !1)
                }
                )
            }
            var Ie = u(ge);
            rl(Ie, {
                get content() {
                    return e(X)
                }
            }),
            o(Me);
            var qe = u(Me, 2);
            {
                var Fe = ne => {
                    const pe = V( () => _().filter(at => at.type === "audio"))
                      , Ue = V( () => _().filter(at => at.type !== "audio"));
                    var tt = uo()
                      , $e = Pe(tt);
                    {
                        var ht = at => {
                            var _t = lo();
                            Qe(_t, 21, () => e(pe), bt, (qt, At) => {
                                bl(qt, {
                                    get src() {
                                        return e(At).url
                                    },
                                    get duration() {
                                        return e(At).duration
                                    }
                                })
                            }
                            ),
                            o(_t),
                            d(at, _t)
                        }
                        ;
                        M($e, at => {
                            e(pe).length > 0 && at(ht)
                        }
                        )
                    }
                    var pt = u($e, 2);
                    {
                        var yt = at => {
                            var _t = vo();
                            let qt;
                            Qe(_t, 21, () => e(Ue), bt, (At, Bt, gt) => {
                                var ot = co();
                                ot.__click = () => R(gt);
                                var zt = i(ot);
                                o(ot),
                                q( () => {
                                    se(zt, "src", e(Bt).thumbnailUrl || e(Bt).url),
                                    se(zt, "alt", e(Bt).filename)
                                }
                                ),
                                d(At, ot)
                            }
                            ),
                            o(_t),
                            q( () => qt = ye(_t, 1, "item-attachments svelte-4g9e7z", null, qt, {
                                single: e(Ue).length === 1
                            })),
                            d(at, _t)
                        }
                        ;
                        M(pt, at => {
                            e(Ue).length > 0 && at(yt)
                        }
                        )
                    }
                    d(ne, tt)
                }
                ;
                M(qe, ne => {
                    _() && _().length > 0 && ne(Fe)
                }
                )
            }
            var Xe = u(qe, 2)
              , Je = i(Xe);
            Je.__click = ke;
            var st = u(Je, 2);
            st.__click = te;
            let ct;
            var it = i(st);
            Ra(it, {
                size: 14,
                get filled() {
                    return e(j)
                }
            });
            var dt = u(it, 2);
            {
                var Be = ne => {
                    var pe = fo()
                      , Ue = i(pe, !0);
                    o(pe),
                    q(tt => de(Ue, tt), [ () => Rt(e(F))]),
                    d(ne, pe)
                }
                ;
                M(dt, ne => {
                    e(F) > 0 && ne(Be)
                }
                )
            }
            o(st),
            o(Xe),
            o(Se),
            o(A),
            q( () => {
                Q = ye(A, 1, "item svelte-4g9e7z", null, Q, {
                    "is-reply": e(O),
                    deleting: e(re),
                    highlighted: b()
                }),
                ct = ye(st, 1, "item-action-btn like svelte-4g9e7z", null, ct, {
                    liked: e(j),
                    animated: e(ee)
                })
            }
            ),
            d(w, A)
        }
        ;
        M(g, w => {
            e(ue) ? w(T) : w(y, !1)
        }
        )
    }
    var k = u(g, 2);
    {
        var x = w => {
            {
                let A = V( () => _().map(Q => ({
                    id: Q.id,
                    type: Q.type,
                    url: Q.url,
                    thumbnailUrl: Q.thumbnailUrl,
                    width: Q.width,
                    height: Q.height
                })));
                Mr(w, {
                    get isOpen() {
                        return e(C)
                    },
                    get attachments() {
                        return e(A)
                    },
                    get initialIndex() {
                        return e(I)
                    },
                    onClose: L
                })
            }
        }
        ;
        M(k, w => {
            e(C) && _().length > 0 && w(x)
        }
        )
    }
    d(s, $),
    Ye(),
    v()
}
Ze(["click"]);
var mo = p('<a class="replying-to-name svelte-ome0nc"> </a>')
  , _o = p('<span class="replying-to-name svelte-ome0nc"> </span>')
  , po = p('<div class="replying-to svelte-ome0nc"><span class="replying-to-label svelte-ome0nc">Ответ для</span> <!> <button class="replying-to-clear svelte-ome0nc" aria-label="Отменить"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg></button></div>')
  , wo = Ve('<svg class="spinner svelte-ome0nc" width="14" height="14" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="3" fill="none" stroke-dasharray="31.4" stroke-linecap="round"><animateTransform attributeName="transform" type="rotate" from="0 12 12" to="360 12 12" dur="1s" repeatCount="indefinite"></animateTransform></circle></svg>')
  , bo = p('<div class="comment-voice-preview svelte-ome0nc"><div class="voice-icon svelte-ome0nc"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z"></path><path d="M19 10v2a7 7 0 0 1-14 0v-2"></path></svg></div> <span class="voice-duration svelte-ome0nc"> </span> <!> <button class="voice-remove-btn svelte-ome0nc"><!></button></div>')
  , yo = p('<div class="upload-overlay svelte-ome0nc"><svg class="spinner svelte-ome0nc" width="16" height="16" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="3" fill="none" stroke-dasharray="31.4" stroke-linecap="round"><animateTransform attributeName="transform" type="rotate" from="0 12 12" to="360 12 12" dur="1s" repeatCount="indefinite"></animateTransform></circle></svg></div>')
  , ko = p('<div class="comment-preview-item svelte-ome0nc"><img alt="Превью"/> <!> <button class="comment-remove-media-btn svelte-ome0nc"><!></button></div>')
  , xo = p('<div class="comment-previews svelte-ome0nc"></div>')
  , Co = p('<div class="comment-sending svelte-ome0nc"><div class="comment-sending-icon svelte-ome0nc"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z"></path><path d="M19 10v2a7 7 0 0 1-14 0v-2"></path><line x1="12" x2="12" y1="19" y2="22"></line></svg></div> <span class="comment-sending-text svelte-ome0nc">Отправка...</span> <svg class="spinner svelte-ome0nc" width="16" height="16" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="3" fill="none" stroke-dasharray="31.4" stroke-linecap="round"><animateTransform attributeName="transform" type="rotate" from="0 12 12" to="360 12 12" dur="1s" repeatCount="indefinite"></animateTransform></circle></svg></div>')
  , zo = p('<button class="comment-attach-btn svelte-ome0nc" title="Прикрепить изображение"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l9.19-9.19a4 4 0 0 1 5.66 5.66l-9.2 9.19a2 2 0 0 1-2.83-2.83l8.49-8.48"></path></svg></button> <textarea class="comment-input-field svelte-ome0nc" rows="1"></textarea>', 1)
  , Po = Ve('<svg class="spinner svelte-ome0nc" width="16" height="16" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="3" fill="none" stroke-dasharray="31.4" stroke-linecap="round"><animateTransform attributeName="transform" type="rotate" from="0 12 12" to="360 12 12" dur="1s" repeatCount="indefinite"></animateTransform></circle></svg>')
  , Mo = Ve('<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><line x1="5" y1="12" x2="19" y2="12"></line><polyline points="12 5 19 12 12 19"></polyline></svg>')
  , So = p('<button class="comment-submit svelte-ome0nc" aria-label="Отправить"><!></button>')
  , Io = p('<button class="comment-submit comment-submit--mic svelte-ome0nc" aria-label="Записать голосовое"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z"></path><path d="M19 10v2a7 7 0 0 1-14 0v-2"></path><line x1="12" x2="12" y1="19" y2="22"></line></svg></button>')
  , To = p('<div class="comment-input-wrapper svelte-ome0nc"><!> <!> <form class="comment-input-form svelte-ome0nc"><input type="file" class="comment-file-input svelte-ome0nc" accept="image/*" multiple/> <!> <!></form></div>');
function Cr(s, t) {
    We(t, !0);
    const n = () => Ke(Ot, "$currentUser", a)
      , [a,l] = Ct()
      , f = 1;
    let v = me(t, "replyingTo", 3, null), c = me(t, "isSubmitting", 3, !1), h = V( () => !t.postId && !!t.onSubmit), m = S(""), z = S(!1), P = S(null), _ = S(rt([])), b, C = S(!1), I = S(!1), R = S(!1), L, j = V( () => e(_).some(y => y.isUploading)), E = V( () => e(_).filter(y => y.uploaded).map(y => y.uploaded)), F = V( () => e(_).length < f && !e(C)), ee = V( () => e(_).some(y => y.isAudio)), ae = V( () => e(m).trim().length > 0 || e(E).length > 0), J = V( () => !e(m).trim() && e(E).length === 0 || c() || e(z) || e(j)), re = V( () => {
        if (!v())
            return null;
        const y = v().username || v().authorId;
        return y ? `/${y}` : null
    }
    );
    function ue(y) {
        const k = y.target;
        r(m, k.value, !0),
        k.style.height = "auto",
        k.style.height = `${Math.min(k.scrollHeight, 150)}px`
    }
    async function ie(y) {
        const x = y.target.files;
        if (!x || x.length === 0)
            return;
        const w = f - e(_).length
          , A = Array.from(x).slice(0, w);
        for (const Q of A) {
            const le = crypto.randomUUID()
              , xe = new FileReader;
            xe.onload = he => {
                const Se = he.target?.result
                  , fe = {
                    id: le,
                    preview: Se,
                    file: Q,
                    isUploading: !0
                };
                r(_, [...e(_), fe], !0),
                oe(le, Q)
            }
            ,
            xe.readAsDataURL(Q)
        }
        b && (b.value = "")
    }
    function ce(y) {
        const k = y.clipboardData?.items;
        if (!k)
            return;
        const x = f - e(_).length;
        if (x <= 0)
            return;
        const w = [];
        for (let A = 0; A < k.length && w.length < x; A++) {
            const Q = k[A];
            if (Q.type.startsWith("image/")) {
                const le = Q.getAsFile();
                le && w.push(le)
            }
        }
        if (w.length !== 0) {
            y.preventDefault();
            for (const A of w) {
                const Q = crypto.randomUUID()
                  , le = new FileReader;
                le.onload = xe => {
                    const he = xe.target?.result
                      , Se = {
                        id: Q,
                        preview: he,
                        file: A,
                        isUploading: !0
                    };
                    r(_, [...e(_), Se], !0),
                    oe(Q, A)
                }
                ,
                le.readAsDataURL(A)
            }
        }
    }
    async function oe(y, k) {
        const x = await Dt.uploadFile(k);
        r(_, e(_).map(w => {
            if (w.id === y) {
                if (x.error)
                    return x.errorCode === "CONTENT_MODERATION_FAILED" ? (Mt.show(x.error),
                    null) : {
                        ...w,
                        isUploading: !1,
                        error: x.error
                    };
                if (x.data)
                    return {
                        ...w,
                        isUploading: !1,
                        uploaded: x.data
                    }
            }
            return w
        }
        ).filter(Boolean), !0)
    }
    async function O(y) {
        const k = e(_).find(x => x.id === y);
        k?.uploaded && await Dt.deleteFile(k.uploaded.id),
        r(_, e(_).filter(x => x.id !== y), !0)
    }
    function D() {
        r(I, !0),
        setTimeout( () => {
            L?.startRecording()
        }
        , 0)
    }
    function H() {
        r(C, !0)
    }
    async function X(y, k) {
        r(C, !1),
        r(I, !1),
        r(R, !0);
        const x = new File([y],`voice_${Date.now()}.webm`,{
            type: y.type
        });
        try {
            const w = await Dt.uploadFile(x);
            if (w.error || !w.data) {
                w.errorCode === "CONTENT_MODERATION_FAILED" && Mt.show(w.error || "Голосовое сообщение содержит запрещённый контент"),
                r(R, !1);
                return
            }
            if (e(h))
                t.onSubmit?.("", v(), [w.data.id]);
            else if (t.postId) {
                const A = await Tt.createComment(t.postId, {
                    attachmentIds: [w.data.id]
                });
                if (A.error) {
                    Mt.show(A.error),
                    r(R, !1);
                    return
                }
                if (A.data) {
                    const Q = {
                        id: A.data.id,
                        content: A.data.content || "",
                        author: A.data.author.displayName,
                        authorId: A.data.author.id,
                        username: A.data.author.username || "",
                        avatar: A.data.author.avatar || "",
                        verified: A.data.author.verified,
                        pin: A.data.author.pin || null,
                        time: A.data.createdAt || new Date().toISOString(),
                        likes: 0,
                        replies: [],
                        repliesCount: 0,
                        isLiked: !1,
                        attachments: A.data.attachments || []
                    };
                    t.onCommentAdded?.(Q)
                }
            }
        } catch {} finally {
            r(R, !1)
        }
    }
    function te() {
        r(C, !1),
        r(I, !1)
    }
    function ke(y) {
        const k = Math.floor(y / 60)
          , x = Math.floor(y % 60);
        return `${k}:${x.toString().padStart(2, "0")}`
    }
    async function Y(y) {
        if (y?.stopPropagation(),
        e(J) || !n())
            return;
        const k = e(m).trim()
          , x = e(E).length > 0 ? e(E).map(w => w.id) : void 0;
        if (e(h))
            t.onSubmit?.(k, v(), x),
            r(m, ""),
            r(_, [], !0),
            e(P) && (e(P).style.height = "auto");
        else if (t.postId) {
            r(z, !0),
            r(m, "");
            try {
                const w = await Tt.createComment(t.postId, {
                    content: k,
                    attachmentIds: x
                });
                if (w.error) {
                    Mt.show(w.error),
                    r(m, k, !0),
                    r(z, !1);
                    return
                }
                if (w.data) {
                    const A = {
                        id: w.data.id,
                        content: w.data.content || "",
                        author: w.data.author.displayName,
                        authorId: w.data.author.id,
                        username: w.data.author.username || "",
                        avatar: w.data.author.avatar || "",
                        verified: w.data.author.verified,
                        pin: w.data.author.pin || null,
                        time: w.data.createdAt || new Date().toISOString(),
                        likes: 0,
                        replies: [],
                        repliesCount: 0,
                        isLiked: !1,
                        attachments: w.data.attachments || []
                    };
                    r(_, [], !0),
                    t.onCommentAdded?.(A)
                }
            } catch {
                r(m, k, !0)
            } finally {
                r(z, !1)
            }
        }
    }
    function we() {
        setTimeout( () => {
            e(P)?.focus()
        }
        , 0)
    }
    function K() {
        r(m, ""),
        r(_, [], !0),
        e(P) && (e(P).style.height = "auto")
    }
    var Z = {
        focus: we,
        clear: K
    }
      , N = He()
      , $ = Pe(N);
    {
        var g = y => {
            var k = To()
              , x = i(k);
            {
                var w = U => {
                    var W = po()
                      , B = u(i(W), 2);
                    {
                        var G = ve => {
                            var be = mo()
                              , _e = i(be, !0);
                            o(be),
                            q( () => {
                                se(be, "href", e(re)),
                                de(_e, v().author)
                            }
                            ),
                            d(ve, be)
                        }
                          , Ce = ve => {
                            var be = _o()
                              , _e = i(be, !0);
                            o(be),
                            q( () => de(_e, v().author)),
                            d(ve, be)
                        }
                        ;
                        M(B, ve => {
                            e(re) ? ve(G) : ve(Ce, !1)
                        }
                        )
                    }
                    var De = u(B, 2);
                    De.__click = () => t.onClearReplyingTo?.(),
                    o(W),
                    d(U, W)
                }
                ;
                M(x, U => {
                    v() && U(w)
                }
                )
            }
            var A = u(x, 2);
            {
                var Q = U => {
                    var W = xo();
                    Qe(W, 21, () => e(_), B => B.id, (B, G) => {
                        var Ce = He()
                          , De = Pe(Ce);
                        {
                            var ve = _e => {
                                var Me = bo()
                                  , ge = u(i(Me), 2)
                                  , Te = i(ge, !0);
                                o(ge);
                                var Ne = u(ge, 2);
                                {
                                    var Ie = Xe => {
                                        var Je = wo();
                                        d(Xe, Je)
                                    }
                                    ;
                                    M(Ne, Xe => {
                                        e(G).isUploading && Xe(Ie)
                                    }
                                    )
                                }
                                var qe = u(Ne, 2);
                                qe.__click = () => O(e(G).id);
                                var Fe = i(qe);
                                Lt(Fe, {
                                    size: 10
                                }),
                                o(qe),
                                o(Me),
                                q(Xe => {
                                    de(Te, Xe),
                                    qe.disabled = e(G).isUploading
                                }
                                , [ () => ke(e(G).duration || 0)]),
                                d(_e, Me)
                            }
                              , be = _e => {
                                var Me = ko()
                                  , ge = i(Me);
                                let Te;
                                var Ne = u(ge, 2);
                                {
                                    var Ie = Xe => {
                                        var Je = yo();
                                        d(Xe, Je)
                                    }
                                    ;
                                    M(Ne, Xe => {
                                        e(G).isUploading && Xe(Ie)
                                    }
                                    )
                                }
                                var qe = u(Ne, 2);
                                qe.__click = () => O(e(G).id);
                                var Fe = i(qe);
                                Lt(Fe, {
                                    size: 10
                                }),
                                o(qe),
                                o(Me),
                                q( () => {
                                    se(ge, "src", e(G).preview),
                                    Te = ye(ge, 1, "svelte-ome0nc", null, Te, {
                                        uploading: e(G).isUploading
                                    }),
                                    qe.disabled = e(G).isUploading
                                }
                                ),
                                d(_e, Me)
                            }
                            ;
                            M(De, _e => {
                                e(G).isAudio ? _e(ve) : _e(be, !1)
                            }
                            )
                        }
                        d(B, Ce)
                    }
                    ),
                    o(W),
                    d(U, W)
                }
                ;
                M(A, U => {
                    e(_).length > 0 && U(Q)
                }
                )
            }
            var le = u(A, 2)
              , xe = i(le);
            xe.__change = ie,
            et(xe, U => b = U, () => b);
            var he = u(xe, 2);
            {
                var Se = U => {
                    var W = Co();
                    d(U, W)
                }
                  , fe = U => {
                    var W = He()
                      , B = Pe(W);
                    {
                        var G = Ce => {
                            var De = zo()
                              , ve = Pe(De);
                            ve.__click = () => b?.click();
                            var be = u(ve, 2);
                            Vt(be),
                            be.__input = ue,
                            et(be, _e => r(P, _e), () => e(P)),
                            q( () => {
                                ve.disabled = !e(F) || c() || e(z) || e(ee),
                                $t(be, e(m)),
                                se(be, "placeholder", e(h) ? "Написать ответ..." : "Написать комментарий..."),
                                be.disabled = c() || e(z)
                            }
                            ),
                            mt("paste", be, ce),
                            d(Ce, De)
                        }
                        ;
                        M(B, Ce => {
                            !e(C) && !e(I) && Ce(G)
                        }
                        , !0)
                    }
                    d(U, W)
                }
                ;
                M(he, U => {
                    e(R) ? U(Se) : U(fe, !1)
                }
                )
            }
            var ze = u(he, 2);
            {
                var je = U => {
                    et(fl(U, {
                        onRecordingStart: H,
                        onRecordingComplete: X,
                        onCancel: te
                    }), W => L = W, () => L)
                }
                  , Oe = U => {
                    var W = He()
                      , B = Pe(W);
                    {
                        var G = Ce => {
                            var De = He()
                              , ve = Pe(De);
                            {
                                var be = Me => {
                                    var ge = So();
                                    ge.__click = Y;
                                    var Te = i(ge);
                                    {
                                        var Ne = qe => {
                                            var Fe = Po();
                                            d(qe, Fe)
                                        }
                                          , Ie = qe => {
                                            var Fe = Mo();
                                            d(qe, Fe)
                                        }
                                        ;
                                        M(Te, qe => {
                                            c() || e(z) ? qe(Ne) : qe(Ie, !1)
                                        }
                                        )
                                    }
                                    o(ge),
                                    q( () => ge.disabled = e(J)),
                                    d(Me, ge)
                                }
                                  , _e = Me => {
                                    var ge = Io();
                                    ge.__click = D,
                                    q( () => ge.disabled = c() || e(z)),
                                    d(Me, ge)
                                }
                                ;
                                M(ve, Me => {
                                    e(ae) ? Me(be) : Me(_e, !1)
                                }
                                )
                            }
                            d(Ce, De)
                        }
                        ;
                        M(B, Ce => {
                            e(R) || Ce(G)
                        }
                        , !0)
                    }
                    d(U, W)
                }
                ;
                M(ze, U => {
                    e(C) || e(I) ? U(je) : U(Oe, !1)
                }
                )
            }
            o(le),
            o(k),
            mt("submit", le, U => {
                U.preventDefault(),
                U.stopPropagation()
            }
            ),
            d(y, k)
        }
        ;
        M($, y => {
            n() && y(g)
        }
        )
    }
    d(s, N);
    var T = Ye(Z);
    return l(),
    T
}
Ze(["click", "change", "input"]);
var Ro = p('<hr class="reply-divider svelte-1m8hxxk"/>')
  , Do = p('<hr class="reply-divider svelte-1m8hxxk"/>')
  , jo = p("<div><!></div> <!>", 1)
  , qo = p('<button class="show-more-replies svelte-1m8hxxk"> </button>')
  , Ao = p('<div class="replies-container svelte-1m8hxxk"><!> <!> <!> <!></div>')
  , Lo = p('<div class="comment svelte-1m8hxxk"><!> <!></div>');
function Uo(s, t) {
    We(t, !0);
    let n = me(t, "canDelete", 3, !1)
      , a = me(t, "isHighlighted", 3, !1)
      , l = S(!1)
      , f = S(!1)
      , v = S(rt(t.comment.replies ?? []))
      , c = S(rt(t.comment.repliesCount ?? t.comment.replies?.length ?? 0))
      , h = S(!1)
      , m = S(!1)
      , z = S(rt(new Set))
      , P = S(null)
      , _ = S(null)
      , b = S(null)
      , C = S(null)
      , I = V( () => {
        if (e(h))
            return e(v);
        const oe = e(v).slice(0, 1)
          , O = e(v).filter( (D, H) => H >= 1 && e(z).has(D.id));
        return [...oe, ...O]
    }
    );
    async function R(oe) {
        r(b, oe || null, !0),
        r(l, !0),
        await Pa(),
        e(P)?.focus()
    }
    function L() {
        r(b, null)
    }
    async function j() {
        if (jt() && !e(m)) {
            if (e(v).length >= e(c)) {
                r(h, !0);
                return
            }
            r(m, !0);
            try {
                const oe = await Tt.getReplies(t.comment.id, 1, 50, "oldest");
                if (!oe.error && oe.data) {
                    const O = oe.data.replies || oe.data.comments || [];
                    r(v, O.map(D => ({
                        id: D.id,
                        content: D.content,
                        author: D.author.displayName,
                        authorId: D.author.id,
                        username: D.author.username || null,
                        avatar: D.author.avatar || null,
                        verified: D.author.verified,
                        pin: D.author.pin || null,
                        time: D.createdAt,
                        likes: D.likesCount,
                        isLiked: D.isLiked,
                        replyTo: D.replyTo || null,
                        attachments: D.attachments || []
                    })), !0),
                    r(h, !0)
                }
            } catch {} finally {
                r(m, !1)
            }
        }
    }
    function E() {
        R({
            author: t.comment.author,
            authorId: t.comment.authorId,
            username: t.comment.username
        })
    }
    function F(oe) {
        R({
            author: oe.author,
            authorId: oe.authorId,
            username: oe.username
        })
    }
    function ee() {
        r(c, Math.max(0, e(c) - 1), !0)
    }
    function ae() {
        Jt(c)
    }
    async function J(oe, O, D) {
        if (!e(f)) {
            r(f, !0);
            try {
                const H = await Tt.createReply(t.comment.id, {
                    content: oe,
                    replyToUserId: O?.authorId,
                    attachmentIds: D
                });
                if (H.error) {
                    Mt.show(H.error),
                    r(f, !1);
                    return
                }
                if (H.data) {
                    const X = {
                        id: H.data.id,
                        content: H.data.content || "",
                        author: H.data.author.displayName,
                        authorId: H.data.author.id,
                        username: H.data.author.username || null,
                        avatar: H.data.author.avatar || "",
                        verified: H.data.author.verified,
                        pin: H.data.author.pin || null,
                        time: H.data.createdAt || new Date().toISOString(),
                        likes: 0,
                        isLiked: !1,
                        replyTo: O ? {
                            id: O.authorId || "",
                            username: O.username,
                            displayName: O.author
                        } : null,
                        attachments: H.data.attachments || []
                    };
                    r(v, [...e(v), X], !0),
                    Jt(c),
                    r(z, new Set([...e(z), X.id]), !0),
                    r(l, !1),
                    r(b, null),
                    e(P)?.clear(),
                    r(_, X.id, !0),
                    await Pa();
                    const te = e(C)?.querySelector(`[data-reply-id="${X.id}"]`);
                    te && te.scrollIntoView({
                        behavior: "smooth",
                        block: "center"
                    }),
                    setTimeout( () => {
                        r(_, null)
                    }
                    , 2500)
                }
            } catch {} finally {
                r(f, !1)
            }
        }
    }
    var re = Lo()
      , ue = i(re);
    {
        let oe = V( () => ({
            id: t.comment.authorId || "",
            displayName: t.comment.author,
            username: t.comment.username,
            avatar: t.comment.avatar,
            verified: t.comment.verified,
            pin: t.comment.pin || null
        }));
        sr(ue, {
            get id() {
                return t.comment.id
            },
            get content() {
                return t.comment.content
            },
            get author() {
                return e(oe)
            },
            get time() {
                return t.comment.time
            },
            get likes() {
                return t.comment.likes
            },
            get isLiked() {
                return t.comment.isLiked
            },
            variant: "comment",
            get canDelete() {
                return n()
            },
            get attachments() {
                return t.comment.attachments
            },
            get isHighlighted() {
                return a()
            },
            onReplyClick: E,
            get onDelete() {
                return t.onDelete
            },
            onReport: () => t.onReport?.(t.comment.id)
        })
    }
    var ie = u(ue, 2);
    {
        var ce = oe => {
            var O = Ao()
              , D = i(O);
            {
                var H = K => {
                    var Z = Ro();
                    d(K, Z)
                }
                ;
                M(D, K => {
                    e(v).length > 0 && K(H)
                }
                )
            }
            var X = u(D, 2);
            Qe(X, 19, () => e(I), K => K.id, (K, Z, N) => {
                var $ = jo()
                  , g = Pe($)
                  , T = i(g);
                {
                    let x = V( () => ({
                        id: e(Z).authorId || "",
                        displayName: e(Z).author,
                        username: e(Z).username,
                        avatar: e(Z).avatar,
                        verified: e(Z).verified,
                        pin: e(Z).pin || null
                    }))
                      , w = V( () => e(_) === e(Z).id);
                    sr(T, {
                        get id() {
                            return e(Z).id
                        },
                        get content() {
                            return e(Z).content
                        },
                        get author() {
                            return e(x)
                        },
                        get time() {
                            return e(Z).time
                        },
                        get likes() {
                            return e(Z).likes
                        },
                        get isLiked() {
                            return e(Z).isLiked
                        },
                        get replyTo() {
                            return e(Z).replyTo
                        },
                        variant: "reply",
                        get canDelete() {
                            return n()
                        },
                        get attachments() {
                            return e(Z).attachments
                        },
                        get isHighlighted() {
                            return e(w)
                        },
                        onReplyClick: () => F(e(Z)),
                        onDelete: ee,
                        onRestore: ae,
                        onReport: () => t.onReport?.(e(Z).id)
                    })
                }
                o(g);
                var y = u(g, 2);
                {
                    var k = x => {
                        var w = Do();
                        d(x, w)
                    }
                    ;
                    M(y, x => {
                        e(N) < e(I).length - 1 && x(k)
                    }
                    )
                }
                q( () => se(g, "data-reply-id", e(Z).id)),
                d(K, $)
            }
            );
            var te = u(X, 2);
            {
                var ke = K => {
                    const Z = V( () => e(c) - e(I).length);
                    var N = qo();
                    N.__click = j;
                    var $ = i(N, !0);
                    o(N),
                    q( () => {
                        N.disabled = e(m),
                        de($, e(m) ? "Загрузка..." : `Показать ещё ${e(Z)} ${e(Z) === 1 ? "ответ" : e(Z) < 5 ? "ответа" : "ответов"}`)
                    }
                    ),
                    d(K, N)
                }
                ;
                M(te, K => {
                    !e(h) && e(c) > e(I).length && K(ke)
                }
                )
            }
            var Y = u(te, 2);
            {
                var we = K => {
                    et(Cr(K, {
                        get replyingTo() {
                            return e(b)
                        },
                        get isSubmitting() {
                            return e(f)
                        },
                        onSubmit: J,
                        onClearReplyingTo: L
                    }), Z => r(P, Z, !0), () => e(P))
                }
                ;
                M(Y, K => {
                    e(l) && K(we)
                }
                )
            }
            o(O),
            et(O, K => r(C, K), () => e(C)),
            d(oe, O)
        }
        ;
        M(ie, oe => {
            (e(v).length > 0 || e(l)) && oe(ce)
        }
        )
    }
    o(re),
    d(s, re),
    Ye()
}
Ze(["click"]);
var Oo = p('<span class="report-modal__spinner svelte-1ozcdhh"></span> Отправка...', 1)
  , Bo = p('<button class="report-modal__cancel svelte-1ozcdhh">Отмена</button> <button class="report-modal__submit svelte-1ozcdhh"><!></button>', 1)
  , Eo = p('<div class="report-modal__success svelte-1ozcdhh"><svg class="report-modal__success-icon svelte-1ozcdhh" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"></circle><path d="M9 12l2 2 4-4"></path></svg> <p class="report-modal__success-text svelte-1ozcdhh">Жалоба отправлена</p> <p class="report-modal__success-subtext svelte-1ozcdhh">Спасибо, мы рассмотрим вашу жалобу</p></div>')
  , Ho = p('<span class="report-modal__reason-dot svelte-1ozcdhh"></span>')
  , No = p('<button><span class="report-modal__reason-radio svelte-1ozcdhh"><!></span> <span> </span></button>')
  , Fo = p('<div class="report-modal__content svelte-1ozcdhh"><p class="report-modal__subtitle svelte-1ozcdhh">Выберите причину жалобы</p> <div class="report-modal__reasons svelte-1ozcdhh"></div> <div class="report-modal__description svelte-1ozcdhh"><label for="report-description" class="report-modal__label svelte-1ozcdhh">Дополнительная информация</label> <textarea id="report-description" placeholder="Опишите подробнее, что не так с этим контентом..." class="report-modal__textarea svelte-1ozcdhh" rows="3"></textarea></div></div>');
function hc(s, t) {
    We(t, !0);
    const n = P => {
        var _ = Bo()
          , b = Pe(_);
        b.__click = h;
        var C = u(b, 2);
        C.__click = m;
        var I = i(C);
        {
            var R = j => {
                var E = Oo();
                Ge(),
                d(j, E)
            }
              , L = j => {
                var E = Wt("Отправить");
                d(j, E)
            }
            ;
            M(I, j => {
                e(f) ? j(R) : j(L, !1)
            }
            )
        }
        o(C),
        q( () => {
            b.disabled = e(f),
            C.disabled = !e(a) || e(f)
        }
        ),
        d(P, _)
    }
    ;
    let a = S(null)
      , l = S("")
      , f = S(!1)
      , v = S(!1);
    const c = [{
        id: "spam",
        label: "Спам"
    }, {
        id: "violence",
        label: "Насилие или опасные действия"
    }, {
        id: "hate",
        label: "Ненависть или травля"
    }, {
        id: "adult",
        label: "Контент для взрослых"
    }, {
        id: "fraud",
        label: "Мошенничество или обман"
    }, {
        id: "other",
        label: "Другое"
    }];
    function h() {
        r(a, null),
        r(l, ""),
        r(v, !1),
        t.onClose()
    }
    async function m(P) {
        if (P.preventDefault(),
        !(!e(a) || e(f))) {
            r(f, !0);
            try {
                await t.onSubmit(e(a), e(l)),
                r(v, !0),
                setTimeout( () => {
                    h()
                }
                , 1500)
            } catch {
                r(f, !1)
            }
        }
    }
    function z(P) {
        const _ = P.target;
        r(l, _.value, !0),
        _.style.height = "auto",
        _.style.height = `${Math.min(_.scrollHeight, 150)}px`
    }
    {
        let P = V( () => e(v) ? void 0 : n);
        wa(s, {
            get isOpen() {
                return t.isOpen
            },
            onClose: h,
            title: "Пожаловаться",
            maxWidth: "440px",
            priority: !0,
            get footer() {
                return e(P)
            },
            children: (_, b) => {
                var C = He()
                  , I = Pe(C);
                {
                    var R = j => {
                        var E = Eo();
                        d(j, E)
                    }
                      , L = j => {
                        var E = Fo()
                          , F = u(i(E), 2);
                        Qe(F, 21, () => c, bt, (J, re) => {
                            var ue = No();
                            ue.__click = () => r(a, e(re).id, !0);
                            let ie;
                            var ce = i(ue)
                              , oe = i(ce);
                            {
                                var O = X => {
                                    var te = Ho();
                                    d(X, te)
                                }
                                ;
                                M(oe, X => {
                                    e(a) === e(re).id && X(O)
                                }
                                )
                            }
                            o(ce);
                            var D = u(ce, 2)
                              , H = i(D, !0);
                            o(D),
                            o(ue),
                            q( () => {
                                ie = ye(ue, 1, "report-modal__reason svelte-1ozcdhh", null, ie, {
                                    selected: e(a) === e(re).id
                                }),
                                ue.disabled = e(f),
                                de(H, e(re).label)
                            }
                            ),
                            d(J, ue)
                        }
                        ),
                        o(F);
                        var ee = u(F, 2)
                          , ae = u(i(ee), 2);
                        Vt(ae),
                        ae.__input = z,
                        o(ee),
                        o(E),
                        q( () => {
                            $t(ae, e(l)),
                            ae.disabled = e(f)
                        }
                        ),
                        d(j, E)
                    }
                    ;
                    M(I, j => {
                        e(v) ? j(R) : j(L, !1)
                    }
                    )
                }
                d(_, C)
            }
            ,
            $$slots: {
                default: !0
            }
        })
    }
    Ye()
}
Ze(["click", "input"]);
var Vo = p('<button class="edit-modal__cancel svelte-jsnbd9">Отмена</button> <button class="edit-modal__submit svelte-jsnbd9"> </button>', 1)
  , Wo = p('<div class="edit-modal__error svelte-jsnbd9"> </div>')
  , Yo = p('<div class="edit-modal__content svelte-jsnbd9"><!> <textarea placeholder="Что нового?" class="edit-modal__textarea svelte-jsnbd9" rows="4"></textarea></div>');
function Xo(s, t) {
    We(t, !0);
    let n = S(rt(t.initialContent))
      , a = S(!1)
      , l = S("");
    ft( () => {
        t.isOpen && (r(n, t.initialContent, !0),
        r(l, ""))
    }
    );
    function f() {
        e(a) || (r(n, ""),
        r(l, ""),
        t.onClose())
    }
    async function v(m) {
        if (m.preventDefault(),
        !e(n).trim() || e(a))
            return;
        r(a, !0),
        r(l, "");
        const z = await ut.updatePost(t.postId, e(n).trim());
        if (z.error) {
            r(l, z.error, !0),
            r(a, !1);
            return
        }
        t.onSave(e(n).trim()),
        r(a, !1),
        f()
    }
    function c(m) {
        const z = m.target;
        r(n, z.value, !0),
        z.style.height = "auto",
        z.style.height = `${Math.min(z.scrollHeight, 300)}px`
    }
    let h = V( () => e(n).trim().length > 0 && e(n).trim() !== t.initialContent && !e(a));
    wa(s, {
        get isOpen() {
            return t.isOpen
        },
        onClose: f,
        title: "Редактировать пост",
        maxWidth: "540px",
        get closeDisabled() {
            return e(a)
        },
        footer: z => {
            var P = Vo()
              , _ = Pe(P);
            _.__click = f;
            var b = u(_, 2);
            b.__click = v;
            var C = i(b, !0);
            o(b),
            q( () => {
                _.disabled = e(a),
                b.disabled = !e(h),
                de(C, e(a) ? "Сохранение..." : "Сохранить")
            }
            ),
            d(z, P)
        }
        ,
        children: (z, P) => {
            var _ = Yo()
              , b = i(_);
            {
                var C = R => {
                    var L = Wo()
                      , j = i(L, !0);
                    o(L),
                    q( () => de(j, e(l))),
                    d(R, L)
                }
                ;
                M(b, R => {
                    e(l) && R(C)
                }
                )
            }
            var I = u(b, 2);
            Vt(I),
            I.__input = c,
            o(_),
            q( () => {
                $t(I, e(n)),
                I.disabled = e(a)
            }
            ),
            d(z, _)
        }
        ,
        $$slots: {
            footer: !0,
            default: !0
        }
    }),
    Ye()
}
Ze(["click", "input"]);
var Zo = p('<div class="repost-modal__header svelte-s0g8z9"><h2 class="repost-modal__title svelte-s0g8z9"><!> Репост</h2></div>')
  , Ko = p('<button class="repost-modal__cancel svelte-s0g8z9">Отмена</button> <button class="repost-modal__submit svelte-s0g8z9"> </button>', 1)
  , Go = p('<div class="repost-modal__error svelte-s0g8z9"> </div>')
  , Qo = p('<div class="repost-modal__content svelte-s0g8z9"><!> <textarea placeholder="Добавьте комментарий (необязательно)" class="repost-modal__textarea svelte-s0g8z9" rows="2"></textarea> <div class="repost-modal__original svelte-s0g8z9"><div class="repost-modal__original-header svelte-s0g8z9"><!> <div class="repost-modal__original-info svelte-s0g8z9"><span class="repost-modal__original-name svelte-s0g8z9"> <!> <!></span> <span class="repost-modal__original-meta svelte-s0g8z9"><!><!></span></div></div> <p class="repost-modal__original-content svelte-s0g8z9"> </p></div></div>');
function zr(s, t) {
    We(t, !0);
    let n = S("")
      , a = S(!1)
      , l = S("");
    ft( () => {
        t.isOpen && (r(n, ""),
        r(l, ""))
    }
    );
    function f() {
        e(a) || (r(n, ""),
        r(l, ""),
        t.onClose())
    }
    async function v(h) {
        if (h.preventDefault(),
        e(a))
            return;
        r(a, !0),
        r(l, "");
        const m = await ut.repostPost(t.originalPost.id, e(n).trim());
        if (m.error) {
            r(l, m.error, !0),
            r(a, !1);
            return
        }
        m.data && t.onRepost(m.data),
        r(a, !1),
        f()
    }
    function c(h) {
        const m = h.target;
        r(n, m.value, !0),
        m.style.height = "auto",
        m.style.height = `${Math.min(m.scrollHeight, 200)}px`
    }
    wa(s, {
        get isOpen() {
            return t.isOpen
        },
        onClose: f,
        maxWidth: "540px",
        get closeDisabled() {
            return e(a)
        },
        header: z => {
            var P = Zo()
              , _ = i(P)
              , b = i(_);
            _a(b, {
                size: 20
            }),
            Ge(),
            o(_),
            o(P),
            d(z, P)
        }
        ,
        footer: z => {
            var P = Ko()
              , _ = Pe(P);
            _.__click = f;
            var b = u(_, 2);
            b.__click = v;
            var C = i(b, !0);
            o(b),
            q( () => {
                _.disabled = e(a),
                b.disabled = e(a),
                de(C, e(a) ? "Публикация..." : "Репостнуть")
            }
            ),
            d(z, P)
        }
        ,
        children: (z, P) => {
            var _ = Qo()
              , b = i(_);
            {
                var C = X => {
                    var te = Go()
                      , ke = i(te, !0);
                    o(te),
                    q( () => de(ke, e(l))),
                    d(X, te)
                }
                ;
                M(b, X => {
                    e(l) && X(C)
                }
                )
            }
            var I = u(b, 2);
            Vt(I),
            I.__input = c;
            var R = u(I, 2)
              , L = i(R)
              , j = i(L);
            kt(j, {
                get avatar() {
                    return t.originalPost.author.avatar
                },
                get name() {
                    return t.originalPost.author.displayName
                },
                size: 32
            });
            var E = u(j, 2)
              , F = i(E)
              , ee = i(F)
              , ae = u(ee);
            {
                var J = X => {
                    La(X, {})
                }
                ;
                M(ae, X => {
                    t.originalPost.author.verified && X(J)
                }
                )
            }
            var re = u(ae, 2);
            {
                var ue = X => {
                    na(X, {
                        get pin() {
                            return t.originalPost.author.pin
                        }
                    })
                }
                ;
                M(re, X => {
                    t.originalPost.author.pin && X(ue)
                }
                )
            }
            o(F);
            var ie = u(F, 2)
              , ce = i(ie);
            {
                var oe = X => {
                    var te = Wt();
                    q( () => de(te, `@${t.originalPost.author.username ?? ""} ·`)),
                    d(X, te)
                }
                ;
                M(ce, X => {
                    t.originalPost.author.username && X(oe)
                }
                )
            }
            var O = u(ce);
            oa(O, {
                get date() {
                    return t.originalPost.createdAt
                }
            }),
            o(ie),
            o(E),
            o(L);
            var D = u(L, 2)
              , H = i(D, !0);
            o(D),
            o(R),
            o(_),
            q( () => {
                $t(I, e(n)),
                I.disabled = e(a),
                de(ee, `${t.originalPost.author.displayName ?? ""} `),
                de(H, t.originalPost.content)
            }
            ),
            d(z, _)
        }
        ,
        $$slots: {
            header: !0,
            footer: !0,
            default: !0
        }
    }),
    Ye()
}
Ze(["click", "input"]);
var Jo = p('<button class="settings-modal__back svelte-1jqzo7p" aria-label="Назад"><!></button>')
  , $o = p('<div class="settings-modal__header svelte-1jqzo7p"><!> <h2 class="settings-modal__title svelte-1jqzo7p"> </h2> <button class="settings-modal__close svelte-1jqzo7p" aria-label="Закрыть"><!></button></div>')
  , ei = p('<div class="settings-modal__success svelte-1jqzo7p"> </div>')
  , ti = p('<div class="settings-modal__error svelte-1jqzo7p"> </div>')
  , ai = p('<div class="settings-modal__section svelte-1jqzo7p"><h3 class="settings-modal__section-title svelte-1jqzo7p">Аккаунт</h3> <div class="settings-modal__options svelte-1jqzo7p"><button class="settings-modal__option svelte-1jqzo7p"><div class="settings-modal__option-content svelte-1jqzo7p"><div class="settings-modal__option-icon svelte-1jqzo7p"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path><circle cx="12" cy="7" r="4"></circle></svg></div> <div class="settings-modal__option-text svelte-1jqzo7p"><div class="settings-modal__option-name svelte-1jqzo7p">Личная информация</div> <div class="settings-modal__option-desc svelte-1jqzo7p">Имя, юзернейм, био</div></div></div> <svg class="settings-modal__option-arrow svelte-1jqzo7p" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="9 18 15 12 9 6"></polyline></svg></button> <button class="settings-modal__option svelte-1jqzo7p"><div class="settings-modal__option-content svelte-1jqzo7p"><div class="settings-modal__option-icon svelte-1jqzo7p"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect><path d="M7 11V7a5 5 0 0 1 10 0v4"></path></svg></div> <span class="settings-modal__option-name svelte-1jqzo7p">Пароль и безопасность</span></div> <svg class="settings-modal__option-arrow svelte-1jqzo7p" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="9 18 15 12 9 6"></polyline></svg></button> <button class="settings-modal__option svelte-1jqzo7p"><div class="settings-modal__option-content svelte-1jqzo7p"><div class="settings-modal__option-icon svelte-1jqzo7p"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path></svg></div> <div class="settings-modal__option-text svelte-1jqzo7p"><div class="settings-modal__option-name svelte-1jqzo7p">Приватность</div> <div class="settings-modal__option-desc svelte-1jqzo7p">Записи на стене</div></div></div> <svg class="settings-modal__option-arrow svelte-1jqzo7p" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="9 18 15 12 9 6"></polyline></svg></button> <button class="settings-modal__option svelte-1jqzo7p"><div class="settings-modal__option-content svelte-1jqzo7p"><div class="settings-modal__option-icon svelte-1jqzo7p"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 2L15.09 8.26L22 9.27L17 14.14L18.18 21.02L12 17.77L5.82 21.02L7 14.14L2 9.27L8.91 8.26L12 2Z"></path></svg></div> <div class="settings-modal__option-text svelte-1jqzo7p"><div class="settings-modal__option-name svelte-1jqzo7p">Пины</div> <div class="settings-modal__option-desc svelte-1jqzo7p">Значки возле ника</div></div></div> <svg class="settings-modal__option-arrow svelte-1jqzo7p" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="9 18 15 12 9 6"></polyline></svg></button> <div class="settings-modal__option settings-modal__option--toggle svelte-1jqzo7p"><div class="settings-modal__option-content svelte-1jqzo7p"><div class="settings-modal__option-icon svelte-1jqzo7p"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg></div> <div class="settings-modal__option-text svelte-1jqzo7p"><div class="settings-modal__option-name svelte-1jqzo7p">Тёмная тема</div></div></div> <button aria-label="Тёмная тема"><span class="settings-modal__toggle-thumb svelte-1jqzo7p"></span></button></div> <div class="settings-modal__option settings-modal__option--toggle svelte-1jqzo7p"><div class="settings-modal__option-content svelte-1jqzo7p"><div class="settings-modal__option-icon svelte-1jqzo7p"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="5" r="2"></circle><circle cx="6" cy="12" r="2"></circle><circle cx="18" cy="12" r="2"></circle><circle cx="12" cy="19" r="2"></circle><circle cx="8" cy="8" r="1"></circle><circle cx="16" cy="8" r="1"></circle></svg></div> <div class="settings-modal__option-text svelte-1jqzo7p"><div class="settings-modal__option-name svelte-1jqzo7p">Снег</div></div></div> <button aria-label="Снег"><span class="settings-modal__toggle-thumb svelte-1jqzo7p"></span></button></div> <button class="settings-modal__option settings-modal__option--danger svelte-1jqzo7p"><div class="settings-modal__option-content svelte-1jqzo7p"><div class="settings-modal__option-icon svelte-1jqzo7p"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path><polyline points="16 17 21 12 16 7"></polyline><line x1="21" y1="12" x2="9" y2="12"></line></svg></div> <div class="settings-modal__option-text svelte-1jqzo7p"><div class="settings-modal__option-name svelte-1jqzo7p">Выйти</div></div></div></button></div></div>')
  , ri = p('<span class="settings-modal__avatar-emoji svelte-1jqzo7p"> </span>')
  , si = p('<div class="settings-modal__form svelte-1jqzo7p"><div class="settings-modal__field svelte-1jqzo7p"><span class="settings-modal__label svelte-1jqzo7p">Аватар клана</span> <div class="settings-modal__avatar-section svelte-1jqzo7p"><div class="settings-modal__avatar-preview settings-modal__avatar-preview--locked svelte-1jqzo7p"><!></div> <div class="settings-modal__avatar-info svelte-1jqzo7p"><span class="settings-modal__avatar-locked-text svelte-1jqzo7p">Нельзя изменить</span> <span class="settings-modal__hint svelte-1jqzo7p">Аватар клана выбирается при регистрации и не может быть изменён</span></div></div></div> <div class="settings-modal__field svelte-1jqzo7p"><label for="display-name" class="settings-modal__label svelte-1jqzo7p">Имя *</label> <input id="display-name" type="text" class="settings-modal__input svelte-1jqzo7p" placeholder="Иван Иванов" maxlength="50"/> <span class="settings-modal__hint svelte-1jqzo7p">Как вас будут видеть другие (до 50 символов)</span></div> <div class="settings-modal__field svelte-1jqzo7p"><label for="username" class="settings-modal__label svelte-1jqzo7p">Юзернейм</label> <div class="settings-modal__input-wrapper svelte-1jqzo7p"><span class="settings-modal__input-prefix svelte-1jqzo7p">@</span> <input id="username" type="text" class="settings-modal__input settings-modal__input--with-prefix svelte-1jqzo7p" placeholder="username"/></div> <span class="settings-modal__hint svelte-1jqzo7p">Только буквы, цифры и _ (3-50 символов)</span></div> <div class="settings-modal__field svelte-1jqzo7p"><label for="bio" class="settings-modal__label svelte-1jqzo7p">О себе</label> <textarea id="bio" class="settings-modal__textarea svelte-1jqzo7p" placeholder="Расскажите о себе..." rows="3"></textarea></div> <button class="settings-modal__save svelte-1jqzo7p"> </button></div>')
  , ni = p('<div class="settings-modal__form svelte-1jqzo7p"><div class="settings-modal__field svelte-1jqzo7p"><label for="current-password" class="settings-modal__label svelte-1jqzo7p">Текущий пароль</label> <input id="current-password" type="password" class="settings-modal__input svelte-1jqzo7p" placeholder="Введите текущий пароль"/></div> <div class="settings-modal__field svelte-1jqzo7p"><label for="new-password" class="settings-modal__label svelte-1jqzo7p">Новый пароль</label> <input id="new-password" type="password" class="settings-modal__input svelte-1jqzo7p" placeholder="Минимум 8 символов"/></div> <div class="settings-modal__field svelte-1jqzo7p"><label for="confirm-password" class="settings-modal__label svelte-1jqzo7p">Подтвердите пароль</label> <input id="confirm-password" type="password" class="settings-modal__input svelte-1jqzo7p" placeholder="Повторите новый пароль"/></div> <button class="settings-modal__save svelte-1jqzo7p"> </button></div>')
  , oi = p('<div class="settings-modal__loading svelte-1jqzo7p">Загрузка...</div>')
  , ii = p('<div class="settings-modal__toggle-item svelte-1jqzo7p"><div class="settings-modal__toggle-content svelte-1jqzo7p"><span class="settings-modal__toggle-name svelte-1jqzo7p">Закрыть стену</span> <span class="settings-modal__hint svelte-1jqzo7p">Другие пользователи не смогут писать записи на вашей стене</span></div> <button aria-label="Закрыть стену"><span class="settings-modal__toggle-thumb svelte-1jqzo7p"></span></button></div>')
  , li = p('<div class="settings-modal__form svelte-1jqzo7p"><!></div>')
  , ci = p('<div class="settings-modal__loading svelte-1jqzo7p"><!></div>')
  , di = p('<div class="settings-modal__empty svelte-1jqzo7p"><div class="settings-modal__empty-icon svelte-1jqzo7p">📌</div> <p class="settings-modal__empty-text svelte-1jqzo7p">У вас ещё нет пинов</p> <p class="settings-modal__empty-hint svelte-1jqzo7p">Пины можно получить за участие в ивентах</p></div>')
  , vi = p('<span class="settings-modal__pin-active svelte-1jqzo7p"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><polyline points="20 6 9 17 4 12"></polyline></svg></span>')
  , ui = p('<button><img class="settings-modal__pin-icon svelte-1jqzo7p" width="32" height="32"/> <div class="settings-modal__pin-info svelte-1jqzo7p"><span class="settings-modal__pin-name svelte-1jqzo7p"> </span> <span class="settings-modal__pin-desc svelte-1jqzo7p"> </span></div> <!></button>')
  , fi = p('<div class="settings-modal__pins-list svelte-1jqzo7p"></div>')
  , hi = p('<div class="settings-modal__form svelte-1jqzo7p"><!></div>')
  , gi = p('<div class="settings-modal__content svelte-1jqzo7p"><!> <!> <!> <!> <!> <!> <!></div>');
function mi(s, t) {
    We(t, !0);
    const n = () => Ke(Ot, "$currentUser", f)
      , a = () => Ke(tr, "$themeStore", f)
      , l = () => Ke(rr, "$snowStore", f)
      , [f,v] = Ct();
    let c = S("main")
      , h = S(!1)
      , m = S("")
      , z = S("")
      , P = S("")
      , _ = S("")
      , b = S("")
      , C = S("")
      , I = S("")
      , R = S("")
      , L = S("")
      , j = S(!1)
      , E = S(!1)
      , F = S(rt([]))
      , ee = S(!1)
      , ae = S(!1);
    ft( () => {
        t.isOpen && n() && (r(c, "main"),
        r(z, n().displayName || "", !0),
        r(P, n().username || "", !0),
        r(_, n().bio || "", !0),
        r(b, n().avatar || "", !0),
        r(m, ""),
        r(L, ""),
        r(C, ""),
        r(I, ""),
        r(R, ""))
    }
    );
    async function J() {
        r(E, !0);
        const Y = await Ht.getPrivacySettings();
        r(E, !1),
        Y.data && r(j, Y.data.wallClosed, !0)
    }
    async function re() {
        r(ee, !0),
        r(m, "");
        const Y = await Ht.getMyPins();
        if (r(ee, !1),
        Y.error) {
            r(m, Y.error, !0);
            return
        }
        r(F, Y.data || [], !0)
    }
    async function ue(Y) {
        r(ae, !0),
        r(m, "");
        const we = e(F).find(K => K.slug === Y);
        if (we) {
            if (we.isActive) {
                const K = await Ht.removeActivePin();
                K.success ? r(F, e(F).map(Z => ({
                    ...Z,
                    isActive: !1
                })), !0) : r(m, K.error || "Ошибка", !0)
            } else {
                const K = await Ht.setActivePin(Y);
                K.success ? r(F, e(F).map(Z => ({
                    ...Z,
                    isActive: Z.slug === Y
                })), !0) : r(m, K.error || "Ошибка", !0)
            }
            r(ae, !1)
        }
    }
    function ie() {
        r(c, "pins"),
        re()
    }
    function ce() {
        r(c, "main"),
        r(m, ""),
        r(L, ""),
        t.onClose()
    }
    function oe() {
        r(c, "main"),
        r(m, ""),
        r(L, "")
    }
    async function O() {
        if (!e(z).trim()) {
            r(m, "Имя обязательно");
            return
        }
        if (e(z).trim().length > 50) {
            r(m, "Имя должно быть до 50 символов");
            return
        }
        if (e(P) && !/^[a-zA-Z0-9_]+$/.test(e(P))) {
            r(m, "Юзернейм может содержать только буквы, цифры и _");
            return
        }
        if (e(P) && (e(P).length < 3 || e(P).length > 50)) {
            r(m, "Юзернейм должен быть от 3 до 50 символов");
            return
        }
        r(h, !0),
        r(m, "");
        const Y = await Ht.updateProfile({
            displayName: e(z).trim(),
            username: e(P).trim() || void 0,
            bio: e(_).trim() || void 0
        });
        if (r(h, !1),
        Y.error) {
            r(m, Y.error, !0);
            return
        }
        r(c, "main")
    }
    async function D() {
        if (!e(C) || !e(I) || !e(R)) {
            r(m, "Заполните все поля");
            return
        }
        if (e(I) !== e(R)) {
            r(m, "Пароли не совпадают");
            return
        }
        if (e(I).length < 8) {
            r(m, "Пароль должен быть минимум 8 символов");
            return
        }
        if (!/[a-zA-Z]/.test(e(I))) {
            r(m, "Пароль должен содержать хотя бы одну букву");
            return
        }
        if (!/\d/.test(e(I))) {
            r(m, "Пароль должен содержать хотя бы одну цифру");
            return
        }
        r(h, !0),
        r(m, "");
        const Y = await Ht.changePassword({
            oldPassword: e(C),
            newPassword: e(I)
        });
        if (r(h, !1),
        !Y.success) {
            Y.errorCode === "INVALID_OLD_PASSWORD" ? r(m, "Неверный текущий пароль") : Y.errorCode === "SAME_PASSWORD" ? r(m, "Новый пароль должен отличаться от текущего") : Y.errorCode === "INVALID_PASSWORD" ? r(m, "Пароль не соответствует требованиям") : r(m, Y.error || "Ошибка смены пароля", !0);
            return
        }
        r(C, ""),
        r(I, ""),
        r(R, ""),
        r(L, "Пароль успешно изменён"),
        r(c, "main")
    }
    function H() {
        switch (e(c)) {
        case "personal":
            return "Личная информация";
        case "security":
            return "Пароль и безопасность";
        case "privacy":
            return "Приватность";
        case "pins":
            return "Пины";
        default:
            return "Настройки"
        }
    }
    function X() {
        r(c, "privacy"),
        J()
    }
    async function te() {
        const Y = !e(j);
        r(j, Y);
        const we = await Ht.updatePrivacySettings({
            wallClosed: Y
        });
        we.error && (r(j, !Y),
        r(m, we.error, !0))
    }
    async function ke() {
        await ir.logout(),
        ga.logout(),
        ce(),
        Ft("/login")
    }
    wa(s, {
        get isOpen() {
            return t.isOpen
        },
        onClose: ce,
        maxWidth: "440px",
        showCloseButton: !1,
        noPadding: !0,
        header: we => {
            var K = $o()
              , Z = i(K);
            {
                var N = k => {
                    var x = Jo();
                    x.__click = oe;
                    var w = i(x);
                    Ts(w, {
                        size: 20
                    }),
                    o(x),
                    d(k, x)
                }
                ;
                M(Z, k => {
                    e(c) !== "main" && k(N)
                }
                )
            }
            var $ = u(Z, 2)
              , g = i($, !0);
            o($);
            var T = u($, 2);
            T.__click = ce;
            var y = i(T);
            Lt(y, {
                size: 20
            }),
            o(T),
            o(K),
            q(k => de(g, k), [H]),
            d(we, K)
        }
        ,
        children: (we, K) => {
            var Z = gi()
              , N = i(Z);
            {
                var $ = fe => {
                    var ze = ei()
                      , je = i(ze, !0);
                    o(ze),
                    q( () => de(je, e(L))),
                    d(fe, ze)
                }
                ;
                M(N, fe => {
                    e(L) && fe($)
                }
                )
            }
            var g = u(N, 2);
            {
                var T = fe => {
                    var ze = ti()
                      , je = i(ze, !0);
                    o(ze),
                    q( () => de(je, e(m))),
                    d(fe, ze)
                }
                ;
                M(g, fe => {
                    e(m) && fe(T)
                }
                )
            }
            var y = u(g, 2);
            {
                var k = fe => {
                    var ze = ai()
                      , je = u(i(ze), 2)
                      , Oe = i(je);
                    Oe.__click = () => r(c, "personal");
                    var U = u(Oe, 2);
                    U.__click = () => r(c, "security");
                    var W = u(U, 2);
                    W.__click = X;
                    var B = u(W, 2);
                    B.__click = ie;
                    var G = u(B, 2)
                      , Ce = u(i(G), 2);
                    let De;
                    Ce.__click = () => tr.toggle(),
                    o(G);
                    var ve = u(G, 2)
                      , be = u(i(ve), 2);
                    let _e;
                    be.__click = () => rr.toggle(),
                    o(ve);
                    var Me = u(ve, 2);
                    Me.__click = ke,
                    o(je),
                    o(ze),
                    q( () => {
                        De = ye(Ce, 1, "settings-modal__toggle svelte-1jqzo7p", null, De, {
                            active: a() === "dark"
                        }),
                        se(Ce, "aria-pressed", a() === "dark"),
                        _e = ye(be, 1, "settings-modal__toggle svelte-1jqzo7p", null, _e, {
                            active: l()
                        }),
                        se(be, "aria-pressed", l())
                    }
                    ),
                    d(fe, ze)
                }
                ;
                M(y, fe => {
                    e(c) === "main" && fe(k)
                }
                )
            }
            var x = u(y, 2);
            {
                var w = fe => {
                    var ze = si()
                      , je = i(ze)
                      , Oe = u(i(je), 2)
                      , U = i(Oe)
                      , W = i(U);
                    {
                        var B = Ie => {
                            var qe = ri()
                              , Fe = i(qe, !0);
                            o(qe),
                            q( () => de(Fe, e(b))),
                            d(Ie, qe)
                        }
                          , G = Ie => {
                            Pr(Ie, {
                                size: 64
                            })
                        }
                        ;
                        M(W, Ie => {
                            e(b) ? Ie(B) : Ie(G, !1)
                        }
                        )
                    }
                    o(U),
                    Ge(2),
                    o(Oe),
                    o(je);
                    var Ce = u(je, 2)
                      , De = u(i(Ce), 2);
                    Qt(De),
                    Ge(2),
                    o(Ce);
                    var ve = u(Ce, 2)
                      , be = u(i(ve), 2)
                      , _e = u(i(be), 2);
                    Qt(_e),
                    o(be),
                    Ge(2),
                    o(ve);
                    var Me = u(ve, 2)
                      , ge = u(i(Me), 2);
                    Vt(ge),
                    o(Me);
                    var Te = u(Me, 2);
                    Te.__click = O;
                    var Ne = i(Te, !0);
                    o(Te),
                    o(ze),
                    q( () => {
                        Te.disabled = e(h),
                        de(Ne, e(h) ? "Сохранение..." : "Сохранить")
                    }
                    ),
                    Nt(De, () => e(z), Ie => r(z, Ie)),
                    Nt(_e, () => e(P), Ie => r(P, Ie)),
                    Nt(ge, () => e(_), Ie => r(_, Ie)),
                    d(fe, ze)
                }
                ;
                M(x, fe => {
                    e(c) === "personal" && fe(w)
                }
                )
            }
            var A = u(x, 2);
            {
                var Q = fe => {
                    var ze = ni()
                      , je = i(ze)
                      , Oe = u(i(je), 2);
                    Qt(Oe),
                    o(je);
                    var U = u(je, 2)
                      , W = u(i(U), 2);
                    Qt(W),
                    o(U);
                    var B = u(U, 2)
                      , G = u(i(B), 2);
                    Qt(G),
                    o(B);
                    var Ce = u(B, 2);
                    Ce.__click = D;
                    var De = i(Ce, !0);
                    o(Ce),
                    o(ze),
                    q( () => {
                        Ce.disabled = !e(C) || !e(I) || !e(R) || e(h),
                        de(De, e(h) ? "Сохранение..." : "Сменить пароль")
                    }
                    ),
                    Nt(Oe, () => e(C), ve => r(C, ve)),
                    Nt(W, () => e(I), ve => r(I, ve)),
                    Nt(G, () => e(R), ve => r(R, ve)),
                    d(fe, ze)
                }
                ;
                M(A, fe => {
                    e(c) === "security" && fe(Q)
                }
                )
            }
            var le = u(A, 2);
            {
                var xe = fe => {
                    var ze = li()
                      , je = i(ze);
                    {
                        var Oe = W => {
                            var B = oi();
                            d(W, B)
                        }
                          , U = W => {
                            var B = ii()
                              , G = u(i(B), 2);
                            let Ce;
                            G.__click = te,
                            o(B),
                            q( () => {
                                Ce = ye(G, 1, "settings-modal__toggle svelte-1jqzo7p", null, Ce, {
                                    active: e(j)
                                }),
                                se(G, "aria-pressed", e(j))
                            }
                            ),
                            d(W, B)
                        }
                        ;
                        M(je, W => {
                            e(E) ? W(Oe) : W(U, !1)
                        }
                        )
                    }
                    o(ze),
                    d(fe, ze)
                }
                ;
                M(le, fe => {
                    e(c) === "privacy" && fe(xe)
                }
                )
            }
            var he = u(le, 2);
            {
                var Se = fe => {
                    var ze = hi()
                      , je = i(ze);
                    {
                        var Oe = W => {
                            var B = ci()
                              , G = i(B);
                            ha(G, {}),
                            o(B),
                            d(W, B)
                        }
                          , U = W => {
                            var B = He()
                              , G = Pe(B);
                            {
                                var Ce = ve => {
                                    var be = di();
                                    d(ve, be)
                                }
                                  , De = ve => {
                                    var be = fi();
                                    Qe(be, 21, () => e(F), _e => _e.slug, (_e, Me) => {
                                        var ge = ui();
                                        let Te;
                                        ge.__click = () => ue(e(Me).slug);
                                        var Ne = i(ge)
                                          , Ie = u(Ne, 2)
                                          , qe = i(Ie)
                                          , Fe = i(qe, !0);
                                        o(qe);
                                        var Xe = u(qe, 2)
                                          , Je = i(Xe, !0);
                                        o(Xe),
                                        o(Ie);
                                        var st = u(Ie, 2);
                                        {
                                            var ct = it => {
                                                var dt = vi();
                                                d(it, dt)
                                            }
                                            ;
                                            M(st, it => {
                                                e(Me).isActive && it(ct)
                                            }
                                            )
                                        }
                                        o(ge),
                                        q( () => {
                                            Te = ye(ge, 1, "settings-modal__pin-item svelte-1jqzo7p", null, Te, {
                                                active: e(Me).isActive
                                            }),
                                            ge.disabled = e(ae),
                                            se(Ne, "src", `/assets/pins/${e(Me).slug ?? ""}.png`),
                                            se(Ne, "alt", e(Me).name),
                                            de(Fe, e(Me).name),
                                            de(Je, e(Me).description)
                                        }
                                        ),
                                        d(_e, ge)
                                    }
                                    ),
                                    o(be),
                                    d(ve, be)
                                }
                                ;
                                M(G, ve => {
                                    e(F).length === 0 ? ve(Ce) : ve(De, !1)
                                }
                                , !0)
                            }
                            d(W, B)
                        }
                        ;
                        M(je, W => {
                            e(ee) ? W(Oe) : W(U, !1)
                        }
                        )
                    }
                    o(ze),
                    d(fe, ze)
                }
                ;
                M(he, fe => {
                    e(c) === "pins" && fe(Se)
                }
                )
            }
            o(Z),
            d(we, Z)
        }
        ,
        $$slots: {
            header: !0,
            default: !0
        }
    }),
    Ye(),
    v()
}
Ze(["click"]);
var _i = p('<div class="loader svelte-lrcio1"><svg class="loader__spinner svelte-lrcio1" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><circle class="loader__track svelte-lrcio1" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="3"></circle><path class="loader__arc svelte-lrcio1" d="M12 2a10 10 0 0 1 10 10" stroke="currentColor" stroke-width="3" stroke-linecap="round"></path></svg></div>');
function ha(s, t) {
    let n = me(t, "size", 3, 24);
    var a = _i()
      , l = i(a);
    o(a),
    q( () => {
        se(l, "width", n()),
        se(l, "height", n())
    }
    ),
    d(s, a)
}
var pi = p('<div><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"></path></svg></div>');
function Pr(s, t) {
    let n = me(t, "size", 3, 40)
      , a = me(t, "class", 3, "")
      , l = V( () => Math.round(n() * .6));
    var f = pi()
      , v = i(f);
    o(f),
    q( () => {
        ye(f, 1, `no-avatar no-avatar--${n() ?? ""} ${a() ?? ""}`, "svelte-2ybtc7"),
        se(v, "width", e(l)),
        se(v, "height", e(l))
    }
    ),
    d(s, f)
}
var wi = p("<img/>")
  , bi = p("<div> </div>");
function kt(s, t) {
    let n = me(t, "name", 3, "")
      , a = me(t, "size", 3, 40)
      , l = me(t, "class", 3, "");
    function f(z) {
        return z.startsWith("http://") || z.startsWith("https://")
    }
    var v = He()
      , c = Pe(v);
    {
        var h = z => {
            var P = wi();
            q( () => {
                se(P, "src", t.avatar),
                se(P, "alt", n()),
                ye(P, 1, `avatar avatar--img ${l() ?? ""}`, "svelte-6nt8hx"),
                lt(P, `width: ${a() ?? ""}px; height: ${a() ?? ""}px;`)
            }
            ),
            d(z, P)
        }
          , m = z => {
            var P = He()
              , _ = Pe(P);
            {
                var b = I => {
                    var R = bi()
                      , L = i(R, !0);
                    o(R),
                    q( () => {
                        ye(R, 1, `avatar avatar--emoji ${l() ?? ""}`, "svelte-6nt8hx"),
                        lt(R, `width: ${a() ?? ""}px; height: ${a() ?? ""}px; font-size: ${a() * .6}px;`),
                        de(L, t.avatar)
                    }
                    ),
                    d(I, R)
                }
                  , C = I => {
                    Pr(I, {
                        get name() {
                            return n()
                        },
                        get size() {
                            return a()
                        }
                    })
                }
                ;
                M(_, I => {
                    t.avatar ? I(b) : I(C, !1)
                }
                , !0)
            }
            d(z, P)
        }
        ;
        M(c, z => {
            t.avatar && f(t.avatar) ? z(h) : z(m, !1)
        }
        )
    }
    d(s, v)
}
var yi = p('<div class="verified-hint">Пользователь верифицирован <div class="verified-hint__arrow"></div></div>')
  , ki = p('<span class="verified-badge-wrapper svelte-1ulqoed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 36 36" fill="none" aria-label="Пользователь верифицирован" role="img"><path fill="#0080FF" d="M15.13 1.848c1.46-2.514 5.057-2.45 6.429.115l1.253 2.343a3.677 3.677 0 0 0 3.762 1.926l2.597-.373c2.842-.408 5.036 2.493 3.92 5.182L32.07 13.5a3.804 3.804 0 0 0 .865 4.192l1.906 1.833c2.086 2.006 1.224 5.56-1.54 6.348l-2.525.721c-1.484.424-2.554 1.74-2.683 3.302l-.22 2.658c-.242 2.91-3.51 4.44-5.84 2.734l-2.13-1.558a3.644 3.644 0 0 0-4.21-.075l-2.181 1.482c-2.387 1.622-5.601-.023-5.743-2.94l-.129-2.664c-.076-1.566-1.1-2.919-2.568-3.395l-2.499-.81c-2.735-.887-3.474-4.469-1.32-6.4l1.967-1.763a3.801 3.801 0 0 0 1.008-4.16l-.935-2.492C2.27 7.785 4.563 4.963 7.39 5.472l2.582.465a3.673 3.673 0 0 0 3.826-1.791l1.333-2.298Z"></path><path stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="m24 15-8 8-4-4"></path></svg></span> <!>', 1);
function La(s, t) {
    let n = me(t, "size", 3, 14)
      , a = me(t, "class", 3, "")
      , l = S(null)
      , f = S(!1)
      , v = S(0)
      , c = S(0);
    function h() {
        if (!e(l))
            return;
        const I = e(l).getBoundingClientRect();
        r(v, I.left + I.width / 2),
        r(c, I.top, !0),
        r(f, !0)
    }
    function m() {
        r(f, !1)
    }
    var z = ki()
      , P = Pe(z)
      , _ = i(P);
    o(P),
    et(P, I => r(l, I), () => e(l));
    var b = u(P, 2);
    {
        var C = I => {
            ra(I, {
                children: (R, L) => {
                    var j = yi();
                    q( () => lt(j, `left: ${e(v) ?? ""}px; top: ${e(c) ?? ""}px;`)),
                    d(R, j)
                }
                ,
                $$slots: {
                    default: !0
                }
            })
        }
        ;
        M(b, I => {
            e(f) && I(C)
        }
        )
    }
    q( () => {
        ye(_, 0, `verified-badge ${a() ?? ""}`, "svelte-1ulqoed"),
        se(_, "width", n()),
        se(_, "height", n())
    }
    ),
    mt("mouseenter", P, h),
    mt("mouseleave", P, m),
    d(s, z)
}
var xi = p('<h2 class="modal__title svelte-ymr1h5"> </h2>')
  , Ci = p("<div></div>")
  , zi = p('<button class="modal__close svelte-ymr1h5" aria-label="Закрыть"><!></button>')
  , Pi = p('<div class="modal__header svelte-ymr1h5"><!> <!></div>')
  , Mi = p('<div class="modal__footer svelte-ymr1h5"><!></div>')
  , Si = p('<div><div role="presentation"></div> <div role="dialog" aria-modal="true"><!> <div><!></div> <!></div></div>');
function wa(s, t) {
    We(t, !0);
    let n = me(t, "title", 3, "")
      , a = me(t, "maxWidth", 3, "480px")
      , l = me(t, "showCloseButton", 3, !0)
      , f = me(t, "closeOnBackdrop", 3, !0)
      , v = me(t, "closeDisabled", 3, !1)
      , c = me(t, "noPadding", 3, !1)
      , h = me(t, "priority", 3, !1)
      , m = S(!1);
    ft( () => {
        t.isOpen && r(m, !0)
    }
    );
    function z() {
        v() || (r(m, !1),
        setTimeout( () => {
            t.onClose()
        }
        , 300))
    }
    function P() {
        f() && z()
    }
    function _(R) {
        R.key === "Escape" && !v() && z()
    }
    var b = He();
    mt("keydown", Ia, _);
    var C = Pe(b);
    {
        var I = R => {
            var L = Si();
            let j;
            var E = i(L);
            let F;
            E.__click = P;
            var ee = u(E, 2);
            let ae;
            var J = i(ee);
            {
                var re = H => {
                    var X = He()
                      , te = Pe(X);
                    ua(te, () => t.header),
                    d(H, X)
                }
                  , ue = H => {
                    var X = He()
                      , te = Pe(X);
                    {
                        var ke = Y => {
                            var we = Pi()
                              , K = i(we);
                            {
                                var Z = T => {
                                    var y = xi()
                                      , k = i(y, !0);
                                    o(y),
                                    q( () => de(k, n())),
                                    d(T, y)
                                }
                                  , N = T => {
                                    var y = Ci();
                                    d(T, y)
                                }
                                ;
                                M(K, T => {
                                    n() ? T(Z) : T(N, !1)
                                }
                                )
                            }
                            var $ = u(K, 2);
                            {
                                var g = T => {
                                    var y = zi();
                                    y.__click = z;
                                    var k = i(y);
                                    Lt(k, {
                                        size: 20
                                    }),
                                    o(y),
                                    q( () => y.disabled = v()),
                                    d(T, y)
                                }
                                ;
                                M($, T => {
                                    l() && T(g)
                                }
                                )
                            }
                            o(we),
                            d(Y, we)
                        }
                        ;
                        M(te, Y => {
                            (n() || l()) && Y(ke)
                        }
                        , !0)
                    }
                    d(H, X)
                }
                ;
                M(J, H => {
                    t.header ? H(re) : H(ue, !1)
                }
                )
            }
            var ie = u(J, 2);
            let ce;
            var oe = i(ie);
            ua(oe, () => t.children),
            o(ie);
            var O = u(ie, 2);
            {
                var D = H => {
                    var X = Mi()
                      , te = i(X);
                    ua(te, () => t.footer),
                    o(X),
                    d(H, X)
                }
                ;
                M(O, H => {
                    t.footer && H(D)
                }
                )
            }
            o(ee),
            o(L),
            q( () => {
                j = ye(L, 1, "modal svelte-ymr1h5", null, j, {
                    priority: h()
                }),
                F = ye(E, 1, "modal__backdrop svelte-ymr1h5", null, F, {
                    visible: e(m)
                }),
                ae = ye(ee, 1, "modal__card svelte-ymr1h5", null, ae, {
                    visible: e(m)
                }),
                lt(ee, `max-width: ${a() ?? ""}`),
                ce = ye(ie, 1, "modal__body svelte-ymr1h5", null, ce, {
                    "no-padding": c()
                })
            }
            ),
            d(R, L)
        }
        ;
        M(C, R => {
            t.isOpen && R(I)
        }
        )
    }
    d(s, b),
    Ye()
}
Ze(["click"]);
var Ii = p('<img loading="lazy" decoding="async"/>');
function Ti(s, t) {
    We(t, !0);
    let n = me(t, "alt", 3, "")
      , a = me(t, "class", 3, "")
      , l = me(t, "placeholder", 3, "")
      , f = null
      , v = S(!1)
      , c = S(!1)
      , h = S(!1)
      , m = t.src;
    ft( () => {
        t.src !== m && (m = t.src,
        r(v, !1),
        r(h, !1))
    }
    ),
    sa( () => {
        if (!f)
            return;
        const C = new IntersectionObserver(I => {
            I.forEach(R => {
                R.isIntersecting && (r(c, !0),
                C.disconnect())
            }
            )
        }
        ,{
            rootMargin: "100px"
        });
        return C.observe(f),
        () => C.disconnect()
    }
    );
    function z() {
        r(v, !0)
    }
    function P() {
        r(h, !0)
    }
    var _ = Ii();
    let b;
    et(_, C => f = C, () => f),
    q( () => {
        se(_, "src", e(c) && !e(h) ? t.src : l() || void 0),
        se(_, "alt", n()),
        se(_, "width", t.width),
        se(_, "height", t.height),
        b = ye(_, 1, `lazy-image ${a() ?? ""}`, "svelte-ad0ir9", b, {
            loaded: e(v),
            error: e(h)
        }),
        lt(_, t.width && t.height ? `aspect-ratio: ${t.width} / ${t.height};` : "")
    }
    ),
    mt("load", _, z),
    mt("error", _, P),
    ss(_),
    d(s, _),
    Ye()
}
var Ri = p('<button class="toast-clear-all svelte-1o52jmt"> </button>')
  , Di = Ve('<svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"></path></svg>')
  , ji = Ve('<svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M21 6h-2V4c0-1.1-.9-2-2-2H3c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h2v3c0 .55.45 1 1 1h.5c.25 0 .5-.1.7-.29L10.92 18H17c1.1 0 2-.9 2-2v-2h2c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2z"></path></svg>')
  , qi = Ve('<svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M15 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm-9-2V7H4v3H1v2h3v3h2v-3h3v-2H6zm9 4c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"></path></svg>')
  , Ai = Ve('<svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M7 7h10v3l4-4-4-4v3H5v6h2V7zm10 10H7v-3l-4 4 4 4v-3h12v-6h-2v4z"></path></svg>')
  , Li = Ve('<svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M12 22c1.1 0 2-.9 2-2h-4c0 1.1.89 2 2 2zm6-6v-5c0-3.07-1.64-5.64-4.5-6.32V4c0-.83-.67-1.5-1.5-1.5s-1.5.67-1.5 1.5v.68C7.63 5.36 6 7.92 6 11v5l-2 2v1h16v-1l-2-2z"></path></svg>')
  , Ui = p('<p class="toast__preview svelte-1o52jmt"> </p>')
  , Oi = p('<div role="button" tabindex="0"><div><!></div> <div class="toast__avatar svelte-1o52jmt"><!></div> <div class="toast__content svelte-1o52jmt"><p class="toast__text svelte-1o52jmt"> </p> <!></div> <button class="toast__close svelte-1o52jmt" aria-label="Закрыть"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg></button></div>')
  , Bi = p('<div class="toast-container svelte-1o52jmt"><!> <!></div>');
function gc(s, t) {
    We(t, !1);
    const n = () => Ke(os, "$toastNotifications", a)
      , [a,l] = Ct()
      , f = ["like", "comment", "reply", "repost", "mention", "wall_post"];
    function v(b) {
        if (Zt.removeToast(b.id),
        Zt.markAsRead(b.id),
        f.includes(b.type) && b.targetId)
            Xs.open(b.targetId);
        else {
            const C = Zt.getNotificationLink(b);
            Ft(C)
        }
    }
    function c(b, C) {
        b.stopPropagation(),
        Zt.removeToast(C.id)
    }
    function h() {
        n().forEach(b => Zt.removeToast(b.id))
    }
    cr();
    var m = Bi()
      , z = i(m);
    {
        var P = b => {
            var C = Ri();
            C.__click = h;
            var I = i(C);
            o(C),
            q( () => de(I, `Скрыть все (${n().length ?? ""})`)),
            d(b, C)
        }
        ;
        M(z, b => {
            n().length > 1 && b(P)
        }
        )
    }
    var _ = u(z, 2);
    Qe(_, 3, n, b => b.id, (b, C, I) => {
        var R = Oi();
        let L;
        R.__click = () => v(e(C)),
        R.__keydown = D => D.key === "Enter" && v(e(C));
        var j = i(R)
          , E = i(j);
        {
            var F = D => {
                var H = Di();
                d(D, H)
            }
              , ee = D => {
                var H = He()
                  , X = Pe(H);
                {
                    var te = Y => {
                        var we = ji();
                        d(Y, we)
                    }
                      , ke = Y => {
                        var we = He()
                          , K = Pe(we);
                        {
                            var Z = $ => {
                                var g = qi();
                                d($, g)
                            }
                              , N = $ => {
                                var g = He()
                                  , T = Pe(g);
                                {
                                    var y = x => {
                                        var w = Ai();
                                        d(x, w)
                                    }
                                      , k = x => {
                                        var w = Li();
                                        d(x, w)
                                    }
                                    ;
                                    M(T, x => {
                                        e(C).type === "repost" ? x(y) : x(k, !1)
                                    }
                                    , !0)
                                }
                                d($, g)
                            }
                            ;
                            M(K, $ => {
                                e(C).type === "follow" ? $(Z) : $(N, !1)
                            }
                            , !0)
                        }
                        d(Y, we)
                    }
                    ;
                    M(X, Y => {
                        e(C).type === "comment" || e(C).type === "reply" ? Y(te) : Y(ke, !1)
                    }
                    , !0)
                }
                d(D, H)
            }
            ;
            M(E, D => {
                e(C).type === "like" ? D(F) : D(ee, !1)
            }
            )
        }
        o(j);
        var ae = u(j, 2)
          , J = i(ae);
        kt(J, {
            get avatar() {
                return e(C).actor.avatar
            },
            get name() {
                return e(C).actor.displayName
            },
            size: 32
        }),
        o(ae);
        var re = u(ae, 2)
          , ue = i(re)
          , ie = i(ue, !0);
        o(ue);
        var ce = u(ue, 2);
        {
            var oe = D => {
                var H = Ui()
                  , X = i(H, !0);
                o(H),
                q( () => de(X, e(C).preview)),
                d(D, H)
            }
            ;
            M(ce, D => {
                e(C).preview && D(oe)
            }
            )
        }
        o(re);
        var O = u(re, 2);
        O.__click = D => c(D, e(C)),
        o(R),
        q(D => {
            L = ye(R, 1, "toast svelte-1o52jmt", null, L, {
                "toast--stacked": e(I) > 0
            }),
            lt(R, `--stack-index: ${e(I) ?? ""}`),
            ye(j, 1, `toast__icon toast__icon--${e(C).type ?? ""}`, "svelte-1o52jmt"),
            de(ie, D)
        }
        , [ () => Zt.getNotificationText(e(C))]),
        d(b, R)
    }
    ),
    o(m),
    d(s, m),
    Ye(),
    l()
}
Ze(["click", "keydown"]);
var Ei = p('<div class="error-toast svelte-15l2axh" role="alert"><div class="error-toast__icon svelte-15l2axh"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="8" x2="12" y2="12"></line><line x1="12" y1="16" x2="12.01" y2="16"></line></svg></div> <p class="error-toast__message svelte-15l2axh"> </p> <button class="error-toast__close svelte-15l2axh" aria-label="Закрыть"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg></button></div>')
  , Hi = p('<div class="error-toast-container svelte-15l2axh"></div>');
function mc(s, t) {
    We(t, !1);
    const n = () => Ke(Mt, "$errorToast", a)
      , [a,l] = Ct();
    function f(m) {
        Mt.dismiss(m)
    }
    cr();
    var v = He()
      , c = Pe(v);
    {
        var h = m => {
            var z = Hi();
            Qe(z, 5, n, P => P.id, (P, _) => {
                var b = Ei()
                  , C = u(i(b), 2)
                  , I = i(C, !0);
                o(C);
                var R = u(C, 2);
                R.__click = () => f(e(_).id),
                o(b),
                q( () => de(I, e(_).message)),
                d(P, b)
            }
            ),
            o(z),
            d(m, z)
        }
        ;
        M(c, m => {
            n().length > 0 && m(h)
        }
        )
    }
    d(s, v),
    Ye(),
    l()
}
Ze(["click"]);
var Ni = p('<div class="image-viewer__counter svelte-nusr1p"> </div>')
  , Fi = p('<button class="image-viewer__nav image-viewer__nav--prev svelte-nusr1p" aria-label="Предыдущее изображение"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="15 18 9 12 15 6"></polyline></svg></button>')
  , Vi = p('<div><img class="image-viewer__image svelte-nusr1p" draggable="false"/></div>')
  , Wi = p('<button class="image-viewer__nav image-viewer__nav--next svelte-nusr1p" aria-label="Следующее изображение"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="9 18 15 12 9 6"></polyline></svg></button>')
  , Yi = p("<button></button>")
  , Xi = p('<div class="image-viewer__dots svelte-nusr1p"></div>')
  , Zi = p('<div class="image-viewer svelte-nusr1p"><div class="image-viewer__backdrop svelte-nusr1p" role="presentation"></div> <button class="image-viewer__close svelte-nusr1p" aria-label="Закрыть"><!></button> <!> <div class="image-viewer__content svelte-nusr1p" role="presentation"><!> <div class="image-viewer__slider svelte-nusr1p" role="presentation"></div> <!></div> <!></div>');
function Mr(s, t) {
    We(t, !0);
    let n = me(t, "initialIndex", 3, 0)
      , a = S(rt(n()))
      , l = S(!1)
      , f = S(!0)
      , v = S(!1)
      , c = S(0)
      , h = 0
      , m = 0
      , z = 0
      , P = null
      , _ = 0
      , b = 0
      , C = 0
      , I = !1
      , R = 0;
    function L(D) {
        return document.body.appendChild(D),
        {
            destroy() {
                D.remove()
            }
        }
    }
    ft( () => (t.isOpen && (r(f, !0),
    r(a, n()),
    r(v, !1),
    r(c, 0),
    requestAnimationFrame( () => {
        requestAnimationFrame( () => {
            r(f, !1)
        }
        )
    }
    ),
    document.body.style.position !== "fixed" && (R = window.scrollY,
    document.body.style.position = "fixed",
    document.body.style.top = `-${R}px`,
    document.body.style.left = "0",
    document.body.style.right = "0",
    document.body.style.overflow = "hidden",
    I = !0)),
    () => {
        I && (document.body.style.position = "",
        document.body.style.top = "",
        document.body.style.left = "",
        document.body.style.right = "",
        document.body.style.overflow = "",
        window.scrollTo(0, R),
        I = !1)
    }
    ));
    function j() {
        t.onClose()
    }
    function E(D) {
        D === e(a) || e(l) || D < 0 || D >= t.attachments.length || (r(l, !0),
        r(a, D, !0),
        setTimeout( () => {
            r(l, !1)
        }
        , 300))
    }
    function F(D) {
        t.isOpen && (D.key === "Escape" ? j() : D.key === "ArrowRight" ? E(e(a) + 1) : D.key === "ArrowLeft" && E(e(a) - 1))
    }
    function ee(D, H) {
        D.stopPropagation(),
        E(H === "next" ? e(a) + 1 : e(a) - 1)
    }
    function ae(D) {
        D.target.tagName === "IMG" && j()
    }
    function J(D) {
        e(l) || t.attachments.length <= 1 || (r(v, !0),
        h = D.touches[0].clientX,
        m = D.touches[0].clientY,
        r(c, 0),
        z = P?.offsetWidth || window.innerWidth,
        _ = h,
        b = Date.now(),
        C = 0)
    }
    function re(D) {
        if (!e(v) || e(l))
            return;
        const H = D.touches[0].clientX
          , X = D.touches[0].clientY
          , te = H - h
          , ke = Math.abs(X - m);
        if (Math.abs(te) > ke) {
            D.preventDefault();
            const Y = Date.now()
              , we = Y - b;
            we > 0 && (C = (H - _) / we),
            _ = H,
            b = Y;
            const K = e(a) === 0 && te > 0
              , Z = e(a) === t.attachments.length - 1 && te < 0;
            K || Z ? r(c, te * .2) : r(c, te)
        }
    }
    function ue() {
        if (!e(v))
            return;
        r(v, !1);
        const D = z * .2
          , H = .5
          , X = (e(c) < -D || C < -H) && e(a) < t.attachments.length - 1
          , te = (e(c) > D || C > H) && e(a) > 0;
        X ? Jt(a) : te && Jt(a, -1),
        r(l, !0),
        r(c, 0),
        setTimeout( () => {
            r(l, !1)
        }
        , 250)
    }
    function ie(D) {
        const H = (D - e(a)) * 100
          , X = z > 0 ? e(c) / z * 100 : 0;
        return `translateX(${H + X}%)`
    }
    var ce = He();
    mt("keydown", Ia, F);
    var oe = Pe(ce);
    {
        var O = D => {
            var H = Zi()
              , X = i(H);
            X.__click = j;
            var te = u(X, 2);
            te.__click = j;
            var ke = i(te);
            Lt(ke, {
                size: 24
            }),
            o(te);
            var Y = u(te, 2);
            {
                var we = x => {
                    var w = Ni()
                      , A = i(w);
                    o(w),
                    q( () => de(A, `${e(a) + 1} / ${t.attachments.length ?? ""}`)),
                    d(x, w)
                }
                ;
                M(Y, x => {
                    t.attachments.length > 1 && x(we)
                }
                )
            }
            var K = u(Y, 2);
            K.__click = j;
            var Z = i(K);
            {
                var N = x => {
                    var w = Fi();
                    w.__click = A => ee(A, "prev"),
                    q( () => w.disabled = e(a) === 0),
                    d(x, w)
                }
                ;
                M(Z, x => {
                    t.attachments.length > 1 && x(N)
                }
                )
            }
            var $ = u(Z, 2);
            $.__click = ae,
            $.__touchstart = J,
            $.__touchmove = re,
            $.__touchend = ue,
            Qe($, 23, () => t.attachments, (x, w) => x.id || w, (x, w, A) => {
                var Q = Vi();
                let le;
                var xe = i(Q);
                o(Q),
                q(he => {
                    le = ye(Q, 1, "image-viewer__slide svelte-nusr1p", null, le, {
                        dragging: e(v),
                        "no-transition": e(f)
                    }),
                    lt(Q, `transform: ${he ?? ""}`),
                    se(xe, "src", e(w).url),
                    se(xe, "alt", e(w).alt || "")
                }
                , [ () => ie(e(A))]),
                d(x, Q)
            }
            ),
            o($),
            et($, x => P = x, () => P);
            var g = u($, 2);
            {
                var T = x => {
                    var w = Wi();
                    w.__click = A => ee(A, "next"),
                    q( () => w.disabled = e(a) === t.attachments.length - 1),
                    d(x, w)
                }
                ;
                M(g, x => {
                    t.attachments.length > 1 && x(T)
                }
                )
            }
            o(K);
            var y = u(K, 2);
            {
                var k = x => {
                    var w = Xi();
                    Qe(w, 21, () => t.attachments, bt, (A, Q, le) => {
                        var xe = Yi();
                        let he;
                        xe.__click = Se => {
                            Se.stopPropagation(),
                            E(le)
                        }
                        ,
                        se(xe, "aria-label", `Перейти к изображению ${le + 1}`),
                        q( () => he = ye(xe, 1, "image-viewer__dot svelte-nusr1p", null, he, {
                            active: le === e(a)
                        })),
                        d(A, xe)
                    }
                    ),
                    o(w),
                    d(x, w)
                }
                ;
                M(y, x => {
                    t.attachments.length > 1 && x(k)
                }
                )
            }
            o(H),
            Yt(H, x => L?.(x)),
            d(D, H)
        }
        ;
        M(oe, D => {
            t.isOpen && D(O)
        }
        )
    }
    d(s, ce),
    Ye()
}
Ze(["click", "touchstart", "touchmove", "touchend"]);
var Ki = p('<div class="hashtag-autocomplete__loading svelte-u041s5">Поиск...</div>')
  , Gi = p('<button><span class="hashtag-autocomplete__name svelte-u041s5"> </span> <span class="hashtag-autocomplete__count svelte-u041s5"> </span></button>')
  , Qi = p('<div class="hashtag-autocomplete svelte-u041s5"><!></div>');
function Sr(s, t) {
    We(t, !0);
    let n = S(rt([])), a = S(!1), l = S(0), f, v;
    ft( () => {
        clearTimeout(v),
        t.query ? v = setTimeout( () => c(t.query), 150) : h()
    }
    );
    async function c(I) {
        r(a, !0);
        const R = await $a.search(I, 8);
        R.data && (r(n, R.data.hashtags, !0),
        r(l, 0)),
        r(a, !1)
    }
    async function h() {
        r(a, !0);
        const I = await $a.getTrending(8);
        I.data && (r(n, I.data.hashtags, !0),
        r(l, 0)),
        r(a, !1)
    }
    function m(I) {
        if (e(n).length !== 0)
            switch (I.key) {
            case "ArrowDown":
                I.preventDefault(),
                r(l, (e(l) + 1) % e(n).length);
                break;
            case "ArrowUp":
                I.preventDefault(),
                r(l, (e(l) - 1 + e(n).length) % e(n).length);
                break;
            case "Enter":
            case "Tab":
                I.preventDefault(),
                e(n)[e(l)] && t.onSelect(e(n)[e(l)]);
                break;
            case "Escape":
                I.preventDefault(),
                t.onClose();
                break
            }
    }
    function z(I) {
        t.onSelect(I)
    }
    function P(I) {
        f && !f.contains(I.target) && t.onClose()
    }
    ft( () => (document.addEventListener("click", P),
    document.addEventListener("keydown", m),
    () => {
        document.removeEventListener("click", P),
        document.removeEventListener("keydown", m)
    }
    ));
    var _ = He()
      , b = Pe(_);
    {
        var C = I => {
            var R = Qi()
              , L = i(R);
            {
                var j = F => {
                    var ee = Ki();
                    d(F, ee)
                }
                  , E = F => {
                    var ee = He()
                      , ae = Pe(ee);
                    Qe(ae, 17, () => e(n), bt, (J, re, ue) => {
                        var ie = Gi();
                        let ce;
                        ie.__click = () => z(e(re));
                        var oe = i(ie)
                          , O = i(oe);
                        o(oe);
                        var D = u(oe, 2)
                          , H = i(D);
                        o(D),
                        o(ie),
                        q( () => {
                            ce = ye(ie, 1, "hashtag-autocomplete__item svelte-u041s5", null, ce, {
                                selected: ue === e(l)
                            }),
                            de(O, `#${e(re).name ?? ""}`),
                            de(H, `${e(re).postsCount ?? ""} постов`)
                        }
                        ),
                        d(J, ie)
                    }
                    ),
                    d(F, ee)
                }
                ;
                M(L, F => {
                    e(a) && e(n).length === 0 ? F(j) : F(E, !1)
                }
                )
            }
            o(R),
            et(R, F => f = F, () => f),
            q( () => lt(R, `top: ${t.position.top ?? ""}px; left: ${t.position.left ?? ""}px`)),
            d(I, R)
        }
        ;
        M(b, I => {
            (e(n).length > 0 || e(a)) && I(C)
        }
        )
    }
    d(s, _),
    Ye()
}
Ze(["click"]);
var Ji = p('<a class="hashtag-link svelte-jp7hc5"> </a>')
  , $i = p('<button class="post-content-expand svelte-jp7hc5">Показать полностью</button>')
  , el = p('<div><p class="post-content svelte-jp7hc5"></p> <!></div>');
function Ir(s, t) {
    We(t, !0);
    const n = 1e3;
    let a = V( () => m(t.content))
      , l = S(null)
      , f = S(!0)
      , v = S(!1)
      , c = S(!1);
    const h = t.maxHeight ?? n;
    t.maxHeight !== void 0 || t.maxHeight,
    ft( () => {
        if (e(l) && !e(c) && t.maxHeight !== void 0) {
            const R = e(l).scrollHeight;
            r(v, R > h),
            r(c, !0)
        }
    }
    );
    function m(R) {
        const L = /#([a-zA-Zа-яА-ЯёЁ0-9_]+)/g
          , j = [];
        let E = 0, F;
        for (; (F = L.exec(R)) !== null; )
            F.index > E && j.push({
                type: "text",
                value: R.slice(E, F.index)
            }),
            j.push({
                type: "hashtag",
                value: F[1]
            }),
            E = L.lastIndex;
        return E < R.length && j.push({
            type: "text",
            value: R.slice(E)
        }),
        j
    }
    function z(R) {
        R.stopPropagation(),
        r(f, !1)
    }
    var P = el();
    let _;
    var b = i(P);
    Qe(b, 21, () => e(a), bt, (R, L) => {
        var j = He()
          , E = Pe(j);
        {
            var F = ae => {
                var J = Ji()
                  , re = i(J);
                o(J),
                q( () => {
                    se(J, "href", `/hashtag/${e(L).value ?? ""}`),
                    de(re, `#${e(L).value ?? ""}`)
                }
                ),
                d(ae, J)
            }
              , ee = ae => {
                var J = Wt();
                q( () => de(J, e(L).value)),
                d(ae, J)
            }
            ;
            M(E, ae => {
                e(L).type === "hashtag" ? ae(F) : ae(ee, !1)
            }
            )
        }
        d(R, j)
    }
    ),
    o(b),
    et(b, R => r(l, R), () => e(l));
    var C = u(b, 2);
    {
        var I = R => {
            var L = $i();
            L.__click = z,
            d(R, L)
        }
        ;
        M(C, R => {
            e(v) && e(f) && R(I)
        }
        )
    }
    o(P),
    q( () => {
        _ = ye(P, 1, "post-content-wrapper svelte-jp7hc5", null, _, {
            collapsed: e(c) && e(v) && e(f)
        }),
        lt(P, `--max-height: ${h ?? ""}px`)
    }
    ),
    d(s, P),
    Ye()
}
Ze(["click"]);
var tl = p('<a class="hashtag-link svelte-1tzky91"> </a>')
  , al = p("<span></span>");
function rl(s, t) {
    let n = me(t, "class", 3, "")
      , a = V( () => l(t.content));
    function l(v) {
        const c = /#([a-zA-Zа-яА-ЯёЁ0-9_]+)/g
          , h = [];
        let m = 0, z;
        for (; (z = c.exec(v)) !== null; )
            z.index > m && h.push({
                type: "text",
                value: v.slice(m, z.index)
            }),
            h.push({
                type: "hashtag",
                value: z[1]
            }),
            m = c.lastIndex;
        return m < v.length && h.push({
            type: "text",
            value: v.slice(m)
        }),
        h
    }
    var f = al();
    Qe(f, 21, () => e(a), bt, (v, c) => {
        var h = He()
          , m = Pe(h);
        {
            var z = _ => {
                var b = tl();
                b.__click = I => I.stopPropagation();
                var C = i(b);
                o(b),
                q( () => {
                    se(b, "href", `/hashtag/${e(c).value ?? ""}`),
                    de(C, `#${e(c).value ?? ""}`)
                }
                ),
                d(_, b)
            }
              , P = _ => {
                var b = Wt();
                q( () => de(b, e(c).value)),
                d(_, b)
            }
            ;
            M(m, _ => {
                e(c).type === "hashtag" ? _(z) : _(P, !1)
            }
            )
        }
        d(v, h)
    }
    ),
    o(f),
    q( () => ye(f, 1, lr(n()), "svelte-1tzky91")),
    d(s, f)
}
Ze(["click"]);
var sl = p('<button class="voice-btn voice-btn--mic svelte-6l4ubt" title="Записать голосовое"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z"></path><path d="M19 10v2a7 7 0 0 1-14 0v-2"></path><line x1="12" x2="12" y1="19" y2="22"></line></svg></button>')
  , nl = p('<div class="voice-bar svelte-6l4ubt"></div>')
  , ol = p('<div class="voice-bar svelte-6l4ubt" style="height: 4px; opacity: 0.3"></div>')
  , il = p('<div class="voice-recording svelte-6l4ubt"><button class="voice-btn voice-btn--stop svelte-6l4ubt" title="Остановить"><svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><rect x="6" y="6" width="12" height="12" rx="2"></rect></svg></button> <div class="voice-waveform voice-waveform--recording svelte-6l4ubt"><!> <!></div> <span class="voice-time svelte-6l4ubt"> </span> <button class="voice-btn voice-btn--cancel svelte-6l4ubt" title="Отмена"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg></button></div>')
  , ll = Ve('<svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><rect x="6" y="4" width="4" height="16" rx="1"></rect><rect x="14" y="4" width="4" height="16" rx="1"></rect></svg>')
  , cl = Ve('<svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg>')
  , dl = p("<div></div>")
  , vl = p('<div class="voice-preview svelte-6l4ubt"><button class="voice-btn voice-btn--play svelte-6l4ubt"><!></button> <div class="voice-waveform voice-waveform--preview svelte-6l4ubt"></div> <span class="voice-time svelte-6l4ubt"> </span> <button class="voice-btn voice-btn--delete svelte-6l4ubt" title="Удалить"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path></svg></button> <button class="voice-btn voice-btn--send svelte-6l4ubt" title="Отправить"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><line x1="5" y1="12" x2="19" y2="12"></line><polyline points="12 5 19 12 12 19"></polyline></svg></button></div>')
  , ul = p('<div class="voice-recorder svelte-6l4ubt"><!></div>');
function fl(s, t) {
    We(t, !0);
    let n = me(t, "maxDuration", 3, 300)
      , a = S(!1)
      , l = S(!1)
      , f = S(!1)
      , v = S(!1)
      , c = S(0)
      , h = S(0)
      , m = S(rt([]))
      , z = null
      , P = []
      , _ = null
      , b = null
      , C = null
      , I = null
      , R = null
      , L = null
      , j = null
      , E = null;
    sa( () => {
        C = new Audio,
        C.addEventListener("ended", () => {
            r(v, !1),
            r(h, 0)
        }
        ),
        C.addEventListener("timeupdate", () => {
            r(h, C?.currentTime || 0, !0)
        }
        )
    }
    ),
    Sa( () => {
        F()
    }
    );
    function F() {
        J(),
        b && URL.revokeObjectURL(b),
        L && cancelAnimationFrame(L),
        j && clearInterval(j),
        E && E.getTracks().forEach(te => te.stop()),
        R && R.close()
    }
    async function ee() {
        try {
            E = await navigator.mediaDevices.getUserMedia({
                audio: !0
            }),
            R = new AudioContext,
            I = R.createAnalyser(),
            I.fftSize = 256,
            R.createMediaStreamSource(E).connect(I);
            const ke = MediaRecorder.isTypeSupported("audio/webm;codecs=opus") ? "audio/webm;codecs=opus" : MediaRecorder.isTypeSupported("audio/webm") ? "audio/webm" : MediaRecorder.isTypeSupported("audio/mp4") ? "audio/mp4" : "audio/ogg";
            z = new MediaRecorder(E,{
                mimeType: ke
            }),
            P = [],
            r(m, [], !0),
            z.ondataavailable = Y => {
                Y.data.size > 0 && P.push(Y.data)
            }
            ,
            z.onstop = () => {
                const Y = ke.split(";")[0];
                _ = new Blob(P,{
                    type: Y
                }),
                b = URL.createObjectURL(_),
                C && (C.src = b),
                r(f, !0)
            }
            ,
            z.start(100),
            r(a, !0),
            r(c, 0),
            t.onRecordingStart?.(),
            j = setInterval( () => {
                r(c, e(c) + .1),
                e(c) >= n() && J()
            }
            , 100),
            ae()
        } catch {}
    }
    function ae() {
        if (!I || !e(a))
            return;
        const te = new Uint8Array(I.frequencyBinCount)
          , ke = () => {
            if (!e(a) || !I)
                return;
            L = requestAnimationFrame(ke),
            I.getByteFrequencyData(te);
            const Y = te.reduce( (K, Z) => K + Z, 0) / te.length
              , we = Math.min(Y / 128, 1);
            r(m, [...e(m).slice(-49), we], !0)
        }
        ;
        ke()
    }
    function J() {
        z && z.state !== "inactive" && z.stop(),
        E && E.getTracks().forEach(te => te.stop()),
        L && cancelAnimationFrame(L),
        j && clearInterval(j),
        r(a, !1),
        r(l, !1)
    }
    function re() {
        !C || !b || (e(v) ? (C.pause(),
        r(v, !1)) : (C.play(),
        r(v, !0)))
    }
    function ue() {
        C && (C.pause(),
        C.currentTime = 0),
        r(v, !1),
        b && URL.revokeObjectURL(b),
        _ = null,
        b = null,
        r(f, !1),
        r(c, 0),
        r(h, 0),
        r(m, [], !0),
        t.onCancel?.()
    }
    function ie() {
        _ && (t.onRecordingComplete(_, e(c)),
        ue())
    }
    function ce(te) {
        const ke = Math.floor(te / 60)
          , Y = Math.floor(te % 60);
        return `${ke}:${Y.toString().padStart(2, "0")}`
    }
    var oe = {
        startRecording: ee
    }
      , O = ul()
      , D = i(O);
    {
        var H = te => {
            var ke = sl();
            ke.__click = ee,
            d(te, ke)
        }
          , X = te => {
            var ke = He()
              , Y = Pe(ke);
            {
                var we = Z => {
                    var N = il()
                      , $ = i(N);
                    $.__click = J;
                    var g = u($, 2)
                      , T = i(g);
                    Qe(T, 17, () => e(m), bt, (Q, le) => {
                        var xe = nl();
                        q(he => lt(xe, `height: ${he ?? ""}px; opacity: ${.4 + e(le) * .6}`), [ () => Math.max(4, e(le) * 24)]),
                        d(Q, xe)
                    }
                    );
                    var y = u(T, 2);
                    {
                        var k = Q => {
                            var le = He()
                              , xe = Pe(le);
                            Qe(xe, 17, () => Array(50 - e(m).length), bt, (he, Se) => {
                                var fe = ol();
                                d(he, fe)
                            }
                            ),
                            d(Q, le)
                        }
                        ;
                        M(y, Q => {
                            e(m).length < 50 && Q(k)
                        }
                        )
                    }
                    o(g);
                    var x = u(g, 2)
                      , w = i(x, !0);
                    o(x);
                    var A = u(x, 2);
                    A.__click = ue,
                    o(N),
                    q(Q => de(w, Q), [ () => ce(e(c))]),
                    d(Z, N)
                }
                  , K = Z => {
                    var N = He()
                      , $ = Pe(N);
                    {
                        var g = T => {
                            var y = vl()
                              , k = i(y);
                            k.__click = re;
                            var x = i(k);
                            {
                                var w = fe => {
                                    var ze = ll();
                                    d(fe, ze)
                                }
                                  , A = fe => {
                                    var ze = cl();
                                    d(fe, ze)
                                }
                                ;
                                M(x, fe => {
                                    e(v) ? fe(w) : fe(A, !1)
                                }
                                )
                            }
                            o(k);
                            var Q = u(k, 2);
                            Qe(Q, 21, () => e(m), bt, (fe, ze, je) => {
                                const Oe = V( () => e(h) / e(c))
                                  , U = V( () => je / e(m).length);
                                var W = dl();
                                let B;
                                q(G => {
                                    B = ye(W, 1, "voice-bar svelte-6l4ubt", null, B, {
                                        "voice-bar--played": e(U) < e(Oe)
                                    }),
                                    lt(W, `height: ${G ?? ""}px`)
                                }
                                , [ () => Math.max(4, e(ze) * 24)]),
                                d(fe, W)
                            }
                            ),
                            o(Q);
                            var le = u(Q, 2)
                              , xe = i(le, !0);
                            o(le);
                            var he = u(le, 2);
                            he.__click = ue;
                            var Se = u(he, 2);
                            Se.__click = ie,
                            o(y),
                            q(fe => {
                                se(k, "title", e(v) ? "Пауза" : "Воспроизвести"),
                                de(xe, fe)
                            }
                            , [ () => ce(e(v) ? e(h) : e(c))]),
                            d(T, y)
                        }
                        ;
                        M($, T => {
                            e(f) && T(g)
                        }
                        , !0)
                    }
                    d(Z, N)
                }
                ;
                M(Y, Z => {
                    e(a) ? Z(we) : Z(K, !1)
                }
                , !0)
            }
            d(te, ke)
        }
        ;
        M(D, te => {
            !e(a) && !e(f) ? te(H) : te(X, !1)
        }
        )
    }
    return o(O),
    d(s, O),
    Ye(oe)
}
Ze(["click"]);
let Gt = null
  , da = null;
const va = {
    play(s, t) {
        Gt && Gt !== s && da && da(),
        Gt = s,
        da = t
    },
    stop(s) {
        Gt === s && (Gt = null,
        da = null)
    },
    isPlaying(s) {
        return Gt === s
    }
};
var hl = Ve('<svg class="spinner svelte-154nnrp" width="18" height="18" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="3" fill="none" stroke-dasharray="31.4" stroke-linecap="round"><animateTransform attributeName="transform" type="rotate" from="0 12 12" to="360 12 12" dur="1s" repeatCount="indefinite"></animateTransform></circle></svg>')
  , gl = Ve('<svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor" class="svelte-154nnrp"><rect x="6" y="4" width="4" height="16" rx="1"></rect><rect x="14" y="4" width="4" height="16" rx="1"></rect></svg>')
  , ml = Ve('<svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor" class="svelte-154nnrp"><polygon points="6 3 20 12 6 21 6 3"></polygon></svg>')
  , _l = p("<div></div>")
  , pl = p('<span class="voice-message__duration svelte-154nnrp"> </span>')
  , wl = p('<div><button class="voice-message__play svelte-154nnrp"><!></button> <div class="voice-message__content svelte-154nnrp"><div></div> <div class="voice-message__info svelte-154nnrp"><span class="voice-message__time svelte-154nnrp"> </span> <!></div></div></div>');
function bl(s, t) {
    We(t, !0);
    const n = 45;
    let a = me(t, "duration", 3, 0);
    const l = `voice_${t.src}_${Math.random().toString(36).slice(2)}`;
    let f = S(!1)
      , v = S(!0)
      , c = S(0)
      , h = S(rt(a()))
      , m = rt(R())
      , z = S(!1)
      , P = S(null)
      , _ = null
      , b = null
      , C = null;
    function I() {
        _ && e(f) && (_.pause(),
        C && cancelAnimationFrame(C),
        r(f, !1))
    }
    sa(async () => {
        _ = new Audio(t.src),
        _.addEventListener("loadedmetadata", () => {
            r(h, _?.duration || a(), !0),
            r(v, !1)
        }
        ),
        _.addEventListener("ended", () => {
            r(f, !1),
            r(c, 0),
            C && cancelAnimationFrame(C),
            va.stop(l)
        }
        ),
        _.addEventListener("error", () => {
            r(v, !1)
        }
        )
    }
    ),
    Sa( () => {
        _ && (_.pause(),
        _ = null),
        C && cancelAnimationFrame(C),
        va.stop(l)
    }
    );
    function R() {
        const k = [];
        let x = L(t.src);
        for (let w = 0; w < n; w++) {
            x = (x * 9301 + 49297) % 233280;
            const A = .2 + x / 233280 * .8;
            k.push(A)
        }
        return k
    }
    function L(k) {
        let x = 0;
        for (let w = 0; w < k.length; w++) {
            const A = k.charCodeAt(w);
            x = (x << 5) - x + A,
            x = x & x
        }
        return Math.abs(x)
    }
    function j() {
        !_ || !e(f) || (r(c, _.currentTime, !0),
        C = requestAnimationFrame(j))
    }
    function E() {
        !_ || e(v) || (e(f) ? (_.pause(),
        C && cancelAnimationFrame(C),
        r(f, !1),
        va.stop(l)) : (va.play(l, I),
        _.play(),
        r(f, !0),
        j()))
    }
    function F(k) {
        if (!b || !e(h))
            return 0;
        const x = b.getBoundingClientRect()
          , w = "touches"in k ? k.touches[0].clientX : k.clientX;
        return Math.max(0, Math.min(w - x.left, x.width)) / x.width
    }
    function ee(k) {
        if (!_ || !e(h) || e(z))
            return;
        const x = F(k);
        _.currentTime = x * e(h),
        r(c, _.currentTime, !0)
    }
    function ae(k) {
        if (!_ || !e(h))
            return;
        r(z, !0);
        const x = F(k);
        _.currentTime = x * e(h),
        r(c, _.currentTime, !0),
        document.addEventListener("mousemove", J),
        document.addEventListener("mouseup", re)
    }
    function J(k) {
        if (!e(z) || !_ || !e(h))
            return;
        const x = F(k);
        _.currentTime = x * e(h),
        r(c, _.currentTime, !0)
    }
    function re() {
        r(z, !1),
        document.removeEventListener("mousemove", J),
        document.removeEventListener("mouseup", re)
    }
    function ue(k) {
        r(P, F(k), !0)
    }
    function ie(k) {
        e(z) || r(P, F(k), !0)
    }
    function ce() {
        r(P, null)
    }
    function oe(k) {
        if (!isFinite(k) || isNaN(k))
            return "0:00";
        const x = Math.floor(k / 60)
          , w = Math.floor(k % 60);
        return `${x}:${w.toString().padStart(2, "0")}`
    }
    let O = V( () => e(h) > 0 ? e(c) / e(h) : 0);
    var D = wl();
    let H;
    var X = i(D);
    X.__click = E;
    var te = i(X);
    {
        var ke = k => {
            var x = hl();
            d(k, x)
        }
          , Y = k => {
            var x = He()
              , w = Pe(x);
            {
                var A = le => {
                    var xe = gl();
                    d(le, xe)
                }
                  , Q = le => {
                    var xe = ml();
                    d(le, xe)
                }
                ;
                M(w, le => {
                    e(f) ? le(A) : le(Q, !1)
                }
                , !0)
            }
            d(k, x)
        }
        ;
        M(te, k => {
            e(v) ? k(ke) : k(Y, !1)
        }
        )
    }
    o(X);
    var we = u(X, 2)
      , K = i(we);
    let Z;
    K.__click = ee,
    K.__mousedown = ae,
    K.__mousemove = ie,
    Qe(K, 21, () => m, bt, (k, x, w) => {
        const A = V( () => (w + .5) / m.length)
          , Q = V( () => e(A) <= e(O))
          , le = V( () => e(P) !== null && e(A) <= e(P) && !e(Q));
        var xe = _l();
        let he;
        q(Se => {
            he = ye(xe, 1, "voice-message__bar svelte-154nnrp", null, he, {
                "voice-message__bar--played": e(Q),
                "voice-message__bar--hover": e(le)
            }),
            lt(xe, `height: ${Se ?? ""}px`)
        }
        , [ () => Math.max(4, e(x) * 24)]),
        d(k, xe)
    }
    ),
    o(K),
    et(K, k => b = k, () => b);
    var N = u(K, 2)
      , $ = i(N)
      , g = i($, !0);
    o($);
    var T = u($, 2);
    {
        var y = k => {
            var x = pl()
              , w = i(x);
            o(x),
            q(A => de(w, `/ ${A ?? ""}`), [ () => oe(e(h))]),
            d(k, x)
        }
        ;
        M(T, k => {
            (e(f) || e(c) > 0) && k(y)
        }
        )
    }
    o(N),
    o(we),
    o(D),
    q(k => {
        H = ye(D, 1, "voice-message svelte-154nnrp", null, H, {
            "voice-message--playing": e(f)
        }),
        X.disabled = e(v),
        Z = ye(K, 1, "voice-message__waveform svelte-154nnrp", null, Z, {
            "voice-message__waveform--dragging": e(z)
        }),
        de(g, k)
    }
    , [ () => oe(e(f) || e(c) > 0 ? e(c) : e(h))]),
    mt("mouseenter", K, ue),
    mt("mouseleave", K, ce),
    d(s, D),
    Ye()
}
Ze(["click", "mousedown", "mousemove"]);
var yl = p('<button><span class="size-preview svelte-12bmgzp"></span></button>')
  , kl = p("<button></button>")
  , xl = Ve('<svg class="spinner svelte-12bmgzp" width="18" height="18" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="3" fill="none" stroke-dasharray="31.4" stroke-linecap="round"><animateTransform attributeName="transform" type="rotate" from="0 12 12" to="360 12 12" dur="1s" repeatCount="indefinite"></animateTransform></circle></svg> Сохранение...', 1)
  , Cl = p('<div class="drawing-overlay svelte-12bmgzp" role="presentation"><div class="drawing-modal svelte-12bmgzp" role="dialog" aria-modal="true"><div class="drawing-header svelte-12bmgzp"><h2 class="drawing-title svelte-12bmgzp">Рисование</h2> <button class="drawing-close svelte-12bmgzp" aria-label="Закрыть"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-12bmgzp"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg></button></div> <div class="drawing-toolbar svelte-12bmgzp"><div class="toolbar-section svelte-12bmgzp"><span class="toolbar-label svelte-12bmgzp">Инструменты</span> <div class="toolbar-tools svelte-12bmgzp"><button title="Кисть"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-12bmgzp"><path d="M18.37 2.63 14 7l-1.59-1.59a2 2 0 0 0-2.82 0L8 7l9 9 1.59-1.59a2 2 0 0 0 0-2.82L17 10l4.37-4.37a2.12 2.12 0 1 0-3-3Z"></path><path d="M9 8c-2 3-4 3.5-7 4l8 10c2-1 6-5 6-7"></path><path d="M14.5 17.5 4.5 15"></path></svg></button> <button title="Ластик"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-12bmgzp"><path d="m7 21-4.3-4.3c-1-1-1-2.5 0-3.4l9.6-9.6c1-1 2.5-1 3.4 0l5.6 5.6c1 1 1 2.5 0 3.4L13 21"></path><path d="M22 21H7"></path><path d="m5 11 9 9"></path></svg></button> <button title="Линия"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-12bmgzp"><line x1="5" y1="19" x2="19" y2="5"></line></svg></button> <button title="Прямоугольник"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-12bmgzp"><rect x="3" y="3" width="18" height="18" rx="2"></rect></svg></button> <button title="Круг"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-12bmgzp"><circle cx="12" cy="12" r="10"></circle></svg></button></div></div> <div class="toolbar-section svelte-12bmgzp"><span class="toolbar-label svelte-12bmgzp"> </span> <div class="toolbar-sizes svelte-12bmgzp"></div></div> <div class="toolbar-section toolbar-section--actions svelte-12bmgzp"><button class="action-btn svelte-12bmgzp" title="Отменить (Ctrl+Z)"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 7v6h6"></path><path d="M21 17a9 9 0 0 0-9-9 9 9 0 0 0-6 2.3L3 13"></path></svg></button> <button class="action-btn svelte-12bmgzp" title="Повторить (Ctrl+Y)"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 7v6h-6"></path><path d="M3 17a9 9 0 0 1 9-9 9 9 0 0 1 6 2.3l3 2.7"></path></svg></button> <button class="action-btn action-btn--danger svelte-12bmgzp" title="Очистить"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 6h18"></path><path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"></path><path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"></path></svg></button></div></div> <div class="drawing-colors svelte-12bmgzp"><!> <label class="color-picker-label svelte-12bmgzp"><input type="color" class="color-picker-input svelte-12bmgzp"/> <span class="color-picker-preview svelte-12bmgzp" style="background: conic-gradient(red, yellow, lime, aqua, blue, magenta, red);"></span></label></div> <div class="drawing-canvas-container svelte-12bmgzp"><canvas class="drawing-canvas svelte-12bmgzp"></canvas></div> <div class="drawing-footer svelte-12bmgzp"><button class="drawing-btn drawing-btn--cancel svelte-12bmgzp">Отмена</button> <button class="drawing-btn drawing-btn--save svelte-12bmgzp"><!></button></div></div></div>');
function Tr(s, t) {
    We(t, !0);
    let n = me(t, "isSaving", 3, !1)
      , a = S(null)
      , l = null
      , f = S(!1)
      , v = S("brush")
      , c = S(5)
      , h = S("#ffffff")
      , m = 0
      , z = 0
      , P = 0
      , _ = 0
      , b = null;
    const C = ["#ffffff", "#000000", "#ff0000", "#ff6600", "#ffff00", "#00ff00", "#00ffff", "#0066ff", "#9900ff", "#ff00ff", "#ff9999", "#ffcc99", "#ffff99", "#99ff99", "#99ffff", "#9999ff", "#cc99ff", "#ff99ff", "#666666", "#999999"]
      , I = [2, 5, 10, 15, 25, 40];
    let R = S(rt([]))
      , L = S(-1);
    const j = 50;
    let E = V( () => e(L) > 0)
      , F = V( () => e(L) < e(R).length - 1);
    function ee(g) {
        if (!l || !e(a))
            return;
        const T = e(a).parentElement;
        if (T) {
            const y = Math.min(T.clientWidth - 32, 800);
            t.aspectRatio ? (e(a).width = y,
            e(a).height = Math.round(y / t.aspectRatio)) : (e(a).width = y,
            e(a).height = Math.min(window.innerHeight - 300, 500))
        }
        if (b = document.createElement("canvas"),
        b.width = e(a).width,
        b.height = e(a).height,
        l.fillStyle = "#1a1a1a",
        l.fillRect(0, 0, e(a).width, e(a).height),
        g) {
            const y = new Image;
            y.crossOrigin = "anonymous",
            y.onload = () => {
                if (!l || !e(a))
                    return;
                l.fillStyle = "#1a1a1a",
                l.fillRect(0, 0, e(a).width, e(a).height);
                const k = Math.min(e(a).width / y.width, e(a).height / y.height)
                  , x = y.width * k
                  , w = y.height * k
                  , A = (e(a).width - x) / 2
                  , Q = (e(a).height - w) / 2;
                l.drawImage(y, A, Q, x, w),
                ae()
            }
            ,
            y.onerror = () => ae(),
            y.src = g
        } else
            ae()
    }
    function ae() {
        if (!l || !e(a))
            return;
        e(L) < e(R).length - 1 && r(R, e(R).slice(0, e(L) + 1), !0);
        const g = l.getImageData(0, 0, e(a).width, e(a).height);
        r(R, [...e(R), g], !0),
        e(R).length > j && r(R, e(R).slice(e(R).length - j), !0),
        r(L, e(R).length - 1)
    }
    function J() {
        !e(E) || !l || !e(a) || (Jt(L, -1),
        l.putImageData(e(R)[e(L)], 0, 0))
    }
    function re() {
        !e(F) || !l || !e(a) || (Jt(L),
        l.putImageData(e(R)[e(L)], 0, 0))
    }
    function ue(g) {
        const T = e(a).getBoundingClientRect();
        let y, k;
        return g instanceof TouchEvent ? (y = g.touches[0]?.clientX ?? g.changedTouches[0]?.clientX ?? 0,
        k = g.touches[0]?.clientY ?? g.changedTouches[0]?.clientY ?? 0) : (y = g.clientX,
        k = g.clientY),
        {
            x: y - T.left,
            y: k - T.top
        }
    }
    function ie(g) {
        if (!l)
            return;
        g.preventDefault(),
        r(f, !0);
        const {x: T, y} = ue(g);
        if (m = T,
        z = y,
        e(v) === "line" || e(v) === "rectangle" || e(v) === "circle") {
            if (P = T,
            _ = y,
            b) {
                const k = b.getContext("2d");
                k && k.drawImage(e(a), 0, 0)
            }
        } else
            l.beginPath(),
            l.arc(T, y, e(c) / 2, 0, Math.PI * 2),
            l.fillStyle = e(v) === "eraser" ? "#1a1a1a" : e(h),
            l.fill();
        document.addEventListener("mousemove", ce),
        document.addEventListener("mouseup", oe)
    }
    function ce(g) {
        O(g)
    }
    function oe(g) {
        D(g),
        document.removeEventListener("mousemove", ce),
        document.removeEventListener("mouseup", oe)
    }
    function O(g) {
        if (!e(f) || !l || !e(a))
            return;
        g.preventDefault();
        const {x: T, y} = ue(g);
        e(v) === "brush" || e(v) === "eraser" ? (l.beginPath(),
        l.moveTo(m, z),
        l.lineTo(T, y),
        l.strokeStyle = e(v) === "eraser" ? "#1a1a1a" : e(h),
        l.lineWidth = e(c),
        l.lineCap = "round",
        l.lineJoin = "round",
        l.stroke(),
        m = T,
        z = y) : (e(v) === "line" || e(v) === "rectangle" || e(v) === "circle") && b && (l.clearRect(0, 0, e(a).width, e(a).height),
        l.drawImage(b, 0, 0),
        H(P, _, T, y))
    }
    function D(g) {
        if (!(!e(f) || !l)) {
            if (g.preventDefault(),
            e(v) === "line" || e(v) === "rectangle" || e(v) === "circle") {
                const {x: T, y} = ue(g);
                b && (l.clearRect(0, 0, e(a).width, e(a).height),
                l.drawImage(b, 0, 0),
                H(P, _, T, y))
            }
            r(f, !1),
            ae()
        }
    }
    function H(g, T, y, k, x) {
        if (l) {
            if (l.strokeStyle = e(h),
            l.lineWidth = e(c),
            l.lineCap = "round",
            l.lineJoin = "round",
            e(v) === "line")
                l.beginPath(),
                l.moveTo(g, T),
                l.lineTo(y, k),
                l.stroke();
            else if (e(v) === "rectangle")
                l.beginPath(),
                l.strokeRect(g, T, y - g, k - T);
            else if (e(v) === "circle") {
                const w = (g + y) / 2
                  , A = (T + k) / 2
                  , Q = Math.abs(y - g) / 2
                  , le = Math.abs(k - T) / 2;
                l.beginPath(),
                l.ellipse(w, A, Q, le, 0, 0, Math.PI * 2),
                l.stroke()
            }
        }
    }
    function X() {
        !l || !e(a) || (l.fillStyle = "#1a1a1a",
        l.fillRect(0, 0, e(a).width, e(a).height),
        ae())
    }
    function te() {
        e(a) && e(a).toBlob(g => {
            if (g) {
                const T = e(a).toDataURL("image/png");
                t.onSave(g, T)
            }
        }
        , "image/png")
    }
    let ke = !1;
    function Y(g) {
        ke = g.target === g.currentTarget
    }
    function we(g) {
        ke && g.target === g.currentTarget && t.onClose(),
        ke = !1
    }
    function K(g) {
        t.isOpen && (g.key === "Escape" ? t.onClose() : (g.ctrlKey || g.metaKey) && g.key === "z" ? (g.preventDefault(),
        g.shiftKey ? re() : J()) : (g.ctrlKey || g.metaKey) && g.key === "y" && (g.preventDefault(),
        re()))
    }
    ft( () => {
        const g = t.initialImage;
        return t.isOpen ? (r(v, "brush"),
        r(c, 5),
        r(h, "#ffffff"),
        r(f, !1),
        r(R, [], !0),
        r(L, -1),
        document.addEventListener("keydown", K),
        setTimeout( () => {
            e(a) && (l = e(a).getContext("2d", {
                willReadFrequently: !0
            }),
            ee(g))
        }
        , 50)) : (l = null,
        b = null,
        r(R, [], !0),
        r(L, -1)),
        () => {
            document.removeEventListener("keydown", K),
            document.removeEventListener("mousemove", ce),
            document.removeEventListener("mouseup", oe)
        }
    }
    );
    var Z = He()
      , N = Pe(Z);
    {
        var $ = g => {
            var T = Cl();
            T.__mousedown = Y,
            T.__click = we;
            var y = i(T)
              , k = i(y)
              , x = u(i(k), 2);
            x.__click = function(...Be) {
                t.onClose?.apply(this, Be)
            }
            ,
            o(k);
            var w = u(k, 2)
              , A = i(w)
              , Q = u(i(A), 2)
              , le = i(Q);
            let xe;
            le.__click = () => r(v, "brush");
            var he = u(le, 2);
            let Se;
            he.__click = () => r(v, "eraser");
            var fe = u(he, 2);
            let ze;
            fe.__click = () => r(v, "line");
            var je = u(fe, 2);
            let Oe;
            je.__click = () => r(v, "rectangle");
            var U = u(je, 2);
            let W;
            U.__click = () => r(v, "circle"),
            o(Q),
            o(A);
            var B = u(A, 2)
              , G = i(B)
              , Ce = i(G);
            o(G);
            var De = u(G, 2);
            Qe(De, 21, () => I, bt, (Be, ne) => {
                var pe = yl();
                let Ue;
                pe.__click = () => r(c, e(ne), !0);
                var tt = i(pe);
                o(pe),
                q( ($e, ht) => {
                    Ue = ye(pe, 1, "size-btn svelte-12bmgzp", null, Ue, {
                        active: e(c) === e(ne)
                    }),
                    se(pe, "aria-label", `Размер кисти ${e(ne) ?? ""}px`),
                    lt(tt, `width: ${$e ?? ""}px; height: ${ht ?? ""}px;`)
                }
                , [ () => Math.min(e(ne), 20), () => Math.min(e(ne), 20)]),
                d(Be, pe)
            }
            ),
            o(De),
            o(B);
            var ve = u(B, 2)
              , be = i(ve);
            be.__click = J;
            var _e = u(be, 2);
            _e.__click = re;
            var Me = u(_e, 2);
            Me.__click = X,
            o(ve),
            o(w);
            var ge = u(w, 2)
              , Te = i(ge);
            Qe(Te, 17, () => C, bt, (Be, ne) => {
                var pe = kl();
                let Ue;
                pe.__click = () => r(h, e(ne), !0),
                q( () => {
                    Ue = ye(pe, 1, "color-btn svelte-12bmgzp", null, Ue, {
                        active: e(h) === e(ne)
                    }),
                    lt(pe, `background-color: ${e(ne) ?? ""};`),
                    se(pe, "aria-label", `Цвет ${e(ne) ?? ""}`)
                }
                ),
                d(Be, pe)
            }
            );
            var Ne = u(Te, 2)
              , Ie = i(Ne);
            Qt(Ie),
            Ge(2),
            o(Ne),
            o(ge);
            var qe = u(ge, 2)
              , Fe = i(qe);
            Fe.__mousedown = ie,
            Fe.__touchstart = ie,
            Fe.__touchmove = O,
            Fe.__touchend = D,
            et(Fe, Be => r(a, Be), () => e(a)),
            o(qe);
            var Xe = u(qe, 2)
              , Je = i(Xe);
            Je.__click = function(...Be) {
                t.onClose?.apply(this, Be)
            }
            ;
            var st = u(Je, 2);
            st.__click = te;
            var ct = i(st);
            {
                var it = Be => {
                    var ne = xl();
                    Ge(),
                    d(Be, ne)
                }
                  , dt = Be => {
                    var ne = Wt("Сохранить");
                    d(Be, ne)
                }
                ;
                M(ct, Be => {
                    n() ? Be(it) : Be(dt, !1)
                }
                )
            }
            o(st),
            o(Xe),
            o(y),
            o(T),
            q( () => {
                xe = ye(le, 1, "tool-btn svelte-12bmgzp", null, xe, {
                    active: e(v) === "brush"
                }),
                Se = ye(he, 1, "tool-btn svelte-12bmgzp", null, Se, {
                    active: e(v) === "eraser"
                }),
                ze = ye(fe, 1, "tool-btn svelte-12bmgzp", null, ze, {
                    active: e(v) === "line"
                }),
                Oe = ye(je, 1, "tool-btn svelte-12bmgzp", null, Oe, {
                    active: e(v) === "rectangle"
                }),
                W = ye(U, 1, "tool-btn svelte-12bmgzp", null, W, {
                    active: e(v) === "circle"
                }),
                de(Ce, `Размер: ${e(c) ?? ""}px`),
                be.disabled = !e(E),
                _e.disabled = !e(F),
                Je.disabled = n(),
                st.disabled = n()
            }
            ),
            Nt(Ie, () => e(h), Be => r(h, Be)),
            d(g, T)
        }
        ;
        M(N, g => {
            t.isOpen && g($)
        }
        )
    }
    d(s, Z),
    Ye()
}
Ze(["mousedown", "click", "touchstart", "touchmove", "touchend"]);
var zl = p('<hr class="comment-divider svelte-61nzs9"/>')
  , Pl = p("<div><!></div> <!>", 1)
  , Ml = p('<div class="comments-loading svelte-61nzs9"><!></div>')
  , Sl = p('<span class="comments-remaining svelte-61nzs9"> </span>')
  , Il = p(" <!>", 1)
  , Tl = p('<button class="comments-load-more svelte-61nzs9"><!></button>')
  , Rl = p('<div class="comments-sort svelte-61nzs9"><select class="comments-sort-select svelte-61nzs9"><option>Популярные</option><option>Сначала новые</option><option>Сначала старые</option></select></div> <div class="post-comments svelte-61nzs9"><!> <!></div>', 1)
  , Dl = p('<div class="post-comments-wrapper svelte-61nzs9"><!></div>');
function jl(s, t) {
    We(t, !0);
    let n = me(t, "canDeleteComments", 3, !1)
      , a = S(rt([...t.comments]))
      , l = S("popular")
      , f = S("popular")
      , v = S(!1)
      , c = S(null)
      , h = S(t.commentsCount > 3)
      , m = S(null)
      , z = S(null);
    ft( () => {
        t.comments.length > 0 && e(a).length === 0 && (r(a, [...t.comments], !0),
        r(h, t.commentsCount > t.comments.length))
    }
    ),
    ft( () => {
        const j = e(l);
        j !== e(f) && e(a).length > 0 && !e(v) && P(j, 10, !0)
    }
    );
    async function P(j, E, F=!1) {
        if (!e(v)) {
            r(v, !0);
            try {
                const ee = F ? void 0 : e(c) ?? void 0
                  , ae = await Tt.getPostComments(t.postId, E, j, ee);
                if (!ae.error && ae.data) {
                    const J = ae.data.comments.map(Ls);
                    if (F)
                        r(a, J, !0);
                    else {
                        const re = new Set(e(a).map(ie => ie.id))
                          , ue = J.filter(ie => !re.has(ie.id));
                        r(a, [...e(a), ...ue], !0)
                    }
                    r(c, ae.data.nextCursor, !0),
                    r(h, ae.data.hasMore, !0),
                    r(f, j, !0)
                }
            } catch {} finally {
                r(v, !1)
            }
        }
    }
    async function _() {
        jt() && (e(v) || !e(h) || await P(e(l), 20))
    }
    async function b(j) {
        r(a, [...e(a), j], !0),
        r(m, j.id, !0),
        await Pa();
        const E = e(z)?.querySelector(`[data-comment-id="${j.id}"]`);
        E && E.scrollIntoView({
            behavior: "smooth",
            block: "center"
        }),
        setTimeout( () => {
            r(m, null)
        }
        , 2500)
    }
    var C = {
        addComment: b
    }
      , I = Dl()
      , R = i(I);
    {
        var L = j => {
            var E = Rl()
              , F = Pe(E)
              , ee = i(F)
              , ae = i(ee);
            ae.value = ae.__value = "popular";
            var J = u(ae);
            J.value = J.__value = "newest";
            var re = u(J);
            re.value = re.__value = "oldest",
            o(ee),
            o(F);
            var ue = u(F, 2)
              , ie = i(ue);
            Qe(ie, 19, () => e(a), O => O.id, (O, D, H) => {
                var X = Pl()
                  , te = Pe(X)
                  , ke = i(te);
                {
                    let K = V( () => e(m) === e(D).id);
                    Uo(ke, {
                        get comment() {
                            return e(D)
                        },
                        get canDelete() {
                            return n()
                        },
                        get isHighlighted() {
                            return e(K)
                        },
                        get onReport() {
                            return t.onReportComment
                        }
                    })
                }
                o(te);
                var Y = u(te, 2);
                {
                    var we = K => {
                        var Z = zl();
                        d(K, Z)
                    }
                    ;
                    M(Y, K => {
                        e(H) < e(a).length - 1 && K(we)
                    }
                    )
                }
                q( () => se(te, "data-comment-id", e(D).id)),
                d(O, X)
            }
            );
            var ce = u(ie, 2);
            {
                var oe = O => {
                    var D = He()
                      , H = Pe(D);
                    {
                        var X = ke => {
                            var Y = Ml()
                              , we = i(Y);
                            ha(we, {}),
                            o(Y),
                            d(ke, Y)
                        }
                          , te = ke => {
                            const Y = V( () => t.commentsCount - e(a).length)
                              , we = V( () => Math.min(e(Y), 20));
                            var K = Tl();
                            K.__click = _;
                            var Z = i(K);
                            {
                                var N = g => {
                                    var T = Il()
                                      , y = Pe(T)
                                      , k = u(y);
                                    {
                                        var x = w => {
                                            var A = Sl()
                                              , Q = i(A);
                                            o(A),
                                            q( () => de(Q, `(всего ${e(Y) ?? ""})`)),
                                            d(w, A)
                                        }
                                        ;
                                        M(k, w => {
                                            e(Y) > 20 && w(x)
                                        }
                                        )
                                    }
                                    q( () => de(y, `Показать ещё ${e(we) ?? ""}
              ${e(we) === 1 ? "комментарий" : e(we) < 5 ? "комментария" : "комментариев"} `)),
                                    d(g, T)
                                }
                                  , $ = g => {
                                    var T = Wt("Показать ещё комментарии");
                                    d(g, T)
                                }
                                ;
                                M(Z, g => {
                                    e(Y) > 0 ? g(N) : g($, !1)
                                }
                                )
                            }
                            o(K),
                            d(ke, K)
                        }
                        ;
                        M(H, ke => {
                            e(v) ? ke(X) : ke(te, !1)
                        }
                        )
                    }
                    d(O, D)
                }
                ;
                M(ce, O => {
                    e(h) && O(oe)
                }
                )
            }
            o(ue),
            q( () => ee.disabled = e(v)),
            ds(ee, () => e(l), O => r(l, O)),
            d(j, E)
        }
        ;
        M(R, j => {
            e(a).length > 0 && j(L)
        }
        )
    }
    return o(I),
    et(I, j => r(z, j), () => e(z)),
    d(s, I),
    Ye(C)
}
Ze(["click"]);
var ql = p('<div class="post-modal__loading svelte-1wzwwt5"><!></div>')
  , Al = p('<div class="post-modal__error svelte-1wzwwt5"><p class="svelte-1wzwwt5"> </p> <button class="post-modal__retry svelte-1wzwwt5">Попробовать снова</button></div>')
  , Ll = p('<span class="post-modal__verified svelte-1wzwwt5"><!></span>')
  , Ul = p('<button class="post-modal__dropdown-item danger svelte-1wzwwt5"><!> <span class="svelte-1wzwwt5">Удалить</span></button>')
  , Ol = p('<button class="post-modal__dropdown-item danger svelte-1wzwwt5"><!> <span class="svelte-1wzwwt5">Пожаловаться</span></button>')
  , Bl = p('<div class="post-modal__dropdown svelte-1wzwwt5" role="menu" tabindex="-1"><button class="post-modal__dropdown-item svelte-1wzwwt5"><!> <span class="svelte-1wzwwt5">Поделиться</span></button> <!></div>')
  , El = p('<div class="post-modal__text svelte-1wzwwt5"><!></div>')
  , Hl = p('<div class="post-modal__original svelte-1wzwwt5"><!></div>')
  , Nl = p('<div class="post-modal__gallery svelte-1wzwwt5"><!></div>')
  , Fl = p('<div class="post-modal__comments-loading svelte-1wzwwt5"><!></div>')
  , Vl = p('<div class="post-modal__comments svelte-1wzwwt5"><!></div>')
  , Wl = p('<div class="post-modal__input-wrapper svelte-1wzwwt5"><!></div>')
  , Yl = p('<div class="post-modal__scroll svelte-1wzwwt5"><div class="post-modal__header svelte-1wzwwt5"><div class="post-modal__header-left svelte-1wzwwt5"><div><!></div> <div class="post-modal__meta svelte-1wzwwt5"><div class="post-modal__author-row svelte-1wzwwt5"><span> </span> <!> <!></div> <!></div></div> <div class="post-modal__menu svelte-1wzwwt5"><button class="post-modal__menu-btn svelte-1wzwwt5" aria-label="Меню поста"><!></button> <!></div></div> <!> <!> <!> <div class="post-modal__actions svelte-1wzwwt5"><div class="post-modal__actions-left svelte-1wzwwt5"><button><!> <span class="svelte-1wzwwt5"> </span></button> <button class="post-modal__action svelte-1wzwwt5"><!> <span class="svelte-1wzwwt5"> </span></button> <button><!> <span class="svelte-1wzwwt5"> </span></button></div> <div class="post-modal__views svelte-1wzwwt5"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-1wzwwt5"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z" class="svelte-1wzwwt5"></path><circle cx="12" cy="12" r="3" class="svelte-1wzwwt5"></circle></svg> <span class="svelte-1wzwwt5"> </span></div></div> <!></div> <!>', 1)
  , Xl = p('<div class="post-modal-backdrop svelte-1wzwwt5"><div><button class="post-modal-close svelte-1wzwwt5" aria-label="Закрыть"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" class="svelte-1wzwwt5"><path d="M18 6L6 18M6 6l12 12" class="svelte-1wzwwt5"></path></svg></button> <div class="post-modal svelte-1wzwwt5"><div class="post-modal__swipe-indicator svelte-1wzwwt5"></div> <!></div></div></div>')
  , Zl = p("<!> <!>", 1);
function Kl(s, t) {
    We(t, !0);
    const n = () => Ke(e(b), "$postStateStore", l)
      , a = () => Ke(ma, "$page", l)
      , [l,f] = Ct();
    let v = me(t, "initialPost", 3, null)
      , c = S(null)
      , h = S(!1)
      , m = S("")
      , z = S(null)
      , P = S(null)
      , _ = S(!1)
      , b = V( () => vt.getPostStore(t.postId))
      , C = V( () => n()?.isLiked ?? e(c)?.isLiked ?? !1)
      , I = V( () => n()?.likesCount ?? e(c)?.likesCount ?? 0)
      , R = V( () => n()?.isReposted ?? e(c)?.isReposted ?? !1)
      , L = V( () => n()?.repostsCount ?? e(c)?.repostsCount ?? 0)
      , j = V( () => n()?.commentsCount ?? e(c)?.commentsCount ?? 0)
      , E = S(!1)
      , F = Promise.resolve()
      , ee = S(!1)
      , ae = S(!1)
      , J = S(null)
      , re = S(0)
      , ue = S(0)
      , ie = S(!1)
      , ce = S(0);
    const oe = 20;
    let O = S(0);
    ft( () => {
        t.isOpen && t.postId && (v() ? (r(c, v()),
        r(E, !1),
        vt.set(t.postId, {
            isLiked: v().isLiked,
            likesCount: v().likesCount,
            isReposted: v().isReposted,
            repostsCount: v().repostsCount,
            commentsCount: v().commentsCount
        }),
        ut.recordView(t.postId),
        r(ae, !0),
        H()) : D())
    }
    ),
    ft( () => {
        if (!t.isOpen)
            return;
        const U = window.scrollY;
        return r(O, U, !0),
        document.body.style.overflow = "hidden",
        document.body.style.position = "fixed",
        document.body.style.width = "100%",
        document.body.style.top = `-${U}px`,
        () => {
            document.body.style.overflow = "",
            document.body.style.position = "",
            document.body.style.width = "",
            document.body.style.top = "",
            window.scrollTo(0, U),
            r(ce, 0),
            r(ie, !1)
        }
    }
    );
    async function D() {
        r(h, !0),
        r(m, "");
        const U = await ut.getPost(t.postId);
        if (U.error) {
            r(m, U.error, !0),
            r(h, !1);
            return
        }
        U.data && (r(c, U.data, !0),
        r(E, !1),
        vt.set(t.postId, {
            isLiked: U.data.isLiked,
            likesCount: U.data.likesCount,
            isReposted: U.data.isReposted,
            repostsCount: U.data.repostsCount,
            commentsCount: U.data.commentsCount
        }),
        ut.recordView(t.postId)),
        r(h, !1)
    }
    async function H() {
        const U = await ut.getPost(t.postId);
        U.data?.comments && e(c) && r(c, {
            ...e(c),
            comments: U.data.comments
        }, !0),
        r(ae, !1)
    }
    function X() {
        r(c, null),
        r(m, ""),
        r(_, !1),
        t.onClose()
    }
    function te(U) {
        U.stopPropagation(),
        U.target === U.currentTarget && X()
    }
    function ke(U) {
        U.key === "Escape" && X()
    }
    function Y(U) {
        r(re, U.touches[0].clientY, !0),
        r(ue, U.touches[0].clientY, !0),
        e(J) && e(J).scrollTop <= 0 && r(ie, !0)
    }
    function we(U) {
        r(ue, U.touches[0].clientY, !0);
        const W = e(ue) - e(re);
        if (e(J) && e(J).scrollTop > 0) {
            r(ie, !1),
            r(ce, 0);
            return
        }
        e(J) && e(J).scrollTop <= 0 && W > 0 && U.preventDefault(),
        e(ie) && (W > 0 ? r(ce, W * .6) : r(ce, 0))
    }
    function K() {
        if (!e(ie)) {
            r(ce, 0);
            return
        }
        r(ie, !1),
        e(ce) > oe ? X() : r(ce, 0)
    }
    ft( () => {
        if (e(J))
            return e(J).addEventListener("touchstart", Y, {
                passive: !0
            }),
            e(J).addEventListener("touchmove", we, {
                passive: !1
            }),
            e(J).addEventListener("touchend", K, {
                passive: !0
            }),
            () => {
                e(J).removeEventListener("touchstart", Y),
                e(J).removeEventListener("touchmove", we),
                e(J).removeEventListener("touchend", K)
            }
    }
    );
    function Z() {
        if (!jt() || !e(c))
            return;
        r(E, !0);
        const U = !e(C);
        vt.toggleLike(t.postId, U),
        F = F.then(async () => {
            (U ? await ut.likePost(t.postId) : await ut.unlikePost(t.postId)).success || vt.toggleLike(t.postId, !U)
        }
        )
    }
    function N() {
        e(P)?.focus()
    }
    function $(U) {
        e(z)?.addComment(U),
        vt.incrementComments(t.postId)
    }
    async function g(U) {
        U.stopPropagation(),
        U.preventDefault();
        const W = e(c)?.author.username;
        if (W) {
            const B = a().url.pathname
              , G = `/${W}`;
            if (B === G || B.startsWith(`/${W}/`)) {
                X(),
                window.scrollTo({
                    top: 0,
                    behavior: "smooth"
                });
                return
            }
            r(c, null),
            r(m, ""),
            r(_, !1),
            await Ft(G)
        }
    }
    function T() {
        !jt() || !e(c) || e(c).isOwner || (e(R) ? y() : r(ee, !0))
    }
    async function y() {
        if (!e(c))
            return;
        vt.toggleRepost(t.postId, !1),
        (await ut.unrepostPost(t.postId)).success || vt.toggleRepost(t.postId, !0)
    }
    function k(U) {
        vt.toggleRepost(t.postId, !0),
        r(ee, !1)
    }
    function x(U) {
        U.stopPropagation(),
        r(_, !e(_))
    }
    function w() {
        r(_, !1)
    }
    function A(U) {
        if (U.stopPropagation(),
        e(c)) {
            const W = `${window.location.origin}/@${e(c).author.username}/post/${e(c).id}`;
            navigator.clipboard.writeText(W),
            alert("Ссылка скопирована!")
        }
        r(_, !1)
    }
    function Q(U) {
        U.stopPropagation(),
        t.onReport?.(),
        r(_, !1)
    }
    async function le(U) {
        if (U.stopPropagation(),
        !e(c))
            return;
        (await ut.deletePost(e(c).id)).success && (kr.removePost(e(c).id),
        xr.removePost(e(c).id),
        X()),
        r(_, !1)
    }
    function xe() {
        return e(c) ? {
            id: e(c).id,
            content: e(c).content,
            author: {
                id: e(c).author.id,
                username: e(c).author.username || null,
                displayName: e(c).author.displayName,
                avatar: e(c).author.avatar || null,
                verified: e(c).author.verified,
                pin: e(c).author.pin || null
            },
            createdAt: e(c).createdAt
        } : null
    }
    function he(U) {
        return U ? U.map(W => ({
            id: W.id,
            author: W.author.displayName,
            authorId: W.author.id,
            username: W.author.username,
            avatar: W.author.avatar || "",
            verified: W.author.verified,
            pin: W.author.pin || null,
            content: W.content,
            time: W.createdAt,
            createdAt: W.createdAt,
            likes: W.likesCount,
            repliesCount: W.repliesCount,
            isLiked: W.isLiked,
            attachments: W.attachments?.map(B => ({
                id: B.id,
                type: B.type,
                url: B.url,
                thumbnailUrl: B.thumbnailUrl || void 0,
                width: B.width || void 0,
                height: B.height || void 0,
                duration: B.duration || void 0
            })),
            replies: W.replies?.map(B => ({
                id: B.id,
                author: B.author.displayName,
                authorId: B.author.id,
                username: B.author.username,
                avatar: B.author.avatar || "",
                verified: B.author.verified,
                pin: B.author.pin || null,
                content: B.content,
                time: B.createdAt,
                createdAt: B.createdAt,
                likes: B.likesCount,
                isLiked: B.isLiked,
                replyTo: B.replyTo || null,
                attachments: B.attachments?.map(G => ({
                    id: G.id,
                    type: G.type,
                    url: G.url,
                    thumbnailUrl: G.thumbnailUrl || void 0,
                    width: G.width || void 0,
                    height: G.height || void 0,
                    duration: G.duration || void 0
                }))
            })) || []
        })) : []
    }
    var Se = Zl();
    mt("keydown", Ia, ke);
    var fe = Pe(Se);
    {
        var ze = U => {
            var W = Xl();
            W.__click = te;
            var B = i(W);
            let G;
            B.__click = ge => ge.stopPropagation();
            let Ce;
            var De = i(B);
            De.__click = X;
            var ve = u(De, 2)
              , be = u(i(ve), 2);
            {
                var _e = ge => {
                    var Te = ql()
                      , Ne = i(Te);
                    ha(Ne, {}),
                    o(Te),
                    d(ge, Te)
                }
                  , Me = ge => {
                    var Te = He()
                      , Ne = Pe(Te);
                    {
                        var Ie = Fe => {
                            var Xe = Al()
                              , Je = i(Xe)
                              , st = i(Je, !0);
                            o(Je);
                            var ct = u(Je, 2);
                            ct.__click = D,
                            o(Xe),
                            q( () => de(st, e(m))),
                            d(Fe, Xe)
                        }
                          , qe = Fe => {
                            var Xe = He()
                              , Je = Pe(Xe);
                            {
                                var st = ct => {
                                    var it = Yl()
                                      , dt = Pe(it)
                                      , Be = i(dt)
                                      , ne = i(Be)
                                      , pe = i(ne);
                                    let Ue;
                                    pe.__click = g;
                                    var tt = i(pe);
                                    {
                                        let Le = V( () => e(c).author.avatar || "");
                                        kt(tt, {
                                            get avatar() {
                                                return e(Le)
                                            },
                                            get name() {
                                                return e(c).author.displayName
                                            },
                                            size: 44
                                        })
                                    }
                                    o(pe);
                                    var $e = u(pe, 2)
                                      , ht = i($e)
                                      , pt = i(ht);
                                    let yt;
                                    pt.__click = g;
                                    var at = i(pt, !0);
                                    o(pt);
                                    var _t = u(pt, 2);
                                    {
                                        var qt = Le => {
                                            var Ee = Ll()
                                              , nt = i(Ee);
                                            mr(nt, {
                                                size: 16
                                            }),
                                            o(Ee),
                                            d(Le, Ee)
                                        }
                                        ;
                                        M(_t, Le => {
                                            e(c).author.verified && Le(qt)
                                        }
                                        )
                                    }
                                    var At = u(_t, 2);
                                    {
                                        var Bt = Le => {
                                            na(Le, {
                                                get pin() {
                                                    return e(c).author.pin
                                                }
                                            })
                                        }
                                        ;
                                        M(At, Le => {
                                            e(c).author.pin && Le(Bt)
                                        }
                                        )
                                    }
                                    o(ht);
                                    var gt = u(ht, 2);
                                    oa(gt, {
                                        get date() {
                                            return e(c).createdAt
                                        },
                                        class: "post-modal__time"
                                    }),
                                    o($e),
                                    o(ne);
                                    var ot = u(ne, 2)
                                      , zt = i(ot);
                                    zt.__click = x;
                                    var ea = i(zt);
                                    Da(ea, {}),
                                    o(zt);
                                    var Rr = u(zt, 2);
                                    {
                                        var Dr = Le => {
                                            var Ee = Bl();
                                            Ee.__click = St => St.stopPropagation();
                                            var nt = i(Ee);
                                            nt.__click = A;
                                            var Et = i(nt);
                                            gr(Et, {
                                                size: 16
                                            }),
                                            Ge(2),
                                            o(nt);
                                            var ka = u(nt, 2);
                                            {
                                                var Wr = St => {
                                                    var Pt = Ul();
                                                    Pt.__click = le;
                                                    var xa = i(Pt);
                                                    qa(xa, {
                                                        size: 16
                                                    }),
                                                    Ge(2),
                                                    o(Pt),
                                                    d(St, Pt)
                                                }
                                                  , Yr = St => {
                                                    var Pt = Ol();
                                                    Pt.__click = Q;
                                                    var xa = i(Pt);
                                                    ja(xa, {
                                                        size: 16
                                                    }),
                                                    Ge(2),
                                                    o(Pt),
                                                    d(St, Pt)
                                                }
                                                ;
                                                M(ka, St => {
                                                    e(c).isOwner ? St(Wr) : St(Yr, !1)
                                                }
                                                )
                                            }
                                            o(Ee),
                                            Yt(Ee, (St, Pt) => pa?.(St, Pt), () => w),
                                            d(Le, Ee)
                                        }
                                        ;
                                        M(Rr, Le => {
                                            e(_) && Le(Dr)
                                        }
                                        )
                                    }
                                    o(ot),
                                    o(Be);
                                    var Ua = u(Be, 2);
                                    {
                                        var jr = Le => {
                                            var Ee = El()
                                              , nt = i(Ee);
                                            Ir(nt, {
                                                get content() {
                                                    return e(c).content
                                                }
                                            }),
                                            o(Ee),
                                            d(Le, Ee)
                                        }
                                        ;
                                        M(Ua, Le => {
                                            e(c).content && Le(jr)
                                        }
                                        )
                                    }
                                    var Oa = u(Ua, 2);
                                    {
                                        var qr = Le => {
                                            var Ee = Hl()
                                              , nt = i(Ee);
                                            yr(nt, {
                                                get post() {
                                                    return e(c).originalPost
                                                }
                                            }),
                                            o(Ee),
                                            d(Le, Ee)
                                        }
                                        ;
                                        M(Oa, Le => {
                                            e(c).originalPost && Le(qr)
                                        }
                                        )
                                    }
                                    var Ba = u(Oa, 2);
                                    {
                                        var Ar = Le => {
                                            var Ee = Nl()
                                              , nt = i(Ee);
                                            Aa(nt, {
                                                get attachments() {
                                                    return e(c).attachments
                                                }
                                            }),
                                            o(Ee),
                                            d(Le, Ee)
                                        }
                                        ;
                                        M(Ba, Le => {
                                            e(c).attachments && e(c).attachments.length > 0 && Le(Ar)
                                        }
                                        )
                                    }
                                    var ba = u(Ba, 2)
                                      , ya = i(ba)
                                      , ta = i(ya);
                                    let Ea;
                                    ta.__click = Z;
                                    var Ha = i(ta);
                                    Ra(Ha, {
                                        size: 20,
                                        get filled() {
                                            return e(C)
                                        }
                                    });
                                    var Na = u(Ha, 2)
                                      , Lr = i(Na, !0);
                                    o(Na),
                                    o(ta);
                                    var ia = u(ta, 2);
                                    ia.__click = N;
                                    var Fa = i(ia);
                                    hr(Fa, {
                                        size: 20
                                    });
                                    var Va = u(Fa, 2)
                                      , Ur = i(Va, !0);
                                    o(Va),
                                    o(ia);
                                    var Xt = u(ia, 2);
                                    let Wa;
                                    Xt.__click = T;
                                    var Ya = i(Xt);
                                    _a(Ya, {
                                        size: 20
                                    });
                                    var Xa = u(Ya, 2)
                                      , Or = i(Xa, !0);
                                    o(Xa),
                                    o(Xt),
                                    o(ya);
                                    var Za = u(ya, 2)
                                      , Ka = u(i(Za), 2)
                                      , Br = i(Ka, !0);
                                    o(Ka),
                                    o(Za),
                                    o(ba);
                                    var Er = u(ba, 2);
                                    {
                                        var Hr = Le => {
                                            var Ee = Fl()
                                              , nt = i(Ee);
                                            ha(nt, {}),
                                            o(Ee),
                                            d(Le, Ee)
                                        }
                                          , Nr = Le => {
                                            var Ee = Vl()
                                              , nt = i(Ee);
                                            {
                                                let Et = V( () => he(e(c).comments));
                                                et(jl(nt, {
                                                    get postId() {
                                                        return e(c).id
                                                    },
                                                    get comments() {
                                                        return e(Et)
                                                    },
                                                    get commentsCount() {
                                                        return e(j)
                                                    },
                                                    get canDeleteComments() {
                                                        return e(c).isOwner
                                                    }
                                                }), ka => r(z, ka, !0), () => e(z))
                                            }
                                            o(Ee),
                                            d(Le, Ee)
                                        }
                                        ;
                                        M(Er, Le => {
                                            e(ae) ? Le(Hr) : Le(Nr, !1)
                                        }
                                        )
                                    }
                                    o(dt),
                                    et(dt, Le => r(J, Le), () => e(J));
                                    var Fr = u(dt, 2);
                                    {
                                        var Vr = Le => {
                                            var Ee = Wl()
                                              , nt = i(Ee);
                                            et(Cr(nt, {
                                                get postId() {
                                                    return e(c).id
                                                },
                                                onCommentAdded: $
                                            }), Et => r(P, Et, !0), () => e(P)),
                                            o(Ee),
                                            d(Le, Ee)
                                        }
                                        ;
                                        M(Fr, Le => {
                                            e(ae) || Le(Vr)
                                        }
                                        )
                                    }
                                    q( (Le, Ee, nt, Et) => {
                                        Ue = ye(pe, 1, "post-modal__avatar svelte-1wzwwt5", null, Ue, {
                                            clickable: !!e(c).author.username
                                        }),
                                        yt = ye(pt, 1, "post-modal__author svelte-1wzwwt5", null, yt, {
                                            clickable: !!e(c).author.username
                                        }),
                                        de(at, e(c).author.displayName),
                                        Ea = ye(ta, 1, "post-modal__action like svelte-1wzwwt5", null, Ea, {
                                            liked: e(C),
                                            animated: e(E)
                                        }),
                                        de(Lr, Le),
                                        de(Ur, Ee),
                                        Wa = ye(Xt, 1, "post-modal__action repost svelte-1wzwwt5", null, Wa, {
                                            reposted: e(R),
                                            disabled: e(c).isOwner
                                        }),
                                        Xt.disabled = e(c).isOwner,
                                        se(Xt, "title", e(c).isOwner ? "Нельзя репостнуть свой пост" : e(R) ? "Убрать репост" : "Репост"),
                                        de(Or, nt),
                                        de(Br, Et)
                                    }
                                    , [ () => Rt(e(I)), () => Rt(e(j)), () => Rt(e(L)), () => Rt(e(c).viewsCount)]),
                                    d(ct, it)
                                }
                                ;
                                M(Je, ct => {
                                    e(c) && ct(st)
                                }
                                , !0)
                            }
                            d(Fe, Xe)
                        }
                        ;
                        M(Ne, Fe => {
                            e(m) ? Fe(Ie) : Fe(qe, !1)
                        }
                        , !0)
                    }
                    d(ge, Te)
                }
                ;
                M(be, ge => {
                    e(h) ? ge(_e) : ge(Me, !1)
                }
                )
            }
            o(ve),
            o(B),
            o(W),
            q(ge => {
                G = ye(B, 1, "post-modal-container svelte-1wzwwt5", null, G, {
                    swiping: e(ie)
                }),
                Ce = lt(B, "", Ce, ge)
            }
            , [ () => ({
                transform: e(ce) > 0 ? `translateY(${e(ce)}px)` : void 0,
                opacity: e(ce) > 0 ? Math.max(.5, 1 - e(ce) / 300) : void 0
            })]),
            d(U, W)
        }
        ;
        M(fe, U => {
            t.isOpen && U(ze)
        }
        )
    }
    var je = u(fe, 2);
    {
        var Oe = U => {
            {
                let W = V(xe);
                zr(U, {
                    get isOpen() {
                        return e(ee)
                    },
                    get originalPost() {
                        return e(W)
                    },
                    onClose: () => r(ee, !1),
                    onRepost: k
                })
            }
        }
        ;
        M(je, U => {
            e(c) && xe() && U(Oe)
        }
        )
    }
    d(s, Se),
    Ye(),
    f()
}
Ze(["click"]);
Ze(["input", "keydown"]);
export {kt as A, vc as C, Tr as D, mc as E, Ts as I, ha as L, cc as M, Pr as N, ra as P, hc as R, lc as S, oa as T, La as V, Kl as a, fc as b, Yt as c, ur as d, gc as e, Rt as f, oc as g, $a as h, _r as i, ic as j, Xs as k, kr as l, js as m, dc as n, wa as o, ut as p, Lt as q, mr as r, rr as s, tr as t, Ht as u, na as v, uc as w, Dt as x, xr as y, mi as z};
import {aQ as Ue, o as Fe, s as A, g as T, k as I, aH as te, aX as vt, aY as Ge, aZ as wt} from "./DsUZB3l6.js";
class Ae {
    constructor(t, n) {
        this.status = t,
        typeof n == "string" ? this.body = {
            message: n
        } : n ? this.body = n : this.body = {
            message: `Error: ${t}`
        }
    }
    toString() {
        return JSON.stringify(this.body)
    }
}
class Te {
    constructor(t, n) {
        this.status = t,
        this.location = n
    }
}
class Ie extends Error {
    constructor(t, n, a) {
        super(a),
        this.status = t,
        this.text = n
    }
}
new URL("sveltekit-internal://");
function yt(e, t) {
    return e === "/" || t === "ignore" ? e : t === "never" ? e.endsWith("/") ? e.slice(0, -1) : e : t === "always" && !e.endsWith("/") ? e + "/" : e
}
function bt(e) {
    return e.split("%25").map(decodeURI).join("%25")
}
function kt(e) {
    for (const t in e)
        e[t] = decodeURIComponent(e[t]);
    return e
}
function me({href: e}) {
    return e.split("#")[0]
}
function Et(...e) {
    let t = 5381;
    for (const n of e)
        if (typeof n == "string") {
            let a = n.length;
            for (; a; )
                t = t * 33 ^ n.charCodeAt(--a)
        } else if (ArrayBuffer.isView(n)) {
            const a = new Uint8Array(n.buffer,n.byteOffset,n.byteLength);
            let r = a.length;
            for (; r; )
                t = t * 33 ^ a[--r]
        } else
            throw new TypeError("value must be a string or TypedArray");
    return (t >>> 0).toString(36)
}
new TextEncoder;
new TextDecoder;
function St(e) {
    const t = atob(e)
      , n = new Uint8Array(t.length);
    for (let a = 0; a < t.length; a++)
        n[a] = t.charCodeAt(a);
    return n
}
const Rt = window.fetch;
window.fetch = (e, t) => ((e instanceof Request ? e.method : t?.method || "GET") !== "GET" && Y.delete(Pe(e)),
Rt(e, t));
const Y = new Map;
function xt(e, t) {
    const n = Pe(e, t)
      , a = document.querySelector(n);
    if (a?.textContent) {
        a.remove();
        let {body: r, ...s} = JSON.parse(a.textContent);
        const o = a.getAttribute("data-ttl");
        return o && Y.set(n, {
            body: r,
            init: s,
            ttl: 1e3 * Number(o)
        }),
        a.getAttribute("data-b64") !== null && (r = St(r)),
        Promise.resolve(new Response(r,s))
    }
    return window.fetch(e, t)
}
function Lt(e, t, n) {
    if (Y.size > 0) {
        const a = Pe(e, n)
          , r = Y.get(a);
        if (r) {
            if (performance.now() < r.ttl && ["default", "force-cache", "only-if-cached", void 0].includes(n?.cache))
                return new Response(r.body,r.init);
            Y.delete(a)
        }
    }
    return window.fetch(t, n)
}
function Pe(e, t) {
    let a = `script[data-sveltekit-fetched][data-url=${JSON.stringify(einstanceof Request ? e.url : e)}]`;
    if (t?.headers || t?.body) {
        const r = [];
        t.headers && r.push([...new Headers(t.headers)].join(",")),
        t.body && (typeof t.body == "string" || ArrayBuffer.isView(t.body)) && r.push(t.body),
        a += `[data-hash="${Et(...r)}"]`
    }
    return a
}
const Ut = /^(\[)?(\.\.\.)?(\w+)(?:=(\w+))?(\])?$/;
function At(e) {
    const t = [];
    return {
        pattern: e === "/" ? /^\/$/ : new RegExp(`^${It(e).map(a => {
            const r = /^\[\.\.\.(\w+)(?:=(\w+))?\]$/.exec(a);
            if (r)
                return t.push({
                    name: r[1],
                    matcher: r[2],
                    optional: !1,
                    rest: !0,
                    chained: !0
                }),
                "(?:/([^]*))?";
            const s = /^\[\[(\w+)(?:=(\w+))?\]\]$/.exec(a);
            if (s)
                return t.push({
                    name: s[1],
                    matcher: s[2],
                    optional: !0,
                    rest: !1,
                    chained: !0
                }),
                "(?:/([^/]+))?";
            if (!a)
                return;
            const o = a.split(/\[(.+?)\](?!\])/);
            return "/" + o.map( (c, l) => {
                if (l % 2) {
                    if (c.startsWith("x+"))
                        return ve(String.fromCharCode(parseInt(c.slice(2), 16)));
                    if (c.startsWith("u+"))
                        return ve(String.fromCharCode(...c.slice(2).split("-").map(m => parseInt(m, 16))));
                    const f = Ut.exec(c)
                      , [,h,v,u,g] = f;
                    return t.push({
                        name: u,
                        matcher: g,
                        optional: !!h,
                        rest: !!v,
                        chained: v ? l === 1 && o[0] === "" : !1
                    }),
                    v ? "([^]*?)" : h ? "([^/]*)?" : "([^/]+?)"
                }
                return ve(c)
            }
            ).join("")
        }
        ).join("")}/?$`),
        params: t
    }
}
function Tt(e) {
    return e !== "" && !/^\([^)]+\)$/.test(e)
}
function It(e) {
    return e.slice(1).split("/").filter(Tt)
}
function Pt(e, t, n) {
    const a = {}
      , r = e.slice(1)
      , s = r.filter(i => i !== void 0);
    let o = 0;
    for (let i = 0; i < t.length; i += 1) {
        const c = t[i];
        let l = r[i - o];
        if (c.chained && c.rest && o && (l = r.slice(i - o, i + 1).filter(f => f).join("/"),
        o = 0),
        l === void 0) {
            c.rest && (a[c.name] = "");
            continue
        }
        if (!c.matcher || n[c.matcher](l)) {
            a[c.name] = l;
            const f = t[i + 1]
              , h = r[i + 1];
            f && !f.rest && f.optional && h && c.chained && (o = 0),
            !f && !h && Object.keys(a).length === s.length && (o = 0);
            continue
        }
        if (c.optional && c.chained) {
            o++;
            continue
        }
        return
    }
    if (!o)
        return a
}
function ve(e) {
    return e.normalize().replace(/[[\]]/g, "\\$&").replace(/%/g, "%25").replace(/\//g, "%2[Ff]").replace(/\?/g, "%3[Ff]").replace(/#/g, "%23").replace(/[.*+?^${}()|\\]/g, "\\$&")
}
function Ot({nodes: e, server_loads: t, dictionary: n, matchers: a}) {
    const r = new Set(t);
    return Object.entries(n).map( ([i,[c,l,f]]) => {
        const {pattern: h, params: v} = At(i)
          , u = {
            id: i,
            exec: g => {
                const m = h.exec(g);
                if (m)
                    return Pt(m, v, a)
            }
            ,
            errors: [1, ...f || []].map(g => e[g]),
            layouts: [0, ...l || []].map(o),
            leaf: s(c)
        };
        return u.errors.length = u.layouts.length = Math.max(u.errors.length, u.layouts.length),
        u
    }
    );
    function s(i) {
        const c = i < 0;
        return c && (i = ~i),
        [c, e[i]]
    }
    function o(i) {
        return i === void 0 ? i : [r.has(i), e[i]]
    }
}
function Ze(e, t=JSON.parse) {
    try {
        return t(sessionStorage[e])
    } catch {}
}
function We(e, t, n=JSON.stringify) {
    const a = n(t);
    try {
        sessionStorage[e] = a
    } catch {}
}
const L = globalThis.__sveltekit_1mox9z0?.base ?? ""
  , $t = globalThis.__sveltekit_1mox9z0?.assets ?? L ?? ""
  , Ct = "1770429099272"
  , et = "sveltekit:snapshot"
  , tt = "sveltekit:scroll"
  , nt = "sveltekit:states"
  , jt = "sveltekit:pageurl"
  , z = "sveltekit:history"
  , F = "sveltekit:navigation"
  , N = {
    tap: 1,
    hover: 2,
    viewport: 3,
    eager: 4,
    off: -1,
    false: -1
}
  , de = location.origin;
function Oe(e) {
    if (e instanceof URL)
        return e;
    let t = document.baseURI;
    if (!t) {
        const n = document.getElementsByTagName("base");
        t = n.length ? n[0].href : document.URL
    }
    return new URL(e,t)
}
function he() {
    return {
        x: pageXOffset,
        y: pageYOffset
    }
}
function V(e, t) {
    return e.getAttribute(`data-sveltekit-${t}`)
}
const He = {
    ...N,
    "": N.hover
};
function at(e) {
    let t = e.assignedSlot ?? e.parentNode;
    return t?.nodeType === 11 && (t = t.host),
    t
}
function rt(e, t) {
    for (; e && e !== t; ) {
        if (e.nodeName.toUpperCase() === "A" && e.hasAttribute("href"))
            return e;
        e = at(e)
    }
}
function ke(e, t, n) {
    let a;
    try {
        if (a = new URL(e instanceof SVGAElement ? e.href.baseVal : e.href,document.baseURI),
        n && a.hash.match(/^#[^/]/)) {
            const i = location.hash.split("#")[1] || "/";
            a.hash = `#${i}${a.hash}`
        }
    } catch {}
    const r = e instanceof SVGAElement ? e.target.baseVal : e.target
      , s = !a || !!r || pe(a, t, n) || (e.getAttribute("rel") || "").split(/\s+/).includes("external")
      , o = a?.origin === de && e.hasAttribute("download");
    return {
        url: a,
        external: s,
        target: r,
        download: o
    }
}
function ne(e) {
    let t = null
      , n = null
      , a = null
      , r = null
      , s = null
      , o = null
      , i = e;
    for (; i && i !== document.documentElement; )
        a === null && (a = V(i, "preload-code")),
        r === null && (r = V(i, "preload-data")),
        t === null && (t = V(i, "keepfocus")),
        n === null && (n = V(i, "noscroll")),
        s === null && (s = V(i, "reload")),
        o === null && (o = V(i, "replacestate")),
        i = at(i);
    function c(l) {
        switch (l) {
        case "":
        case "true":
            return !0;
        case "off":
        case "false":
            return !1;
        default:
            return
        }
    }
    return {
        preload_code: He[a ?? "off"],
        preload_data: He[r ?? "off"],
        keepfocus: c(t),
        noscroll: c(n),
        reload: c(s),
        replace_state: c(o)
    }
}
function Je(e) {
    const t = Ue(e);
    let n = !0;
    function a() {
        n = !0,
        t.update(o => o)
    }
    function r(o) {
        n = !1,
        t.set(o)
    }
    function s(o) {
        let i;
        return t.subscribe(c => {
            (i === void 0 || n && c !== i) && o(i = c)
        }
        )
    }
    return {
        notify: a,
        set: r,
        subscribe: s
    }
}
const ot = {
    v: () => {}
};
function Nt() {
    const {set: e, subscribe: t} = Ue(!1);
    let n;
    async function a() {
        clearTimeout(n);
        try {
            const r = await fetch(`${$t}/_app/version.json`, {
                headers: {
                    pragma: "no-cache",
                    "cache-control": "no-cache"
                }
            });
            if (!r.ok)
                return !1;
            const o = (await r.json()).version !== Ct;
            return o && (e(!0),
            ot.v(),
            clearTimeout(n)),
            o
        } catch {
            return !1
        }
    }
    return {
        subscribe: t,
        check: a
    }
}
function pe(e, t, n) {
    return e.origin !== de || !e.pathname.startsWith(t) ? !0 : n ? e.pathname !== location.pathname : !1
}
function un(e) {}
const st = new Set(["load", "prerender", "csr", "ssr", "trailingSlash", "config"]);
[...st];
const Dt = new Set([...st]);
[...Dt];
function qt(e) {
    return e.filter(t => t != null)
}
function $e(e) {
    return e instanceof Ae || e instanceof Ie ? e.status : 500
}
function Vt(e) {
    return e instanceof Ie ? e.text : "Internal Error"
}
let b, G, we;
const zt = Fe.toString().includes("$$") || /function \w+\(\) \{\}/.test(Fe.toString());
zt ? (b = {
    data: {},
    form: null,
    error: null,
    params: {},
    route: {
        id: null
    },
    state: {},
    status: -1,
    url: new URL("https://example.com")
},
G = {
    current: null
},
we = {
    current: !1
}) : (b = new class {
    #e = A({});
    get data() {
        return T(this.#e)
    }
    set data(t) {
        I(this.#e, t)
    }
    #t = A(null);
    get form() {
        return T(this.#t)
    }
    set form(t) {
        I(this.#t, t)
    }
    #n = A(null);
    get error() {
        return T(this.#n)
    }
    set error(t) {
        I(this.#n, t)
    }
    #a = A({});
    get params() {
        return T(this.#a)
    }
    set params(t) {
        I(this.#a, t)
    }
    #r = A({
        id: null
    });
    get route() {
        return T(this.#r)
    }
    set route(t) {
        I(this.#r, t)
    }
    #o = A({});
    get state() {
        return T(this.#o)
    }
    set state(t) {
        I(this.#o, t)
    }
    #s = A(-1);
    get status() {
        return T(this.#s)
    }
    set status(t) {
        I(this.#s, t)
    }
    #i = A(new URL("https://example.com"));
    get url() {
        return T(this.#i)
    }
    set url(t) {
        I(this.#i, t)
    }
}
,
G = new class {
    #e = A(null);
    get current() {
        return T(this.#e)
    }
    set current(t) {
        I(this.#e, t)
    }
}
,
we = new class {
    #e = A(!1);
    get current() {
        return T(this.#e)
    }
    set current(t) {
        I(this.#e, t)
    }
}
,
ot.v = () => we.current = !0);
function Ce(e) {
    Object.assign(b, e)
}
const {onMount: Bt} = vt
  , Kt = new Set(["icon", "shortcut icon", "apple-touch-icon"])
  , D = Ze(tt) ?? {}
  , W = Ze(et) ?? {}
  , j = {
    url: Je({}),
    page: Je({}),
    navigating: Ue(null),
    updated: Nt()
};
function je(e) {
    D[e] = he()
}
function Mt(e, t) {
    let n = e + 1;
    for (; D[n]; )
        delete D[n],
        n += 1;
    for (n = t + 1; W[n]; )
        delete W[n],
        n += 1
}
function H(e, t=!1) {
    return t ? location.replace(e.href) : location.href = e.href,
    new Promise( () => {}
    )
}
async function it() {
    if ("serviceWorker"in navigator) {
        const e = await navigator.serviceWorker.getRegistration(L || "/");
        e && await e.update()
    }
}
function Ee() {}
let Ne, Se, ae, P, Re, w;
const re = []
  , oe = [];
let R = null;
function se() {
    R?.fork?.then(e => e?.discard()),
    R = null
}
const ee = new Map
  , De = new Set
  , Yt = new Set
  , B = new Set;
let _ = {
    branch: [],
    error: null,
    url: null
}, ct = !1, ie = !1, Xe = !0, J = !1, M = !1, lt = !1, Q = !1, ge, y, x, O;
const ce = new Set;
let ye;
const le = new Map;
async function pn(e, t, n) {
    globalThis.__sveltekit_1mox9z0?.data && globalThis.__sveltekit_1mox9z0.data,
    document.URL !== location.href && (location.href = location.href),
    w = e,
    await e.hooks.init?.(),
    Ne = Ot(e),
    P = document.documentElement,
    Re = t,
    Se = e.nodes[0],
    ae = e.nodes[1],
    Se(),
    ae(),
    y = history.state?.[z],
    x = history.state?.[F],
    y || (y = x = Date.now(),
    history.replaceState({
        ...history.state,
        [z]: y,
        [F]: x
    }, ""));
    const a = D[y];
    function r() {
        a && (history.scrollRestoration = "manual",
        scrollTo(a.x, a.y))
    }
    n ? (r(),
    await rn(Re, n)) : (await K({
        type: "enter",
        url: Oe(w.hash ? cn(new URL(location.href)) : location.href),
        replace_state: !0
    }),
    r()),
    an()
}
async function Ft(e=!0, t=!0) {
    if (await (ye ||= Promise.resolve()),
    !ye)
        return;
    ye = null;
    const n = O = {}
      , a = await Z(_.url, !0);
    if (se(),
    Q && le.forEach( ({resource: r}) => {
        r.refresh?.()
    }
    ),
    e) {
        const r = b.state
          , s = a && await Be(a);
        if (!s || n !== O)
            return;
        if (s.type === "redirect")
            return qe(new URL(s.location,_.url).href, {
                replaceState: !0
            }, 1, n);
        t || (s.props.page.state = r),
        Ce(s.props.page),
        _ = s.state,
        xe(),
        ge.$set(s.props)
    } else
        xe();
    await Promise.all([...le.values()].map( ({resource: r}) => r)).catch(Ee)
}
function xe() {
    re.length = 0,
    Q = !1
}
function ut(e) {
    oe.some(t => t?.snapshot) && (W[e] = oe.map(t => t?.snapshot?.capture()))
}
function ft(e) {
    W[e]?.forEach( (t, n) => {
        oe[n]?.snapshot?.restore(t)
    }
    )
}
function Qe() {
    je(y),
    We(tt, D),
    ut(x),
    We(et, W)
}
async function qe(e, t, n, a) {
    let r;
    t.invalidateAll && se(),
    await K({
        type: "goto",
        url: Oe(e),
        keepfocus: t.keepFocus,
        noscroll: t.noScroll,
        replace_state: t.replaceState,
        state: t.state,
        redirect_count: n,
        nav_token: a,
        accept: () => {
            t.invalidateAll && (Q = !0,
            r = [...le.keys()]),
            t.invalidate && t.invalidate.forEach(nn)
        }
    }),
    t.invalidateAll && te().then(te).then( () => {
        le.forEach( ({resource: s}, o) => {
            r?.includes(o) && s.refresh?.()
        }
        )
    }
    )
}
async function Gt(e) {
    if (e.id !== R?.id) {
        se();
        const t = {};
        if (ce.add(t),
        R = {
            id: e.id,
            token: t,
            promise: Be({
                ...e,
                preload: t
            }).then(n => (ce.delete(t),
            n.type === "loaded" && n.state.error && se(),
            n)),
            fork: null
        },
        Ge) {
            const n = R;
            n.fork = n.promise.then(a => {
                if (n === R && a.type === "loaded")
                    try {
                        return Ge( () => {
                            ge.$set(a.props),
                            Ce(a.props.page)
                        }
                        )
                    } catch {}
                return null
            }
            )
        }
    }
    return R.promise
}
async function be(e) {
    const t = (await Z(e, !1))?.route;
    t && await Promise.all([...t.layouts, t.leaf].map(n => n?.[1]()))
}
async function dt(e, t, n) {
    _ = e.state;
    const a = document.querySelector("style[data-sveltekit]");
    if (a && a.remove(),
    Object.assign(b, e.props.page),
    ge = new w.root({
        target: t,
        props: {
            ...e.props,
            stores: j,
            components: oe
        },
        hydrate: n,
        sync: !1
    }),
    await Promise.resolve(),
    ft(x),
    n) {
        const r = {
            from: null,
            to: {
                params: _.params,
                route: {
                    id: _.route?.id ?? null
                },
                url: new URL(location.href)
            },
            willUnload: !1,
            type: "enter",
            complete: Promise.resolve()
        };
        B.forEach(s => s(r))
    }
    ie = !0
}
function ue({url: e, params: t, branch: n, status: a, error: r, route: s, form: o}) {
    let i = "never";
    if (L && (e.pathname === L || e.pathname === L + "/"))
        i = "always";
    else
        for (const u of n)
            u?.slash !== void 0 && (i = u.slash);
    e.pathname = yt(e.pathname, i),
    e.search = e.search;
    const c = {
        type: "loaded",
        state: {
            url: e,
            params: t,
            branch: n,
            error: r,
            route: s
        },
        props: {
            constructors: qt(n).map(u => u.node.component),
            page: Ye(b)
        }
    };
    o !== void 0 && (c.props.form = o);
    let l = {}
      , f = !b
      , h = 0;
    for (let u = 0; u < Math.max(n.length, _.branch.length); u += 1) {
        const g = n[u]
          , m = _.branch[u];
        g?.data !== m?.data && (f = !0),
        g && (l = {
            ...l,
            ...g.data
        },
        f && (c.props[`data_${h}`] = l),
        h += 1)
    }
    return (!_.url || e.href !== _.url.href || _.error !== r || o !== void 0 && o !== b.form || f) && (c.props.page = {
        error: r,
        params: t,
        route: {
            id: s?.id ?? null
        },
        state: {},
        status: a,
        url: new URL(e),
        form: o ?? null,
        data: f ? l : b.data
    }),
    c
}
async function Ve({loader: e, parent: t, url: n, params: a, route: r, server_data_node: s}) {
    let o = null;
    const i = {
        dependencies: new Set,
        params: new Set,
        parent: !1,
        route: !1,
        url: !1,
        search_params: new Set
    }
      , c = await e();
    return {
        node: c,
        loader: e,
        server: s,
        universal: c.universal?.load ? {
            type: "data",
            data: o,
            uses: i
        } : null,
        data: o ?? s?.data ?? null,
        slash: c.universal?.trailingSlash ?? s?.slash
    }
}
function Wt(e, t, n) {
    let a = e instanceof Request ? e.url : e;
    const r = new URL(a,n);
    r.origin === n.origin && (a = r.href.slice(n.origin.length));
    const s = ie ? Lt(a, r.href, t) : xt(a, t);
    return {
        resolved: r,
        promise: s
    }
}
function Ht(e, t, n, a, r, s) {
    if (Q)
        return !0;
    if (!r)
        return !1;
    if (r.parent && e || r.route && t || r.url && n)
        return !0;
    for (const o of r.search_params)
        if (a.has(o))
            return !0;
    for (const o of r.params)
        if (s[o] !== _.params[o])
            return !0;
    for (const o of r.dependencies)
        if (re.some(i => i(new URL(o))))
            return !0;
    return !1
}
function ze(e, t) {
    return e?.type === "data" ? e : e?.type === "skip" ? t ?? null : null
}
function Jt(e, t) {
    if (!e)
        return new Set(t.searchParams.keys());
    const n = new Set([...e.searchParams.keys(), ...t.searchParams.keys()]);
    for (const a of n) {
        const r = e.searchParams.getAll(a)
          , s = t.searchParams.getAll(a);
        r.every(o => s.includes(o)) && s.every(o => r.includes(o)) && n.delete(a)
    }
    return n
}
function Xt({error: e, url: t, route: n, params: a}) {
    return {
        type: "loaded",
        state: {
            error: e,
            url: t,
            route: n,
            params: a,
            branch: []
        },
        props: {
            page: Ye(b),
            constructors: []
        }
    }
}
async function Be({id: e, invalidating: t, url: n, params: a, route: r, preload: s}) {
    if (R?.id === e)
        return ce.delete(R.token),
        R.promise;
    const {errors: o, layouts: i, leaf: c} = r
      , l = [...i, c];
    o.forEach(p => p?.().catch( () => {}
    )),
    l.forEach(p => p?.[1]().catch( () => {}
    ));
    const f = _.url ? e !== fe(_.url) : !1
      , h = _.route ? r.id !== _.route.id : !1
      , v = Jt(_.url, n);
    let u = !1;
    const g = l.map(async (p, d) => {
        if (!p)
            return;
        const E = _.branch[d];
        return p[1] === E?.loader && !Ht(u, h, f, v, E.universal?.uses, a) ? E : (u = !0,
        Ve({
            loader: p[1],
            url: n,
            params: a,
            route: r,
            parent: async () => {
                const $ = {};
                for (let U = 0; U < d; U += 1)
                    Object.assign($, (await g[U])?.data);
                return $
            }
            ,
            server_data_node: ze(p[0] ? {
                type: "skip"
            } : null, p[0] ? E?.server : void 0)
        }))
    }
    );
    for (const p of g)
        p.catch( () => {}
        );
    const m = [];
    for (let p = 0; p < l.length; p += 1)
        if (l[p])
            try {
                m.push(await g[p])
            } catch (d) {
                if (d instanceof Te)
                    return {
                        type: "redirect",
                        location: d.location
                    };
                if (ce.has(s))
                    return Xt({
                        error: await X(d, {
                            params: a,
                            url: n,
                            route: {
                                id: r.id
                            }
                        }),
                        url: n,
                        params: a,
                        route: r
                    });
                let E = $e(d), S;
                if (d instanceof Ae)
                    S = d.body;
                else {
                    if (await j.updated.check())
                        return await it(),
                        await H(n);
                    S = await X(d, {
                        params: a,
                        url: n,
                        route: {
                            id: r.id
                        }
                    })
                }
                const $ = await Qt(p, m, o);
                return $ ? ue({
                    url: n,
                    params: a,
                    branch: m.slice(0, $.idx).concat($.node),
                    status: E,
                    error: S,
                    route: r
                }) : await pt(n, {
                    id: r.id
                }, S, E)
            }
        else
            m.push(void 0);
    return ue({
        url: n,
        params: a,
        branch: m,
        status: 200,
        error: null,
        route: r,
        form: t ? void 0 : null
    })
}
async function Qt(e, t, n) {
    for (; e--; )
        if (n[e]) {
            let a = e;
            for (; !t[a]; )
                a -= 1;
            try {
                return {
                    idx: a + 1,
                    node: {
                        node: await n[e](),
                        loader: n[e],
                        data: {},
                        server: null,
                        universal: null
                    }
                }
            } catch {
                continue
            }
        }
}
async function Ke({status: e, error: t, url: n, route: a}) {
    const r = {};
    let s = null;
    try {
        const o = await Ve({
            loader: Se,
            url: n,
            params: r,
            route: a,
            parent: () => Promise.resolve({}),
            server_data_node: ze(s)
        })
          , i = {
            node: await ae(),
            loader: ae,
            universal: null,
            server: null,
            data: null
        };
        return ue({
            url: n,
            params: r,
            branch: [o, i],
            status: e,
            error: t,
            route: null
        })
    } catch (o) {
        if (o instanceof Te)
            return qe(new URL(o.location,location.href), {}, 0);
        throw o
    }
}
async function Zt(e) {
    const t = e.href;
    if (ee.has(t))
        return ee.get(t);
    let n;
    try {
        const a = (async () => {
            let r = await w.hooks.reroute({
                url: new URL(e),
                fetch: async (s, o) => Wt(s, o, e).promise
            }) ?? e;
            if (typeof r == "string") {
                const s = new URL(e);
                w.hash ? s.hash = r : s.pathname = r,
                r = s
            }
            return r
        }
        )();
        ee.set(t, a),
        n = await a
    } catch {
        ee.delete(t);
        return
    }
    return n
}
async function Z(e, t) {
    if (e && !pe(e, L, w.hash)) {
        const n = await Zt(e);
        if (!n)
            return;
        const a = en(n);
        for (const r of Ne) {
            const s = r.exec(a);
            if (s)
                return {
                    id: fe(e),
                    invalidating: t,
                    route: r,
                    params: kt(s),
                    url: e
                }
        }
    }
}
function en(e) {
    return bt(w.hash ? e.hash.replace(/^#/, "").replace(/[?#].+/, "") : e.pathname.slice(L.length)) || "/"
}
function fe(e) {
    return (w.hash ? e.hash.replace(/^#/, "") : e.pathname) + e.search
}
function ht({url: e, type: t, intent: n, delta: a, event: r}) {
    let s = !1;
    const o = Me(_, n, e, t);
    a !== void 0 && (o.navigation.delta = a),
    r !== void 0 && (o.navigation.event = r);
    const i = {
        ...o.navigation,
        cancel: () => {
            s = !0,
            o.reject(new Error("navigation cancelled"))
        }
    };
    return J || De.forEach(c => c(i)),
    s ? null : o
}
async function K({type: e, url: t, popped: n, keepfocus: a, noscroll: r, replace_state: s, state: o={}, redirect_count: i=0, nav_token: c={}, accept: l=Ee, block: f=Ee, event: h}) {
    const v = O;
    O = c;
    const u = await Z(t, !1)
      , g = e === "enter" ? Me(_, u, t, e) : ht({
        url: t,
        type: e,
        delta: n?.delta,
        intent: u,
        event: h
    });
    if (!g) {
        f(),
        O === c && (O = v);
        return
    }
    const m = y
      , p = x;
    l(),
    J = !0,
    ie && g.navigation.type !== "enter" && j.navigating.set(G.current = g.navigation);
    let d = u && await Be(u);
    if (!d) {
        if (pe(t, L, w.hash))
            return await H(t, s);
        d = await pt(t, {
            id: null
        }, await X(new Ie(404,"Not Found",`Not found: ${t.pathname}`), {
            url: t,
            params: {},
            route: {
                id: null
            }
        }), 404, s)
    }
    if (t = u?.url || t,
    O !== c)
        return g.reject(new Error("navigation aborted")),
        !1;
    if (d.type === "redirect") {
        if (i < 20) {
            await K({
                type: e,
                url: new URL(d.location,t),
                popped: n,
                keepfocus: a,
                noscroll: r,
                replace_state: s,
                state: o,
                redirect_count: i + 1,
                nav_token: c
            }),
            g.fulfil(void 0);
            return
        }
        d = await Ke({
            status: 500,
            error: await X(new Error("Redirect loop"), {
                url: t,
                params: {},
                route: {
                    id: null
                }
            }),
            url: t,
            route: {
                id: null
            }
        })
    } else
        d.props.page.status >= 400 && await j.updated.check() && (await it(),
        await H(t, s));
    if (xe(),
    je(m),
    ut(p),
    d.props.page.url.pathname !== t.pathname && (t.pathname = d.props.page.url.pathname),
    o = n ? n.state : o,
    !n) {
        const k = s ? 0 : 1
          , q = {
            [z]: y += k,
            [F]: x += k,
            [nt]: o
        };
        (s ? history.replaceState : history.pushState).call(history, q, "", t),
        s || Mt(y, x)
    }
    const E = u && R?.id === u.id ? R.fork : null;
    R = null,
    d.props.page.state = o;
    let S;
    if (ie) {
        const k = (await Promise.all(Array.from(Yt, C => C(g.navigation)))).filter(C => typeof C == "function");
        if (k.length > 0) {
            let C = function() {
                k.forEach(_e => {
                    B.delete(_e)
                }
                )
            };
            k.push(C),
            k.forEach(_e => {
                B.add(_e)
            }
            )
        }
        _ = d.state,
        d.props.page && (d.props.page.url = t);
        const q = E && await E;
        q ? S = q.commit() : (ge.$set(d.props),
        Ce(d.props.page),
        S = wt?.()),
        lt = !0
    } else
        await dt(d, Re, !1);
    const {activeElement: $} = document;
    await S,
    await te(),
    await te();
    let U = n ? n.scroll : r ? he() : null;
    if (Xe) {
        const k = t.hash && document.getElementById(_t(t));
        if (U)
            scrollTo(U.x, U.y);
        else if (k) {
            k.scrollIntoView();
            const {top: q, left: C} = k.getBoundingClientRect();
            U = {
                x: pageXOffset + C,
                y: pageYOffset + q
            }
        } else
            scrollTo(0, 0)
    }
    const mt = document.activeElement !== $ && document.activeElement !== document.body;
    !a && !mt && sn(t, U),
    Xe = !0,
    d.props.page && Object.assign(b, d.props.page),
    J = !1,
    e === "popstate" && ft(x),
    g.fulfil(void 0),
    B.forEach(k => k(g.navigation)),
    j.navigating.set(G.current = null)
}
async function pt(e, t, n, a, r) {
    return e.origin === de && e.pathname === location.pathname && !ct ? await Ke({
        status: a,
        error: n,
        url: e,
        route: t
    }) : await H(e, r)
}
function tn() {
    let e, t, n;
    P.addEventListener("mousemove", i => {
        const c = i.target;
        clearTimeout(e),
        e = setTimeout( () => {
            s(c, N.hover)
        }
        , 20)
    }
    );
    function a(i) {
        i.defaultPrevented || s(i.composedPath()[0], N.tap)
    }
    P.addEventListener("mousedown", a),
    P.addEventListener("touchstart", a, {
        passive: !0
    });
    const r = new IntersectionObserver(i => {
        for (const c of i)
            c.isIntersecting && (be(new URL(c.target.href)),
            r.unobserve(c.target))
    }
    ,{
        threshold: 0
    });
    async function s(i, c) {
        const l = rt(i, P)
          , f = l === t && c >= n;
        if (!l || f)
            return;
        const {url: h, external: v, download: u} = ke(l, L, w.hash);
        if (v || u)
            return;
        const g = ne(l)
          , m = h && fe(_.url) === fe(h);
        if (!(g.reload || m))
            if (c <= g.preload_data) {
                t = l,
                n = N.tap;
                const p = await Z(h, !1);
                if (!p)
                    return;
                Gt(p)
            } else
                c <= g.preload_code && (t = l,
                n = c,
                be(h))
    }
    function o() {
        r.disconnect();
        for (const i of P.querySelectorAll("a")) {
            const {url: c, external: l, download: f} = ke(i, L, w.hash);
            if (l || f)
                continue;
            const h = ne(i);
            h.reload || (h.preload_code === N.viewport && r.observe(i),
            h.preload_code === N.eager && be(c))
        }
    }
    B.add(o),
    o()
}
function X(e, t) {
    if (e instanceof Ae)
        return e.body;
    const n = $e(e)
      , a = Vt(e);
    return w.hooks.handleError({
        error: e,
        event: t,
        status: n,
        message: a
    }) ?? {
        message: a
    }
}
function gt(e, t) {
    Bt( () => (e.add(t),
    () => {
        e.delete(t)
    }
    ))
}
function gn(e) {
    gt(B, e)
}
function _n(e) {
    gt(De, e)
}
function mn(e, t={}) {
    return e = new URL(Oe(e)),
    e.origin !== de ? Promise.reject(new Error("goto: invalid URL")) : qe(e, t, 0)
}
function nn(e) {
    if (typeof e == "function")
        re.push(e);
    else {
        const {href: t} = new URL(e,location.href);
        re.push(n => n.href === t)
    }
}
function vn() {
    return Q = !0,
    Ft()
}
function an() {
    history.scrollRestoration = "manual",
    addEventListener("beforeunload", t => {
        let n = !1;
        if (Qe(),
        !J) {
            const a = Me(_, void 0, null, "leave")
              , r = {
                ...a.navigation,
                cancel: () => {
                    n = !0,
                    a.reject(new Error("navigation cancelled"))
                }
            };
            De.forEach(s => s(r))
        }
        n ? (t.preventDefault(),
        t.returnValue = "") : history.scrollRestoration = "auto"
    }
    ),
    addEventListener("visibilitychange", () => {
        document.visibilityState === "hidden" && Qe()
    }
    ),
    navigator.connection?.saveData || tn(),
    P.addEventListener("click", async t => {
        if (t.button || t.which !== 1 || t.metaKey || t.ctrlKey || t.shiftKey || t.altKey || t.defaultPrevented)
            return;
        const n = rt(t.composedPath()[0], P);
        if (!n)
            return;
        const {url: a, external: r, target: s, download: o} = ke(n, L, w.hash);
        if (!a)
            return;
        if (s === "_parent" || s === "_top") {
            if (window.parent !== window)
                return
        } else if (s && s !== "_self")
            return;
        const i = ne(n);
        if (!(n instanceof SVGAElement) && a.protocol !== location.protocol && !(a.protocol === "https:" || a.protocol === "http:") || o)
            return;
        const [l,f] = (w.hash ? a.hash.replace(/^#/, "") : a.href).split("#")
          , h = l === me(location);
        if (r || i.reload && (!h || !f)) {
            ht({
                url: a,
                type: "link",
                event: t
            }) ? J = !0 : t.preventDefault();
            return
        }
        if (f !== void 0 && h) {
            const [,v] = _.url.href.split("#");
            if (v === f) {
                if (t.preventDefault(),
                f === "" || f === "top" && n.ownerDocument.getElementById("top") === null)
                    scrollTo({
                        top: 0
                    });
                else {
                    const u = n.ownerDocument.getElementById(decodeURIComponent(f));
                    u && (u.scrollIntoView(),
                    u.focus())
                }
                return
            }
            if (M = !0,
            je(y),
            e(a),
            !i.replace_state)
                return;
            M = !1
        }
        t.preventDefault(),
        await new Promise(v => {
            requestAnimationFrame( () => {
                setTimeout(v, 0)
            }
            ),
            setTimeout(v, 100)
        }
        ),
        await K({
            type: "link",
            url: a,
            keepfocus: i.keepfocus,
            noscroll: i.noscroll,
            replace_state: i.replace_state ?? a.href === location.href,
            event: t
        })
    }
    ),
    P.addEventListener("submit", t => {
        if (t.defaultPrevented)
            return;
        const n = HTMLFormElement.prototype.cloneNode.call(t.target)
          , a = t.submitter;
        if ((a?.formTarget || n.target) === "_blank" || (a?.formMethod || n.method) !== "get")
            return;
        const o = new URL(a?.hasAttribute("formaction") && a?.formAction || n.action);
        if (pe(o, L, !1))
            return;
        const i = t.target
          , c = ne(i);
        if (c.reload)
            return;
        t.preventDefault(),
        t.stopPropagation();
        const l = new FormData(i,a);
        o.search = new URLSearchParams(l).toString(),
        K({
            type: "form",
            url: o,
            keepfocus: c.keepfocus,
            noscroll: c.noscroll,
            replace_state: c.replace_state ?? o.href === location.href,
            event: t
        })
    }
    ),
    addEventListener("popstate", async t => {
        if (!Le) {
            if (t.state?.[z]) {
                const n = t.state[z];
                if (O = {},
                n === y)
                    return;
                const a = D[n]
                  , r = t.state[nt] ?? {}
                  , s = new URL(t.state[jt] ?? location.href)
                  , o = t.state[F]
                  , i = _.url ? me(location) === me(_.url) : !1;
                if (o === x && (lt || i)) {
                    r !== b.state && (b.state = r),
                    e(s),
                    D[y] = he(),
                    a && scrollTo(a.x, a.y),
                    y = n;
                    return
                }
                const l = n - y;
                await K({
                    type: "popstate",
                    url: s,
                    popped: {
                        state: r,
                        scroll: a,
                        delta: l
                    },
                    accept: () => {
                        y = n,
                        x = o
                    }
                    ,
                    block: () => {
                        history.go(-l)
                    }
                    ,
                    nav_token: O,
                    event: t
                })
            } else if (!M) {
                const n = new URL(location.href);
                e(n),
                w.hash && location.reload()
            }
        }
    }
    ),
    addEventListener("hashchange", () => {
        M && (M = !1,
        history.replaceState({
            ...history.state,
            [z]: ++y,
            [F]: x
        }, "", location.href))
    }
    );
    for (const t of document.querySelectorAll("link"))
        Kt.has(t.rel) && (t.href = t.href);
    addEventListener("pageshow", t => {
        t.persisted && j.navigating.set(G.current = null)
    }
    );
    function e(t) {
        _.url = b.url = t,
        j.page.set(Ye(b)),
        j.page.notify()
    }
}
async function rn(e, {status: t=200, error: n, node_ids: a, params: r, route: s, server_route: o, data: i, form: c}) {
    ct = !0;
    const l = new URL(location.href);
    let f;
    ({params: r={}, route: s={
        id: null
    }} = await Z(l, !1) || {}),
    f = Ne.find( ({id: u}) => u === s.id);
    let h, v = !0;
    try {
        const u = a.map(async (m, p) => {
            const d = i[p];
            return d?.uses && (d.uses = on(d.uses)),
            Ve({
                loader: w.nodes[m],
                url: l,
                params: r,
                route: s,
                parent: async () => {
                    const E = {};
                    for (let S = 0; S < p; S += 1)
                        Object.assign(E, (await u[S]).data);
                    return E
                }
                ,
                server_data_node: ze(d)
            })
        }
        )
          , g = await Promise.all(u);
        if (f) {
            const m = f.layouts;
            for (let p = 0; p < m.length; p++)
                m[p] || g.splice(p, 0, void 0)
        }
        h = ue({
            url: l,
            params: r,
            branch: g,
            status: t,
            error: n,
            form: c,
            route: f ?? null
        })
    } catch (u) {
        if (u instanceof Te) {
            await H(new URL(u.location,location.href));
            return
        }
        h = await Ke({
            status: $e(u),
            error: await X(u, {
                url: l,
                params: r,
                route: s
            }),
            url: l,
            route: s
        }),
        e.textContent = "",
        v = !1
    }
    h.props.page && (h.props.page.state = {}),
    await dt(h, e, v)
}
function on(e) {
    return {
        dependencies: new Set(e?.dependencies ?? []),
        params: new Set(e?.params ?? []),
        parent: !!e?.parent,
        route: !!e?.route,
        url: !!e?.url,
        search_params: new Set(e?.search_params ?? [])
    }
}
let Le = !1;
function sn(e, t=null) {
    const n = document.querySelector("[autofocus]");
    if (n)
        n.focus();
    else {
        const a = _t(e);
        if (a && document.getElementById(a)) {
            const {x: s, y: o} = t ?? he();
            setTimeout( () => {
                const i = history.state;
                Le = !0,
                location.replace(`#${a}`),
                w.hash && location.replace(e.hash),
                history.replaceState(i, "", e.hash),
                scrollTo(s, o),
                Le = !1
            }
            )
        } else {
            const s = document.body
              , o = s.getAttribute("tabindex");
            s.tabIndex = -1,
            s.focus({
                preventScroll: !0,
                focusVisible: !1
            }),
            o !== null ? s.setAttribute("tabindex", o) : s.removeAttribute("tabindex")
        }
        const r = getSelection();
        if (r && r.type !== "None") {
            const s = [];
            for (let o = 0; o < r.rangeCount; o += 1)
                s.push(r.getRangeAt(o));
            setTimeout( () => {
                if (r.rangeCount === s.length) {
                    for (let o = 0; o < r.rangeCount; o += 1) {
                        const i = s[o]
                          , c = r.getRangeAt(o);
                        if (i.commonAncestorContainer !== c.commonAncestorContainer || i.startContainer !== c.startContainer || i.endContainer !== c.endContainer || i.startOffset !== c.startOffset || i.endOffset !== c.endOffset)
                            return
                    }
                    r.removeAllRanges()
                }
            }
            )
        }
    }
}
function Me(e, t, n, a) {
    let r, s;
    const o = new Promise( (c, l) => {
        r = c,
        s = l
    }
    );
    return o.catch( () => {}
    ),
    {
        navigation: {
            from: {
                params: e.params,
                route: {
                    id: e.route?.id ?? null
                },
                url: e.url
            },
            to: n && {
                params: t?.params ?? null,
                route: {
                    id: t?.route?.id ?? null
                },
                url: n
            },
            willUnload: !t,
            type: a,
            complete: o
        },
        fulfil: r,
        reject: s
    }
}
function Ye(e) {
    return {
        data: e.data,
        error: e.error,
        form: e.form,
        params: e.params,
        route: e.route,
        state: e.state,
        status: e.status,
        url: e.url
    }
}
function cn(e) {
    const t = new URL(e);
    return t.hash = decodeURIComponent(e.hash),
    t
}
function _t(e) {
    let t;
    if (w.hash) {
        const [,,n] = e.hash.split("#", 3);
        t = n ?? ""
    } else
        t = e.hash.slice(1);
    return decodeURIComponent(t)
}
export {gn as a, _n as b, pn as c, mn as g, vn as i, un as l, b as p, j as s};
var kt = Array.isArray
  , kn = Array.prototype.indexOf
  , Sn = Array.from
  , Rn = Object.defineProperty
  , Ae = Object.getOwnPropertyDescriptor
  , Cn = Object.getOwnPropertyDescriptors
  , On = Object.prototype
  , Dn = Array.prototype
  , St = Object.getPrototypeOf
  , wt = Object.isExtensible;
const ve = () => {}
;
function zr(e) {
    return e()
}
function Rt(e) {
    for (var t = 0; t < e.length; t++)
        e[t]()
}
function Ct() {
    var e, t, n = new Promise( (r, s) => {
        e = r,
        t = s
    }
    );
    return {
        promise: n,
        resolve: e,
        reject: t
    }
}
const b = 2
  , ot = 4
  , $e = 8
  , Nn = 1 << 24
  , G = 16
  , K = 32
  , ce = 64
  , We = 128
  , L = 512
  , x = 1024
  , R = 2048
  , X = 4096
  , B = 8192
  , te = 16384
  , ze = 32768
  , pe = 65536
  , tt = 1 << 17
  , Ot = 1 << 18
  , me = 1 << 19
  , Dt = 1 << 20
  , Gr = 1 << 25
  , oe = 32768
  , nt = 1 << 21
  , ut = 1 << 22
  , ne = 1 << 23
  , fe = Symbol("$state")
  , Kr = Symbol("legacy props")
  , Xr = Symbol("")
  , de = new class extends Error {
    name = "StaleReactionError";
    message = "The reaction that called `getAbortSignal()` was re-run or destroyed"
}
  , Ge = 3
  , Ne = 8;
function Nt(e) {
    throw new Error("https://svelte.dev/e/experimental_async_required")
}
function be(e) {
    throw new Error("https://svelte.dev/e/lifecycle_outside_component")
}
function Pn() {
    throw new Error("https://svelte.dev/e/missing_context")
}
function Mn() {
    throw new Error("https://svelte.dev/e/async_derived_orphan")
}
function In(e) {
    throw new Error("https://svelte.dev/e/effect_in_teardown")
}
function Fn() {
    throw new Error("https://svelte.dev/e/effect_in_unowned_derived")
}
function Ln(e) {
    throw new Error("https://svelte.dev/e/effect_orphan")
}
function jn() {
    throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")
}
function qn() {
    throw new Error("https://svelte.dev/e/fork_discarded")
}
function Yn() {
    throw new Error("https://svelte.dev/e/fork_timing")
}
function Bn() {
    throw new Error("https://svelte.dev/e/get_abort_signal_outside_reaction")
}
function Hn() {
    throw new Error("https://svelte.dev/e/hydration_failed")
}
function Pt(e) {
    throw new Error("https://svelte.dev/e/lifecycle_legacy_only")
}
function Jr(e) {
    throw new Error("https://svelte.dev/e/props_invalid_value")
}
function Un() {
    throw new Error("https://svelte.dev/e/state_descriptors_fixed")
}
function Vn() {
    throw new Error("https://svelte.dev/e/state_prototype_fixed")
}
function $n() {
    throw new Error("https://svelte.dev/e/state_unsafe_mutation")
}
function Wn() {
    throw new Error("https://svelte.dev/e/svelte_boundary_reset_onerror")
}
const Qr = 1
  , es = 2
  , ts = 4
  , ns = 8
  , rs = 16
  , ss = 1
  , is = 2
  , fs = 4
  , as = 8
  , ls = 16
  , Mt = 1
  , zn = 2
  , It = "["
  , Ft = "[!"
  , Lt = "]"
  , ge = {}
  , T = Symbol()
  , os = "http://www.w3.org/1999/xhtml";
function us() {}
let m = !1;
function je(e) {
    m = e
}
let g;
function j(e) {
    if (e === null)
        throw ge;
    return g = e
}
function ct() {
    return j(Z(g))
}
function cs(e) {
    if (m) {
        if (Z(g) !== null)
            throw ge;
        g = e
    }
}
function Gn(e=1) {
    if (m) {
        for (var t = e, n = g; t--; )
            n = Z(n);
        g = n
    }
}
function Kn(e=!0) {
    for (var t = 0, n = g; ; ) {
        if (n.nodeType === Ne) {
            var r = n.data;
            if (r === Lt) {
                if (t === 0)
                    return n;
                t -= 1
            } else
                (r === It || r === Ft) && (t += 1)
        }
        var s = Z(n);
        e && n.remove(),
        n = s
    }
}
function _s(e) {
    if (!e || e.nodeType !== Ne)
        throw ge;
    return e.data
}
function jt(e) {
    return e === this.v
}
function qt(e, t) {
    return e != e ? t == t : e !== t || e !== null && typeof e == "object" || typeof e == "function"
}
function Yt(e) {
    return !qt(e, this.v)
}
let Pe = !1;
function hs() {
    Pe = !0
}
let v = null;
function we(e) {
    v = e
}
function Xn() {
    const e = {};
    return [ () => (Ut(e) || Pn(),
    Bt(e)), t => Ht(e, t)]
}
function Bt(e) {
    return Ke().get(e)
}
function Ht(e, t) {
    return Ke().set(e, t),
    t
}
function Ut(e) {
    return Ke().has(e)
}
function Zn() {
    return Ke()
}
function Jn(e, t=!1, n) {
    v = {
        p: v,
        i: !1,
        c: null,
        e: null,
        s: e,
        x: null,
        l: Pe && !t ? {
            s: null,
            u: null,
            $: []
        } : null
    }
}
function Qn(e) {
    var t = v
      , n = t.e;
    if (n !== null) {
        t.e = null;
        for (var r of n)
            fn(r)
    }
    return e !== void 0 && (t.x = e),
    t.i = !0,
    v = t.p,
    e ?? {}
}
function Me() {
    return !Pe || v !== null && v.l === null
}
function Ke(e) {
    return v === null && be(),
    v.c ??= new Map(er(v) || void 0)
}
function er(e) {
    let t = e.p;
    for (; t !== null; ) {
        const n = t.c;
        if (n !== null)
            return n;
        t = t.p
    }
    return null
}
let se = [];
function Vt() {
    var e = se;
    se = [],
    Rt(e)
}
function Xe(e) {
    if (se.length === 0 && !ke) {
        var t = se;
        queueMicrotask( () => {
            t === se && Vt()
        }
        )
    }
    se.push(e)
}
function tr() {
    for (; se.length > 0; )
        Vt()
}
function $t(e) {
    var t = p;
    if (t === null)
        return d.f |= ne,
        e;
    if ((t.f & ze) === 0) {
        if ((t.f & We) === 0)
            throw e;
        t.b.error(e)
    } else
        ye(e, t)
}
function ye(e, t) {
    for (; t !== null; ) {
        if ((t.f & We) !== 0)
            try {
                t.b.error(e);
                return
            } catch (n) {
                e = n
            }
        t = t.parent
    }
    throw e
}
const ie = new Set;
let y = null
  , et = null
  , k = null
  , M = []
  , Ze = null
  , rt = !1
  , ke = !1;
class I {
    committed = !1;
    current = new Map;
    previous = new Map;
    #e = new Set;
    #t = new Set;
    #n = 0;
    #r = 0;
    #l = null;
    #i = [];
    #s = [];
    skipped_effects = new Set;
    is_fork = !1;
    is_deferred() {
        return this.is_fork || this.#r > 0
    }
    process(t) {
        M = [],
        et = null,
        this.apply();
        var n = {
            parent: null,
            effect: null,
            effects: [],
            render_effects: [],
            block_effects: []
        };
        for (const r of t)
            this.#f(r, n);
        this.is_fork || this.#u(),
        this.is_deferred() ? (this.#a(n.effects),
        this.#a(n.render_effects),
        this.#a(n.block_effects)) : (et = this,
        y = null,
        yt(n.render_effects),
        yt(n.effects),
        et = null,
        this.#l?.resolve()),
        k = null
    }
    #f(t, n) {
        t.f ^= x;
        for (var r = t.first; r !== null; ) {
            var s = r.f
              , i = (s & (K | ce)) !== 0
              , f = i && (s & x) !== 0
              , o = f || (s & B) !== 0 || this.skipped_effects.has(r);
            if ((r.f & We) !== 0 && r.b?.is_pending() && (n = {
                parent: n,
                effect: r,
                effects: [],
                render_effects: [],
                block_effects: []
            }),
            !o && r.fn !== null) {
                i ? r.f ^= x : (s & ot) !== 0 ? n.effects.push(r) : Fe(r) && ((r.f & G) !== 0 && n.block_effects.push(r),
                De(r));
                var a = r.first;
                if (a !== null) {
                    r = a;
                    continue
                }
            }
            var l = r.parent;
            for (r = r.next; r === null && l !== null; )
                l === n.effect && (this.#a(n.effects),
                this.#a(n.render_effects),
                this.#a(n.block_effects),
                n = n.parent),
                r = l.next,
                l = l.parent
        }
    }
    #a(t) {
        for (const n of t)
            ((n.f & R) !== 0 ? this.#i : this.#s).push(n),
            this.#o(n.deps),
            E(n, x)
    }
    #o(t) {
        if (t !== null)
            for (const n of t)
                (n.f & b) === 0 || (n.f & oe) === 0 || (n.f ^= oe,
                this.#o(n.deps))
    }
    capture(t, n) {
        this.previous.has(t) || this.previous.set(t, n),
        (t.f & ne) === 0 && (this.current.set(t, t.v),
        k?.set(t, t.v))
    }
    activate() {
        y = this,
        this.apply()
    }
    deactivate() {
        y === this && (y = null,
        k = null)
    }
    flush() {
        if (this.activate(),
        M.length > 0) {
            if (st(),
            y !== null && y !== this)
                return
        } else
            this.#n === 0 && this.process([]);
        this.deactivate()
    }
    discard() {
        for (const t of this.#t)
            t(this);
        this.#t.clear()
    }
    #u() {
        if (this.#r === 0) {
            for (const t of this.#e)
                t();
            this.#e.clear()
        }
        this.#n === 0 && this.#c()
    }
    #c() {
        if (ie.size > 1) {
            this.previous.clear();
            var t = k
              , n = !0
              , r = {
                parent: null,
                effect: null,
                effects: [],
                render_effects: [],
                block_effects: []
            };
            for (const i of ie) {
                if (i === this) {
                    n = !1;
                    continue
                }
                const f = [];
                for (const [a,l] of this.current) {
                    if (i.current.has(a))
                        if (n && l !== i.current.get(a))
                            i.current.set(a, l);
                        else
                            continue;
                    f.push(a)
                }
                if (f.length === 0)
                    continue;
                const o = [...i.current.keys()].filter(a => !this.current.has(a));
                if (o.length > 0) {
                    var s = M;
                    M = [];
                    const a = new Set
                      , l = new Map;
                    for (const c of f)
                        Wt(c, o, a, l);
                    if (M.length > 0) {
                        y = i,
                        i.apply();
                        for (const c of M)
                            i.#f(c, r);
                        i.deactivate()
                    }
                    M = s
                }
            }
            y = null,
            k = t
        }
        this.committed = !0,
        ie.delete(this)
    }
    increment(t) {
        this.#n += 1,
        t && (this.#r += 1)
    }
    decrement(t) {
        this.#n -= 1,
        t && (this.#r -= 1),
        this.revive()
    }
    revive() {
        for (const t of this.#i)
            E(t, R),
            ue(t);
        for (const t of this.#s)
            E(t, X),
            ue(t);
        this.#i = [],
        this.#s = [],
        this.flush()
    }
    oncommit(t) {
        this.#e.add(t)
    }
    ondiscard(t) {
        this.#t.add(t)
    }
    settled() {
        return (this.#l ??= Ct()).promise
    }
    static ensure() {
        if (y === null) {
            const t = y = new I;
            ie.add(y),
            ke || I.enqueue( () => {
                y === t && t.flush()
            }
            )
        }
        return y
    }
    static enqueue(t) {
        Xe(t)
    }
    apply() {}
}
function qe(e) {
    var t = ke;
    ke = !0;
    try {
        var n;
        for (e && (y !== null && st(),
        n = e()); ; ) {
            if (tr(),
            M.length === 0 && (y?.flush(),
            M.length === 0))
                return Ze = null,
                n;
            st()
        }
    } finally {
        ke = t
    }
}
function st() {
    var e = ae;
    rt = !0;
    var t = null;
    try {
        var n = 0;
        for (Ue(!0); M.length > 0; ) {
            var r = I.ensure();
            if (n++ > 1e3) {
                var s, i;
                nr()
            }
            r.process(M),
            re.clear()
        }
    } finally {
        rt = !1,
        Ue(e),
        Ze = null
    }
}
function nr() {
    try {
        jn()
    } catch (e) {
        ye(e, Ze)
    }
}
let $ = null;
function yt(e) {
    var t = e.length;
    if (t !== 0) {
        for (var n = 0; n < t; ) {
            var r = e[n++];
            if ((r.f & (te | B)) === 0 && Fe(r) && ($ = new Set,
            De(r),
            r.deps === null && r.first === null && r.nodes === null && (r.teardown === null && r.ac === null ? un(r) : r.fn = null),
            $?.size > 0)) {
                re.clear();
                for (const s of $) {
                    if ((s.f & (te | B)) !== 0)
                        continue;
                    const i = [s];
                    let f = s.parent;
                    for (; f !== null; )
                        $.has(f) && ($.delete(f),
                        i.push(f)),
                        f = f.parent;
                    for (let o = i.length - 1; o >= 0; o--) {
                        const a = i[o];
                        (a.f & (te | B)) === 0 && De(a)
                    }
                }
                $.clear()
            }
        }
        $ = null
    }
}
function Wt(e, t, n, r) {
    if (!n.has(e) && (n.add(e),
    e.reactions !== null))
        for (const s of e.reactions) {
            const i = s.f;
            (i & b) !== 0 ? Wt(s, t, n, r) : (i & (ut | G)) !== 0 && (i & R) === 0 && Gt(s, t, r) && (E(s, R),
            ue(s))
        }
}
function zt(e, t) {
    if (e.reactions !== null)
        for (const n of e.reactions) {
            const r = n.f;
            (r & b) !== 0 ? zt(n, t) : (r & tt) !== 0 && (E(n, R),
            t.add(n))
        }
}
function Gt(e, t, n) {
    const r = n.get(e);
    if (r !== void 0)
        return r;
    if (e.deps !== null)
        for (const s of e.deps) {
            if (t.includes(s))
                return !0;
            if ((s.f & b) !== 0 && Gt(s, t, n))
                return n.set(s, !0),
                !0
        }
    return n.set(e, !1),
    !1
}
function ue(e) {
    for (var t = Ze = e; t.parent !== null; ) {
        t = t.parent;
        var n = t.f;
        if (rt && t === p && (n & G) !== 0 && (n & Ot) === 0)
            return;
        if ((n & (ce | K)) !== 0) {
            if ((n & x) === 0)
                return;
            t.f ^= x
        }
    }
    M.push(t)
}
function rr(e) {
    Nt(),
    y !== null && Yn();
    var t = I.ensure();
    t.is_fork = !0,
    k = new Map;
    var n = !1
      , r = t.settled();
    qe(e),
    k = null;
    for (var [s,i] of t.previous)
        s.v = i;
    return {
        commit: async () => {
            if (n) {
                await r;
                return
            }
            ie.has(t) || qn(),
            n = !0,
            t.is_fork = !1;
            for (var [f,o] of t.current)
                f.v = o;
            qe( () => {
                var a = new Set;
                for (var l of t.current.keys())
                    zt(l, a);
                hr(a),
                Jt()
            }
            ),
            t.revive(),
            await r
        }
        ,
        discard: () => {
            !n && ie.has(t) && (ie.delete(t),
            t.discard())
        }
    }
}
function sr(e) {
    let t = 0, n = Ie(0), r;
    return () => {
        Ce() && (ee(n),
        br( () => (t === 0 && (r = Le( () => e( () => Se(n)))),
        t += 1,
        () => {
            Xe( () => {
                t -= 1,
                t === 0 && (r?.(),
                r = void 0,
                Se(n))
            }
            )
        }
        )))
    }
}
var ir = pe | me | We;
function fr(e, t, n) {
    new ar(e,t,n)
}
class ar {
    parent;
    #e = !1;
    #t;
    #n = m ? g : null;
    #r;
    #l;
    #i;
    #s = null;
    #f = null;
    #a = null;
    #o = null;
    #u = null;
    #c = 0;
    #_ = 0;
    #d = !1;
    #h = null;
    #y = sr( () => (this.#h = Ie(this.#c),
    () => {
        this.#h = null
    }
    ));
    constructor(t, n, r) {
        this.#t = t,
        this.#r = n,
        this.#l = r,
        this.parent = p.b,
        this.#e = !!this.#r.pending,
        this.#i = an( () => {
            if (p.b = this,
            m) {
                const i = this.#n;
                ct(),
                i.nodeType === Ne && i.data === Ft ? this.#b() : this.#m()
            } else {
                var s = this.#g();
                try {
                    this.#s = W( () => r(s))
                } catch (i) {
                    this.error(i)
                }
                this.#_ > 0 ? this.#p() : this.#e = !1
            }
            return () => {
                this.#u?.remove()
            }
        }
        , ir),
        m && (this.#t = g)
    }
    #m() {
        try {
            this.#s = W( () => this.#l(this.#t))
        } catch (t) {
            this.error(t)
        }
        this.#e = !1
    }
    #b() {
        const t = this.#r.pending;
        t && (this.#f = W( () => t(this.#t)),
        I.enqueue( () => {
            var n = this.#g();
            this.#s = this.#v( () => (I.ensure(),
            W( () => this.#l(n)))),
            this.#_ > 0 ? this.#p() : (Re(this.#f, () => {
                this.#f = null
            }
            ),
            this.#e = !1)
        }
        ))
    }
    #g() {
        var t = this.#t;
        return this.#e && (this.#u = q(),
        this.#t.before(this.#u),
        t = this.#u),
        t
    }
    is_pending() {
        return this.#e || !!this.parent && this.parent.is_pending()
    }
    has_pending_snippet() {
        return !!this.#r.pending
    }
    #v(t) {
        var n = p
          , r = d
          , s = v;
        H(this.#i),
        S(this.#i),
        we(this.#i.ctx);
        try {
            return t()
        } catch (i) {
            return $t(i),
            null
        } finally {
            H(n),
            S(r),
            we(s)
        }
    }
    #p() {
        const t = this.#r.pending;
        this.#s !== null && (this.#o = document.createDocumentFragment(),
        this.#o.append(this.#u),
        hn(this.#s, this.#o)),
        this.#f === null && (this.#f = W( () => t(this.#t)))
    }
    #w(t) {
        if (!this.has_pending_snippet()) {
            this.parent && this.parent.#w(t);
            return
        }
        this.#_ += t,
        this.#_ === 0 && (this.#e = !1,
        this.#f && Re(this.#f, () => {
            this.#f = null
        }
        ),
        this.#o && (this.#t.before(this.#o),
        this.#o = null))
    }
    update_pending_count(t) {
        this.#w(t),
        this.#c += t,
        this.#h && He(this.#h, this.#c)
    }
    get_effect_pending() {
        return this.#y(),
        ee(this.#h)
    }
    error(t) {
        var n = this.#r.onerror;
        let r = this.#r.failed;
        if (this.#d || !n && !r)
            throw t;
        this.#s && (N(this.#s),
        this.#s = null),
        this.#f && (N(this.#f),
        this.#f = null),
        this.#a && (N(this.#a),
        this.#a = null),
        m && (j(this.#n),
        Gn(),
        j(Kn()));
        var s = !1
          , i = !1;
        const f = () => {
            if (s) {
                return
            }
            s = !0,
            i && Wn(),
            I.ensure(),
            this.#c = 0,
            this.#a !== null && Re(this.#a, () => {
                this.#a = null
            }
            ),
            this.#e = this.has_pending_snippet(),
            this.#s = this.#v( () => (this.#d = !1,
            W( () => this.#l(this.#t)))),
            this.#_ > 0 ? this.#p() : this.#e = !1
        }
        ;
        var o = d;
        try {
            S(null),
            i = !0,
            n?.(t, f),
            i = !1
        } catch (a) {
            ye(a, this.#i && this.#i.parent)
        } finally {
            S(o)
        }
        r && Xe( () => {
            this.#a = this.#v( () => {
                I.ensure(),
                this.#d = !0;
                try {
                    return W( () => {
                        r(this.#t, () => t, () => f)
                    }
                    )
                } catch (a) {
                    return ye(a, this.#i.parent),
                    null
                } finally {
                    this.#d = !1
                }
            }
            )
        }
        )
    }
}
function lr(e, t, n, r) {
    const s = Me() ? _t : cr;
    if (n.length === 0 && e.length === 0) {
        r(t.map(s));
        return
    }
    var i = y
      , f = p
      , o = or();
    function a() {
        Promise.all(n.map(l => ur(l))).then(l => {
            o();
            try {
                r([...t.map(s), ...l])
            } catch (c) {
                (f.f & te) === 0 && ye(c, f)
            }
            i?.deactivate(),
            Ye()
        }
        ).catch(l => {
            ye(l, f)
        }
        )
    }
    e.length > 0 ? Promise.all(e).then( () => {
        o();
        try {
            return a()
        } finally {
            i?.deactivate(),
            Ye()
        }
    }
    ) : a()
}
function or() {
    var e = p
      , t = d
      , n = v
      , r = y;
    return function(i=!0) {
        H(e),
        S(t),
        we(n),
        i && r?.activate()
    }
}
function Ye() {
    H(null),
    S(null),
    we(null)
}
function _t(e) {
    var t = b | R
      , n = d !== null && (d.f & b) !== 0 ? d : null;
    return p !== null && (p.f |= me),
    {
        ctx: v,
        deps: null,
        effects: null,
        equals: jt,
        f: t,
        fn: e,
        reactions: null,
        rv: 0,
        v: T,
        wv: 0,
        parent: n ?? p,
        ac: null
    }
}
function ur(e, t) {
    let n = p;
    n === null && Mn();
    var r = n.b
      , s = void 0
      , i = Ie(T)
      , f = !d
      , o = new Map;
    return mr( () => {
        var a = Ct();
        s = a.promise;
        try {
            Promise.resolve(e()).then(a.resolve, a.reject).then( () => {
                l === y && l.committed && l.deactivate(),
                Ye()
            }
            )
        } catch (u) {
            a.reject(u),
            Ye()
        }
        var l = y;
        if (f) {
            var c = !r.is_pending();
            r.update_pending_count(1),
            l.increment(c),
            o.get(l)?.reject(de),
            o.delete(l),
            o.set(l, a)
        }
        const h = (u, _=void 0) => {
            if (l.activate(),
            _)
                _ !== de && (i.f |= ne,
                He(i, _));
            else {
                (i.f & ne) !== 0 && (i.f ^= ne),
                He(i, u);
                for (const [w,C] of o) {
                    if (o.delete(w),
                    w === l)
                        break;
                    C.reject(de)
                }
            }
            f && (r.update_pending_count(-1),
            l.decrement(c))
        }
        ;
        a.promise.then(h, u => h(null, u || "unknown"))
    }
    ),
    dt( () => {
        for (const a of o.values())
            a.reject(de)
    }
    ),
    new Promise(a => {
        function l(c) {
            function h() {
                c === s ? a(i) : l(s)
            }
            c.then(h, h)
        }
        l(s)
    }
    )
}
function ds(e) {
    const t = _t(e);
    return dn(t),
    t
}
function cr(e) {
    const t = _t(e);
    return t.equals = Yt,
    t
}
function Kt(e) {
    var t = e.effects;
    if (t !== null) {
        e.effects = null;
        for (var n = 0; n < t.length; n += 1)
            N(t[n])
    }
}
function _r(e) {
    for (var t = e.parent; t !== null; ) {
        if ((t.f & b) === 0)
            return (t.f & te) === 0 ? t : null;
        t = t.parent
    }
    return null
}
function ht(e) {
    var t, n = p;
    H(_r(e));
    try {
        e.f &= ~oe,
        Kt(e),
        t = wn(e)
    } finally {
        H(n)
    }
    return t
}
function Xt(e) {
    var t = ht(e);
    if (e.equals(t) || (y?.is_fork || (e.v = t),
    e.wv = pn()),
    !Ee)
        if (k !== null)
            (Ce() || y?.is_fork) && k.set(e, t);
        else {
            var n = (e.f & L) === 0 ? X : x;
            E(e, n)
        }
}
let Be = new Set;
const re = new Map;
function hr(e) {
    Be = e
}
let Zt = !1;
function Ie(e, t) {
    var n = {
        f: 0,
        v: e,
        reactions: null,
        equals: jt,
        rv: 0,
        wv: 0
    };
    return n
}
function J(e, t) {
    const n = Ie(e);
    return dn(n),
    n
}
function vs(e, t=!1, n=!0) {
    const r = Ie(e);
    return t || (r.equals = Yt),
    Pe && n && v !== null && v.l !== null && (v.l.s ??= []).push(r),
    r
}
function Q(e, t, n=!1) {
    d !== null && (!Y || (d.f & tt) !== 0) && Me() && (d.f & (b | G | ut | tt)) !== 0 && !z?.includes(e) && $n();
    let r = n ? Te(t) : t;
    return He(e, r)
}
function He(e, t) {
    if (!e.equals(t)) {
        var n = e.v;
        Ee ? re.set(e, t) : re.set(e, n),
        e.v = t;
        var r = I.ensure();
        r.capture(e, n),
        (e.f & b) !== 0 && ((e.f & R) !== 0 && ht(e),
        E(e, (e.f & L) !== 0 ? x : X)),
        e.wv = pn(),
        Qt(e, R),
        Me() && p !== null && (p.f & x) !== 0 && (p.f & (K | ce)) === 0 && (P === null ? Ar([e]) : P.push(e)),
        !r.is_fork && Be.size > 0 && !Zt && Jt()
    }
    return t
}
function Jt() {
    Zt = !1;
    var e = ae;
    Ue(!0);
    const t = Array.from(Be);
    try {
        for (const n of t)
            (n.f & x) !== 0 && E(n, X),
            Fe(n) && De(n)
    } finally {
        Ue(e)
    }
    Be.clear()
}
function ps(e, t=1) {
    var n = ee(e)
      , r = t === 1 ? n++ : n--;
    return Q(e, n),
    r
}
function Se(e) {
    Q(e, e.v + 1)
}
function Qt(e, t) {
    var n = e.reactions;
    if (n !== null)
        for (var r = Me(), s = n.length, i = 0; i < s; i++) {
            var f = n[i]
              , o = f.f;
            if (!(!r && f === p)) {
                var a = (o & R) === 0;
                if (a && E(f, t),
                (o & b) !== 0) {
                    var l = f;
                    k?.delete(l),
                    (o & oe) === 0 && (o & L && (f.f |= oe),
                    Qt(l, X))
                } else
                    a && ((o & G) !== 0 && $ !== null && $.add(f),
                    ue(f))
            }
        }
}
function Te(e) {
    if (typeof e != "object" || e === null || fe in e)
        return e;
    const t = St(e);
    if (t !== On && t !== Dn)
        return e;
    var n = new Map
      , r = kt(e)
      , s = J(0)
      , i = le
      , f = o => {
        if (le === i)
            return o();
        var a = d
          , l = le;
        S(null),
        xt(i);
        var c = o();
        return S(a),
        xt(l),
        c
    }
    ;
    return r && n.set("length", J(e.length)),
    new Proxy(e,{
        defineProperty(o, a, l) {
            (!("value"in l) || l.configurable === !1 || l.enumerable === !1 || l.writable === !1) && Un();
            var c = n.get(a);
            return c === void 0 ? c = f( () => {
                var h = J(l.value);
                return n.set(a, h),
                h
            }
            ) : Q(c, l.value, !0),
            !0
        },
        deleteProperty(o, a) {
            var l = n.get(a);
            if (l === void 0) {
                if (a in o) {
                    const c = f( () => J(T));
                    n.set(a, c),
                    Se(s)
                }
            } else
                Q(l, T),
                Se(s);
            return !0
        },
        get(o, a, l) {
            if (a === fe)
                return e;
            var c = n.get(a)
              , h = a in o;
            if (c === void 0 && (!h || Ae(o, a)?.writable) && (c = f( () => {
                var _ = Te(h ? o[a] : T)
                  , w = J(_);
                return w
            }
            ),
            n.set(a, c)),
            c !== void 0) {
                var u = ee(c);
                return u === T ? void 0 : u
            }
            return Reflect.get(o, a, l)
        },
        getOwnPropertyDescriptor(o, a) {
            var l = Reflect.getOwnPropertyDescriptor(o, a);
            if (l && "value"in l) {
                var c = n.get(a);
                c && (l.value = ee(c))
            } else if (l === void 0) {
                var h = n.get(a)
                  , u = h?.v;
                if (h !== void 0 && u !== T)
                    return {
                        enumerable: !0,
                        configurable: !0,
                        value: u,
                        writable: !0
                    }
            }
            return l
        },
        has(o, a) {
            if (a === fe)
                return !0;
            var l = n.get(a)
              , c = l !== void 0 && l.v !== T || Reflect.has(o, a);
            if (l !== void 0 || p !== null && (!c || Ae(o, a)?.writable)) {
                l === void 0 && (l = f( () => {
                    var u = c ? Te(o[a]) : T
                      , _ = J(u);
                    return _
                }
                ),
                n.set(a, l));
                var h = ee(l);
                if (h === T)
                    return !1
            }
            return c
        },
        set(o, a, l, c) {
            var h = n.get(a)
              , u = a in o;
            if (r && a === "length")
                for (var _ = l; _ < h.v; _ += 1) {
                    var w = n.get(_ + "");
                    w !== void 0 ? Q(w, T) : _ in o && (w = f( () => J(T)),
                    n.set(_ + "", w))
                }
            if (h === void 0)
                (!u || Ae(o, a)?.writable) && (h = f( () => J(void 0)),
                Q(h, Te(l)),
                n.set(a, h));
            else {
                u = h.v !== T;
                var C = f( () => Te(l));
                Q(h, C)
            }
            var V = Reflect.getOwnPropertyDescriptor(o, a);
            if (V?.set && V.set.call(c, l),
            !u) {
                if (r && typeof a == "string") {
                    var gt = n.get("length")
                      , Qe = Number(a);
                    Number.isInteger(Qe) && Qe >= gt.v && Q(gt, Qe + 1)
                }
                Se(s)
            }
            return !0
        },
        ownKeys(o) {
            ee(s);
            var a = Reflect.ownKeys(o).filter(h => {
                var u = n.get(h);
                return u === void 0 || u.v !== T
            }
            );
            for (var [l,c] of n)
                c.v !== T && !(l in o) && a.push(l);
            return a
        },
        setPrototypeOf() {
            Vn()
        }
    })
}
function mt(e) {
    try {
        if (e !== null && typeof e == "object" && fe in e)
            return e[fe]
    } catch {}
    return e
}
function gs(e, t) {
    return Object.is(mt(e), mt(t))
}
var bt, dr, en, tn, nn;
function it() {
    if (bt === void 0) {
        bt = window,
        dr = document,
        en = /Firefox/.test(navigator.userAgent);
        var e = Element.prototype
          , t = Node.prototype
          , n = Text.prototype;
        tn = Ae(t, "firstChild").get,
        nn = Ae(t, "nextSibling").get,
        wt(e) && (e.__click = void 0,
        e.__className = void 0,
        e.__attributes = null,
        e.__style = void 0,
        e.__e = void 0),
        wt(n) && (n.__t = void 0)
    }
}
function q(e="") {
    return document.createTextNode(e)
}
function D(e) {
    return tn.call(e)
}
function Z(e) {
    return nn.call(e)
}
function ws(e, t) {
    if (!m)
        return D(e);
    var n = D(g);
    if (n === null)
        n = g.appendChild(q());
    else if (t && n.nodeType !== Ge) {
        var r = q();
        return n?.before(r),
        j(r),
        r
    }
    return j(n),
    n
}
function ys(e, t=!1) {
    if (!m) {
        var n = D(e);
        return n instanceof Comment && n.data === "" ? Z(n) : n
    }
    if (t && g?.nodeType !== Ge) {
        var r = q();
        return g?.before(r),
        j(r),
        r
    }
    return g
}
function ms(e, t=1, n=!1) {
    let r = m ? g : e;
    for (var s; t--; )
        s = r,
        r = Z(r);
    if (!m)
        return r;
    if (n && r?.nodeType !== Ge) {
        var i = q();
        return r === null ? s?.after(i) : r.before(i),
        j(i),
        i
    }
    return j(r),
    r
}
function rn(e) {
    e.textContent = ""
}
function vr() {
    return !1
}
function bs(e) {
    m && D(e) !== null && rn(e)
}
let Et = !1;
function pr() {
    Et || (Et = !0,
    document.addEventListener("reset", e => {
        Promise.resolve().then( () => {
            if (!e.defaultPrevented)
                for (const t of e.target.elements)
                    t.__on_r?.()
        }
        )
    }
    , {
        capture: !0
    }))
}
function Je(e) {
    var t = d
      , n = p;
    S(null),
    H(null);
    try {
        return e()
    } finally {
        S(t),
        H(n)
    }
}
function Es(e, t, n, r=n) {
    e.addEventListener(t, () => Je(n));
    const s = e.__on_r;
    s ? e.__on_r = () => {
        s(),
        r(!0)
    }
    : e.__on_r = () => r(!0),
    pr()
}
function sn(e) {
    p === null && (d === null && Ln(),
    Fn()),
    Ee && In()
}
function gr(e, t) {
    var n = t.last;
    n === null ? t.last = t.first = e : (n.next = e,
    e.prev = n,
    t.last = e)
}
function U(e, t, n) {
    var r = p;
    r !== null && (r.f & B) !== 0 && (e |= B);
    var s = {
        ctx: v,
        deps: null,
        nodes: null,
        f: e | R | L,
        first: null,
        fn: t,
        last: null,
        next: null,
        parent: r,
        b: r && r.b,
        prev: null,
        teardown: null,
        wv: 0,
        ac: null
    };
    if (n)
        try {
            De(s),
            s.f |= ze
        } catch (o) {
            throw N(s),
            o
        }
    else
        t !== null && ue(s);
    var i = s;
    if (n && i.deps === null && i.teardown === null && i.nodes === null && i.first === i.last && (i.f & me) === 0 && (i = i.first,
    (e & G) !== 0 && (e & pe) !== 0 && i !== null && (i.f |= pe)),
    i !== null && (i.parent = r,
    r !== null && gr(i, r),
    d !== null && (d.f & b) !== 0 && (e & ce) === 0)) {
        var f = d;
        (f.effects ??= []).push(i)
    }
    return s
}
function Ce() {
    return d !== null && !Y
}
function dt(e) {
    const t = U($e, null, !1);
    return E(t, x),
    t.teardown = e,
    t
}
function wr(e) {
    sn();
    var t = p.f
      , n = !d && (t & K) !== 0 && (t & ze) === 0;
    if (n) {
        var r = v;
        (r.e ??= []).push(e)
    } else
        return fn(e)
}
function fn(e) {
    return U(ot | Dt, e, !1)
}
function Ts(e) {
    return sn(),
    U($e | Dt, e, !0)
}
function yr(e) {
    I.ensure();
    const t = U(ce | me, e, !0);
    return (n={}) => new Promise(r => {
        n.outro ? Re(t, () => {
            N(t),
            r(void 0)
        }
        ) : (N(t),
        r(void 0))
    }
    )
}
function xs(e) {
    return U(ot, e, !1)
}
function mr(e) {
    return U(ut | me, e, !0)
}
function br(e, t=0) {
    return U($e | t, e, !0)
}
function As(e, t=[], n=[], r=[]) {
    lr(r, t, n, s => {
        U($e, () => e(...s.map(ee)), !0)
    }
    )
}
function an(e, t=0) {
    var n = U(G | t, e, !0);
    return n
}
function W(e) {
    return U(K | me, e, !0)
}
function ln(e) {
    var t = e.teardown;
    if (t !== null) {
        const n = Ee
          , r = d;
        Tt(!0),
        S(null);
        try {
            t.call(null)
        } finally {
            Tt(n),
            S(r)
        }
    }
}
function on(e, t=!1) {
    var n = e.first;
    for (e.first = e.last = null; n !== null; ) {
        const s = n.ac;
        s !== null && Je( () => {
            s.abort(de)
        }
        );
        var r = n.next;
        (n.f & ce) !== 0 ? n.parent = null : N(n, t),
        n = r
    }
}
function Er(e) {
    for (var t = e.first; t !== null; ) {
        var n = t.next;
        (t.f & K) === 0 && N(t),
        t = n
    }
}
function N(e, t=!0) {
    var n = !1;
    (t || (e.f & Ot) !== 0) && e.nodes !== null && e.nodes.end !== null && (Tr(e.nodes.start, e.nodes.end),
    n = !0),
    on(e, t && !n),
    Ve(e, 0),
    E(e, te);
    var r = e.nodes && e.nodes.t;
    if (r !== null)
        for (const i of r)
            i.stop();
    ln(e);
    var s = e.parent;
    s !== null && s.first !== null && un(e),
    e.next = e.prev = e.teardown = e.ctx = e.deps = e.fn = e.nodes = e.ac = null
}
function Tr(e, t) {
    for (; e !== null; ) {
        var n = e === t ? null : Z(e);
        e.remove(),
        e = n
    }
}
function un(e) {
    var t = e.parent
      , n = e.prev
      , r = e.next;
    n !== null && (n.next = r),
    r !== null && (r.prev = n),
    t !== null && (t.first === e && (t.first = r),
    t.last === e && (t.last = n))
}
function Re(e, t, n=!0) {
    var r = [];
    cn(e, r, !0);
    var s = () => {
        n && N(e),
        t && t()
    }
      , i = r.length;
    if (i > 0) {
        var f = () => --i || s();
        for (var o of r)
            o.out(f)
    } else
        s()
}
function cn(e, t, n) {
    if ((e.f & B) === 0) {
        e.f ^= B;
        var r = e.nodes && e.nodes.t;
        if (r !== null)
            for (const o of r)
                (o.is_global || n) && t.push(o);
        for (var s = e.first; s !== null; ) {
            var i = s.next
              , f = (s.f & pe) !== 0 || (s.f & K) !== 0 && (e.f & G) !== 0;
            cn(s, t, f ? n : !1),
            s = i
        }
    }
}
function xr(e) {
    _n(e, !0)
}
function _n(e, t) {
    if ((e.f & B) !== 0) {
        e.f ^= B,
        (e.f & x) === 0 && (E(e, R),
        ue(e));
        for (var n = e.first; n !== null; ) {
            var r = n.next
              , s = (n.f & pe) !== 0 || (n.f & K) !== 0;
            _n(n, s ? t : !1),
            n = r
        }
        var i = e.nodes && e.nodes.t;
        if (i !== null)
            for (const f of i)
                (f.is_global || t) && f.in()
    }
}
function hn(e, t) {
    if (e.nodes)
        for (var n = e.nodes.start, r = e.nodes.end; n !== null; ) {
            var s = n === r ? null : Z(n);
            t.append(n),
            n = s
        }
}
let ae = !1;
function Ue(e) {
    ae = e
}
let Ee = !1;
function Tt(e) {
    Ee = e
}
let d = null
  , Y = !1;
function S(e) {
    d = e
}
let p = null;
function H(e) {
    p = e
}
let z = null;
function dn(e) {
    d !== null && (z === null ? z = [e] : z.push(e))
}
let A = null
  , O = 0
  , P = null;
function Ar(e) {
    P = e
}
let vn = 1
  , Oe = 0
  , le = Oe;
function xt(e) {
    le = e
}
function pn() {
    return ++vn
}
function Fe(e) {
    var t = e.f;
    if ((t & R) !== 0)
        return !0;
    if (t & b && (e.f &= ~oe),
    (t & X) !== 0) {
        var n = e.deps;
        if (n !== null)
            for (var r = n.length, s = 0; s < r; s++) {
                var i = n[s];
                if (Fe(i) && Xt(i),
                i.wv > e.wv)
                    return !0
            }
        (t & L) !== 0 && k === null && E(e, x)
    }
    return !1
}
function gn(e, t, n=!0) {
    var r = e.reactions;
    if (r !== null && !z?.includes(e))
        for (var s = 0; s < r.length; s++) {
            var i = r[s];
            (i.f & b) !== 0 ? gn(i, t, !1) : t === i && (n ? E(i, R) : (i.f & x) !== 0 && E(i, X),
            ue(i))
        }
}
function wn(e) {
    var t = A
      , n = O
      , r = P
      , s = d
      , i = z
      , f = v
      , o = Y
      , a = le
      , l = e.f;
    A = null,
    O = 0,
    P = null,
    d = (l & (K | ce)) === 0 ? e : null,
    z = null,
    we(e.ctx),
    Y = !1,
    le = ++Oe,
    e.ac !== null && (Je( () => {
        e.ac.abort(de)
    }
    ),
    e.ac = null);
    try {
        e.f |= nt;
        var c = e.fn
          , h = c()
          , u = e.deps;
        if (A !== null) {
            var _;
            if (Ve(e, O),
            u !== null && O > 0)
                for (u.length = O + A.length,
                _ = 0; _ < A.length; _++)
                    u[O + _] = A[_];
            else
                e.deps = u = A;
            if (Ce() && (e.f & L) !== 0)
                for (_ = O; _ < u.length; _++)
                    (u[_].reactions ??= []).push(e)
        } else
            u !== null && O < u.length && (Ve(e, O),
            u.length = O);
        if (Me() && P !== null && !Y && u !== null && (e.f & (b | X | R)) === 0)
            for (_ = 0; _ < P.length; _++)
                gn(P[_], e);
        return s !== null && s !== e && (Oe++,
        P !== null && (r === null ? r = P : r.push(...P))),
        (e.f & ne) !== 0 && (e.f ^= ne),
        h
    } catch (w) {
        return $t(w)
    } finally {
        e.f ^= nt,
        A = t,
        O = n,
        P = r,
        d = s,
        z = i,
        we(f),
        Y = o,
        le = a
    }
}
function kr(e, t) {
    let n = t.reactions;
    if (n !== null) {
        var r = kn.call(n, e);
        if (r !== -1) {
            var s = n.length - 1;
            s === 0 ? n = t.reactions = null : (n[r] = n[s],
            n.pop())
        }
    }
    n === null && (t.f & b) !== 0 && (A === null || !A.includes(t)) && (E(t, X),
    (t.f & L) !== 0 && (t.f ^= L,
    t.f &= ~oe),
    Kt(t),
    Ve(t, 0))
}
function Ve(e, t) {
    var n = e.deps;
    if (n !== null)
        for (var r = t; r < n.length; r++)
            kr(e, n[r])
}
function De(e) {
    var t = e.f;
    if ((t & te) === 0) {
        E(e, x);
        var n = p
          , r = ae;
        p = e,
        ae = !0;
        try {
            (t & (G | Nn)) !== 0 ? Er(e) : on(e),
            ln(e);
            var s = wn(e);
            e.teardown = typeof s == "function" ? s : null,
            e.wv = vn;
            var i
        } finally {
            ae = r,
            p = n
        }
    }
}
async function Sr() {
    await Promise.resolve(),
    qe()
}
function Rr() {
    return I.ensure().settled()
}
function ee(e) {
    var t = e.f
      , n = (t & b) !== 0;
    if (d !== null && !Y) {
        var r = p !== null && (p.f & te) !== 0;
        if (!r && !z?.includes(e)) {
            var s = d.deps;
            if ((d.f & nt) !== 0)
                e.rv < Oe && (e.rv = Oe,
                A === null && s !== null && s[O] === e ? O++ : A === null ? A = [e] : A.includes(e) || A.push(e));
            else {
                (d.deps ??= []).push(e);
                var i = e.reactions;
                i === null ? e.reactions = [d] : i.includes(d) || i.push(d)
            }
        }
    }
    if (Ee) {
        if (re.has(e))
            return re.get(e);
        if (n) {
            var f = e
              , o = f.v;
            return ((f.f & x) === 0 && f.reactions !== null || mn(f)) && (o = ht(f)),
            re.set(f, o),
            o
        }
    } else
        n && (!k?.has(e) || y?.is_fork && !Ce()) && (f = e,
        Fe(f) && Xt(f),
        ae && Ce() && (f.f & L) === 0 && yn(f));
    if (k?.has(e))
        return k.get(e);
    if ((e.f & ne) !== 0)
        throw e.v;
    return e.v
}
function yn(e) {
    if (e.deps !== null) {
        e.f ^= L;
        for (const t of e.deps)
            (t.reactions ??= []).push(e),
            (t.f & b) !== 0 && (t.f & L) === 0 && yn(t)
    }
}
function mn(e) {
    if (e.v === T)
        return !0;
    if (e.deps === null)
        return !1;
    for (const t of e.deps)
        if (re.has(t) || (t.f & b) !== 0 && mn(t))
            return !0;
    return !1
}
function Le(e) {
    var t = Y;
    try {
        return Y = !0,
        e()
    } finally {
        Y = t
    }
}
const Cr = -7169;
function E(e, t) {
    e.f = e.f & Cr | t
}
function ks(e) {
    if (!(typeof e != "object" || !e || e instanceof EventTarget)) {
        if (fe in e)
            ft(e);
        else if (!Array.isArray(e))
            for (let t in e) {
                const n = e[t];
                typeof n == "object" && n && fe in n && ft(n)
            }
    }
}
function ft(e, t=new Set) {
    if (typeof e == "object" && e !== null && !(e instanceof EventTarget) && !t.has(e)) {
        t.add(e),
        e instanceof Date && e.getTime();
        for (let r in e)
            try {
                ft(e[r], t)
            } catch {}
        const n = St(e);
        if (n !== Object.prototype && n !== Array.prototype && n !== Map.prototype && n !== Set.prototype && n !== Date.prototype) {
            const r = Cn(n);
            for (let s in r) {
                const i = r[s].get;
                if (i)
                    try {
                        i.call(e)
                    } catch {}
            }
        }
    }
}
const Or = ["touchstart", "touchmove"];
function Dr(e) {
    return Or.includes(e)
}
const bn = new Set
  , at = new Set;
function Ss(e) {
    if (!m)
        return;
    e.removeAttribute("onload"),
    e.removeAttribute("onerror");
    const t = e.__e;
    t !== void 0 && (e.__e = void 0,
    queueMicrotask( () => {
        e.isConnected && e.dispatchEvent(t)
    }
    ))
}
function Nr(e, t, n, r={}) {
    function s(i) {
        if (r.capture || xe.call(t, i),
        !i.cancelBubble)
            return Je( () => n?.call(this, i))
    }
    return e.startsWith("pointer") || e.startsWith("touch") || e === "wheel" ? Xe( () => {
        t.addEventListener(e, s, r)
    }
    ) : t.addEventListener(e, s, r),
    s
}
function Rs(e, t, n, r, s) {
    var i = {
        capture: r,
        passive: s
    }
      , f = Nr(e, t, n, i);
    (t === document.body || t === window || t === document || t instanceof HTMLMediaElement) && dt( () => {
        t.removeEventListener(e, f, i)
    }
    )
}
function Cs(e) {
    for (var t = 0; t < e.length; t++)
        bn.add(e[t]);
    for (var n of at)
        n(e)
}
let At = null;
function xe(e) {
    var t = this
      , n = t.ownerDocument
      , r = e.type
      , s = e.composedPath?.() || []
      , i = s[0] || e.target;
    At = e;
    var f = 0
      , o = At === e && e.__root;
    if (o) {
        var a = s.indexOf(o);
        if (a !== -1 && (t === document || t === window)) {
            e.__root = t;
            return
        }
        var l = s.indexOf(t);
        if (l === -1)
            return;
        a <= l && (f = a)
    }
    if (i = s[f] || e.target,
    i !== t) {
        Rn(e, "currentTarget", {
            configurable: !0,
            get() {
                return i || n
            }
        });
        var c = d
          , h = p;
        S(null),
        H(null);
        try {
            for (var u, _ = []; i !== null; ) {
                var w = i.assignedSlot || i.parentNode || i.host || null;
                try {
                    var C = i["__" + r];
                    C != null && (!i.disabled || e.target === i) && C.call(i, e)
                } catch (V) {
                    u ? _.push(V) : u = V
                }
                if (e.cancelBubble || w === t || w === null)
                    break;
                i = w
            }
            if (u) {
                for (let V of _)
                    queueMicrotask( () => {
                        throw V
                    }
                    );
                throw u
            }
        } finally {
            e.__root = t,
            delete e.currentTarget,
            S(c),
            H(h)
        }
    }
}
function vt(e) {
    var t = document.createElement("template");
    return t.innerHTML = e.replaceAll("<!>", "<!---->"),
    t.content
}
function F(e, t) {
    var n = p;
    n.nodes === null && (n.nodes = {
        start: e,
        end: t,
        a: null,
        t: null
    })
}
function Os(e, t) {
    var n = (t & Mt) !== 0, r = (t & zn) !== 0, s, i = !e.startsWith("<!>");
    return () => {
        if (m)
            return F(g, null),
            g;
        s === void 0 && (s = vt(i ? e : "<!>" + e),
        n || (s = D(s)));
        var f = r || en ? document.importNode(s, !0) : s.cloneNode(!0);
        if (n) {
            var o = D(f)
              , a = f.lastChild;
            F(o, a)
        } else
            F(f, f);
        return f
    }
}
function Pr(e, t, n="svg") {
    var r = !e.startsWith("<!>"), s = (t & Mt) !== 0, i = `<${n}>${r ? e : "<!>" + e}</${n}>`, f;
    return () => {
        if (m)
            return F(g, null),
            g;
        if (!f) {
            var o = vt(i)
              , a = D(o);
            if (s)
                for (f = document.createDocumentFragment(); D(a); )
                    f.appendChild(D(a));
            else
                f = D(a)
        }
        var l = f.cloneNode(!0);
        if (s) {
            var c = D(l)
              , h = l.lastChild;
            F(c, h)
        } else
            F(l, l);
        return l
    }
}
function Ds(e, t) {
    return Pr(e, t, "svg")
}
function Ns(e="") {
    if (!m) {
        var t = q(e + "");
        return F(t, t),
        t
    }
    var n = g;
    return n.nodeType !== Ge && (n.before(n = q()),
    j(n)),
    F(n, n),
    n
}
function Ps() {
    if (m)
        return F(g, null),
        g;
    var e = document.createDocumentFragment()
      , t = document.createComment("")
      , n = q();
    return e.append(t, n),
    F(t, n),
    e
}
function Ms(e, t) {
    if (m) {
        var n = p;
        ((n.f & ze) === 0 || n.nodes.end === null) && (n.nodes.end = g),
        ct();
        return
    }
    e !== null && e.before(t)
}
function Is(e, t) {
    var n = t == null ? "" : typeof t == "object" ? t + "" : t;
    n !== (e.__t ??= e.nodeValue) && (e.__t = n,
    e.nodeValue = n + "")
}
function En(e, t) {
    return Tn(e, t)
}
function Mr(e, t) {
    it(),
    t.intro = t.intro ?? !1;
    const n = t.target
      , r = m
      , s = g;
    try {
        for (var i = D(n); i && (i.nodeType !== Ne || i.data !== It); )
            i = Z(i);
        if (!i)
            throw ge;
        je(!0),
        j(i);
        const f = Tn(e, {
            ...t,
            anchor: i
        });
        return je(!1),
        f
    } catch (f) {
        if (f instanceof Error && f.message.split(`
`).some(o => o.startsWith("https://svelte.dev/e/")))
            throw f;
        return t.recover === !1 && Hn(),
        it(),
        rn(n),
        je(!1),
        En(e, t)
    } finally {
        je(r),
        j(s)
    }
}
const _e = new Map;
function Tn(e, {target: t, anchor: n, props: r={}, events: s, context: i, intro: f=!0}) {
    it();
    var o = new Set
      , a = h => {
        for (var u = 0; u < h.length; u++) {
            var _ = h[u];
            if (!o.has(_)) {
                o.add(_);
                var w = Dr(_);
                t.addEventListener(_, xe, {
                    passive: w
                });
                var C = _e.get(_);
                C === void 0 ? (document.addEventListener(_, xe, {
                    passive: w
                }),
                _e.set(_, 1)) : _e.set(_, C + 1)
            }
        }
    }
    ;
    a(Sn(bn)),
    at.add(a);
    var l = void 0
      , c = yr( () => {
        var h = n ?? t.appendChild(q());
        return fr(h, {
            pending: () => {}
        }, u => {
            if (i) {
                Jn({});
                var _ = v;
                _.c = i
            }
            if (s && (r.$$events = s),
            m && F(u, null),
            l = e(u, r) || {},
            m && (p.nodes.end = g,
            g === null || g.nodeType !== Ne || g.data !== Lt))
                throw ge;
            i && Qn()
        }
        ),
        () => {
            for (var u of o) {
                t.removeEventListener(u, xe);
                var _ = _e.get(u);
                --_ === 0 ? (document.removeEventListener(u, xe),
                _e.delete(u)) : _e.set(u, _)
            }
            at.delete(a),
            h !== n && h.parentNode?.removeChild(h)
        }
    }
    );
    return lt.set(l, c),
    l
}
let lt = new WeakMap;
function Ir(e, t) {
    const n = lt.get(e);
    return n ? (lt.delete(e),
    n(t)) : Promise.resolve()
}
class Fr {
    anchor;
    #e = new Map;
    #t = new Map;
    #n = new Map;
    #r = new Set;
    #l = !0;
    constructor(t, n=!0) {
        this.anchor = t,
        this.#l = n
    }
    #i = () => {
        var t = y;
        if (this.#e.has(t)) {
            var n = this.#e.get(t)
              , r = this.#t.get(n);
            if (r)
                xr(r),
                this.#r.delete(n);
            else {
                var s = this.#n.get(n);
                s && (this.#t.set(n, s.effect),
                this.#n.delete(n),
                s.fragment.lastChild.remove(),
                this.anchor.before(s.fragment),
                r = s.effect)
            }
            for (const [i,f] of this.#e) {
                if (this.#e.delete(i),
                i === t)
                    break;
                const o = this.#n.get(f);
                o && (N(o.effect),
                this.#n.delete(f))
            }
            for (const [i,f] of this.#t) {
                if (i === n || this.#r.has(i))
                    continue;
                const o = () => {
                    if (Array.from(this.#e.values()).includes(i)) {
                        var l = document.createDocumentFragment();
                        hn(f, l),
                        l.append(q()),
                        this.#n.set(i, {
                            effect: f,
                            fragment: l
                        })
                    } else
                        N(f);
                    this.#r.delete(i),
                    this.#t.delete(i)
                }
                ;
                this.#l || !r ? (this.#r.add(i),
                Re(f, o, !1)) : o()
            }
        }
    }
    ;
    #s = t => {
        this.#e.delete(t);
        const n = Array.from(this.#e.values());
        for (const [r,s] of this.#n)
            n.includes(r) || (N(s.effect),
            this.#n.delete(r))
    }
    ;
    ensure(t, n) {
        var r = y
          , s = vr();
        if (n && !this.#t.has(t) && !this.#n.has(t))
            if (s) {
                var i = document.createDocumentFragment()
                  , f = q();
                i.append(f),
                this.#n.set(t, {
                    effect: W( () => n(f)),
                    fragment: i
                })
            } else
                this.#t.set(t, W( () => n(this.anchor)));
        if (this.#e.set(r, t),
        s) {
            for (const [o,a] of this.#t)
                o === t ? r.skipped_effects.delete(a) : r.skipped_effects.add(a);
            for (const [o,a] of this.#n)
                o === t ? r.skipped_effects.delete(a.effect) : r.skipped_effects.add(a.effect);
            r.oncommit(this.#i),
            r.ondiscard(this.#s)
        } else
            m && (this.anchor = g),
            this.#i()
    }
}
function Fs(e, t, ...n) {
    var r = new Fr(e);
    an( () => {
        const s = t() ?? null;
        r.ensure(s, s && (i => s(i, ...n)))
    }
    , pe)
}
function Lr(e) {
    return (t, ...n) => {
        var r = e(...n), s;
        if (m)
            s = g,
            ct();
        else {
            var i = r.render().trim()
              , f = vt(i);
            s = D(f),
            t.before(s)
        }
        const o = r.setup?.(s);
        F(s, s),
        typeof o == "function" && dt(o)
    }
}
function xn(e, t, n) {
    if (e == null)
        return t(void 0),
        n && n(void 0),
        ve;
    const r = Le( () => e.subscribe(t, n));
    return r.unsubscribe ? () => r.unsubscribe() : r
}
const he = [];
function jr(e, t) {
    return {
        subscribe: qr(e, t).subscribe
    }
}
function qr(e, t=ve) {
    let n = null;
    const r = new Set;
    function s(o) {
        if (qt(e, o) && (e = o,
        n)) {
            const a = !he.length;
            for (const l of r)
                l[1](),
                he.push(l, e);
            if (a) {
                for (let l = 0; l < he.length; l += 2)
                    he[l][0](he[l + 1]);
                he.length = 0
            }
        }
    }
    function i(o) {
        s(o(e))
    }
    function f(o, a=ve) {
        const l = [o, a];
        return r.add(l),
        r.size === 1 && (n = t(s, i) || ve),
        o(e),
        () => {
            r.delete(l),
            r.size === 0 && n && (n(),
            n = null)
        }
    }
    return {
        set: s,
        update: i,
        subscribe: f
    }
}
function Ls(e, t, n) {
    const r = !Array.isArray(e)
      , s = r ? [e] : e;
    if (!s.every(Boolean))
        throw new Error("derived() expects stores as input, got a falsy value");
    const i = t.length < 2;
    return jr(n, (f, o) => {
        let a = !1;
        const l = [];
        let c = 0
          , h = ve;
        const u = () => {
            if (c)
                return;
            h();
            const w = t(r ? l[0] : l, f, o);
            i ? f(w) : h = typeof w == "function" ? w : ve
        }
          , _ = s.map( (w, C) => xn(w, V => {
            l[C] = V,
            c &= ~(1 << C),
            a && u()
        }
        , () => {
            c |= 1 << C
        }
        ));
        return a = !0,
        u(),
        function() {
            Rt(_),
            h(),
            a = !1
        }
    }
    )
}
function js(e) {
    let t;
    return xn(e, n => t = n)(),
    t
}
function Yr(e, t) {
    if (Nt(),
    m) {
        const n = window.__svelte?.h;
        if (n?.has(e))
            return n.get(e);
    }
    return t()
}
function Br() {
    return d === null && Bn(),
    (d.ac ??= new AbortController).signal
}
function An(e) {
    v === null && be(),
    Pe && v.l !== null ? pt(v).m.push(e) : wr( () => {
        const t = Le(e);
        if (typeof t == "function")
            return t
    }
    )
}
function Hr(e) {
    v === null && be(),
    An( () => () => Le(e))
}
function Ur(e, t, {bubbles: n=!1, cancelable: r=!1}={}) {
    return new CustomEvent(e,{
        detail: t,
        bubbles: n,
        cancelable: r
    })
}
function Vr() {
    const e = v;
    return e === null && be(),
    (t, n, r) => {
        const s = e.s.$$events?.[t];
        if (s) {
            const i = kt(s) ? s.slice() : [s]
              , f = Ur(t, n, r);
            for (const o of i)
                o.call(e.x, f);
            return !f.defaultPrevented
        }
        return !0
    }
}
function $r(e) {
    v === null && be(),
    v.l === null && Pt(),
    pt(v).b.push(e)
}
function Wr(e) {
    v === null && be(),
    v.l === null && Pt(),
    pt(v).a.push(e)
}
function pt(e) {
    var t = e.l;
    return t.u ??= {
        a: [],
        b: [],
        m: []
    }
}
const qs = Object.freeze(Object.defineProperty({
    __proto__: null,
    afterUpdate: Wr,
    beforeUpdate: $r,
    createContext: Xn,
    createEventDispatcher: Vr,
    createRawSnippet: Lr,
    flushSync: qe,
    fork: rr,
    getAbortSignal: Br,
    getAllContexts: Zn,
    getContext: Bt,
    hasContext: Ut,
    hydratable: Yr,
    hydrate: Mr,
    mount: En,
    onDestroy: Hr,
    onMount: An,
    setContext: Ht,
    settled: Rr,
    tick: Sr,
    unmount: Ir,
    untrack: Le
}, Symbol.toStringTag, {
    value: "Module"
}));
export {ps as $, _t as A, cr as B, Ne as C, Te as D, p as E, te as F, as as G, Ot as H, Le as I, Pe as J, is as K, ss as L, ls as M, Ee as N, Kr as O, fs as P, ve as Q, vs as R, fe as S, xn as T, js as U, dt as V, Rn as W, Cs as X, Gn as Y, As as Z, Rs as _, Qn as a, Ns as a0, Is as a1, Ds as a2, xs as a3, dr as a4, Hr as a5, v as a6, Ts as a7, zr as a8, Rt as a9, N as aA, ts as aB, ns as aC, Mr as aD, En as aE, qe as aF, Ir as aG, Sr as aH, Xr as aI, os as aJ, St as aK, pr as aL, Cn as aM, Es as aN, et as aO, Ls as aP, qr as aQ, bs as aR, qt as aS, us as aT, gs as aU, bt as aV, Ss as aW, qs as aX, rr as aY, Rr as aZ, ks as aa, hs as ab, ct as ac, pe as ad, _s as ae, Ft as af, Kn as ag, Fr as ah, br as ai, Xe as aj, Lt as ak, He as al, y as am, Gr as an, W as ao, vr as ap, Ie as aq, Sn as ar, kt as as, Qr as at, rs as au, es as av, xr as aw, Re as ax, B as ay, rn as az, ys as b, ws as c, Fs as d, ms as e, Os as f, ee as g, ds as h, Ms as i, Ps as j, Q as k, q as l, an as m, m as n, An as o, Jn as p, D as q, cs as r, J as s, Z as t, wr as u, je as v, j as w, g as x, Ae as y, Jr as z};
typeof window<"u"&&((window.__svelte??={}).v??=new Set).add("5");
import "./DsnmJJEf.js";
import {p as A, u as B, g as s, s as C, f as m, c as I, b as g, d as u, e as p, h as D, i as n, j as w, k as E, r as x, a as G} from "./DsUZB3l6.js";
import {i as b, b as H} from "./BZbNXXnN.js";
import {e as J} from "./DC-LS3Wc.js";
import {p as _} from "./CiAaDbzg.js";
import "./DGLEHYby.js";
var K = m("<!> <!>", 1)
  , N = m("<span>Загрузка...</span>")
  , P = m('<div class="post-list__loading svelte-1srdn5h"><!></div>')
  , Q = m('<div class="post-list svelte-1srdn5h"><!> <div class="post-list__sentinel svelte-1srdn5h" aria-hidden="true"></div> <!></div>');
function $(F, a) {
    A(a, !0);
    let O = _(a, "keyFn", 3, (e, t) => t)
      , S = _(a, "hasMore", 3, !1)
      , M = _(a, "isLoading", 3, !1)
      , V = _(a, "injectSlots", 19, () => []);
    const L = D( () => new Map(V().map(e => [e.afterIndex, e.snippet])));
    let v = C(null)
      , l = null;
    B( () => {
        if (s(v))
            return l?.disconnect(),
            l = new IntersectionObserver(e => {
                e[0]?.isIntersecting && S() && !M() && a.onLoadMore && a.onLoadMore()
            }
            ,{
                rootMargin: "400px",
                threshold: 0
            }),
            l.observe(s(v)),
            () => {
                l?.disconnect()
            }
    }
    );
    var h = Q()
      , j = I(h);
    J(j, 19, () => a.items, (e, t) => O()(e, t), (e, t, o) => {
        var c = K()
          , f = g(c);
        u(f, () => a.children, () => ({
            item: s(t),
            index: s(o)
        }));
        var r = p(f, 2);
        {
            var i = d => {
                var y = w()
                  , z = g(y);
                u(z, () => s(L).get(s(o))),
                n(d, y)
            }
            ;
            b(r, d => {
                s(L).has(s(o)) && d(i)
            }
            )
        }
        n(e, c)
    }
    );
    var k = p(j, 2);
    H(k, e => E(v, e), () => s(v));
    var R = p(k, 2);
    {
        var q = e => {
            var t = P()
              , o = I(t);
            {
                var c = r => {
                    var i = w()
                      , d = g(i);
                    u(d, () => a.loading),
                    n(r, i)
                }
                  , f = r => {
                    var i = N();
                    n(r, i)
                }
                ;
                b(o, r => {
                    a.loading ? r(c) : r(f, !1)
                }
                )
            }
            x(t),
            n(e, t)
        }
        ;
        b(R, e => {
            M() && e(q)
        }
        )
    }
    x(h),
    n(F, h),
    G()
}
export {$ as V};
const p = "modulepreload"
  , y = function(u, i) {
    return new URL(u,i).href
}
  , v = {}
  , w = function(i, a, f) {
    let d = Promise.resolve();
    if (a && a.length > 0) {
        let E = function(e) {
            return Promise.all(e.map(o => Promise.resolve(o).then(s => ({
                status: "fulfilled",
                value: s
            }), s => ({
                status: "rejected",
                reason: s
            }))))
        };
        const r = document.getElementsByTagName("link")
          , t = document.querySelector("meta[property=csp-nonce]")
          , m = t?.nonce || t?.getAttribute("nonce");
        d = E(a.map(e => {
            if (e = y(e, f),
            e in v)
                return;
            v[e] = !0;
            const o = e.endsWith(".css")
              , s = o ? '[rel="stylesheet"]' : "";
            if (f)
                for (let c = r.length - 1; c >= 0; c--) {
                    const l = r[c];
                    if (l.href === e && (!o || l.rel === "stylesheet"))
                        return
                }
            else if (document.querySelector(`link[href="${e}"]${s}`))
                return;
            const n = document.createElement("link");
            if (n.rel = o ? "stylesheet" : p,
            o || (n.as = "script"),
            n.crossOrigin = "",
            n.href = e,
            m && n.setAttribute("nonce", m),
            document.head.appendChild(n),
            o)
                return new Promise( (c, l) => {
                    n.addEventListener("load", c),
                    n.addEventListener("error", () => l(new Error(`Unable to preload CSS for ${e}`)))
                }
                )
        }
        ))
    }
    function h(r) {
        const t = new Event("vite:preloadError",{
            cancelable: !0
        });
        if (t.payload = r,
        window.dispatchEvent(t),
        !t.defaultPrevented)
            throw r
    }
    return d.then(r => {
        for (const t of r || [])
            t.status === "rejected" && h(t.reason);
        return i().catch(h)
    }
    )
};
export {w as _};
import {Q as a, R as f, T as c, k as l, U as b, g as _, V as d, W as p} from "./DsUZB3l6.js";
let u = !1
  , t = Symbol();
function v(e, n, r) {
    const s = r[n] ??= {
        store: null,
        source: f(void 0),
        unsubscribe: a
    };
    if (s.store !== e && !(t in r))
        if (s.unsubscribe(),
        s.store = e ?? null,
        e == null)
            s.source.v = void 0,
            s.unsubscribe = a;
        else {
            var i = !0;
            s.unsubscribe = c(e, o => {
                i ? s.source.v = o : l(s.source, o)
            }
            ),
            i = !1
        }
    return e && t in r ? b(e) : _(s.source)
}
function m() {
    const e = {};
    function n() {
        d( () => {
            for (var r in e)
                e[r].unsubscribe();
            p(e, t, {
                enumerable: !1,
                value: !0
            })
        }
        )
    }
    return [e, n]
}
function y(e) {
    var n = u;
    try {
        return u = !1,
        [e(), u]
    } finally {
        u = n
    }
}
export {v as a, y as c, m as s};
const __vite__mapDeps = (i, m=__vite__mapDeps, d=(m.f || (m.f = ["../nodes/0.CrZbgMS3.js", "../chunks/DsnmJJEf.js", "../chunks/DsUZB3l6.js", "../chunks/BZbNXXnN.js", "../chunks/CMk2kEau.js", "../chunks/SPpZcdEB.js", "../chunks/BzzorF5Q.js", "../chunks/Dbk_u4kD.js", "../chunks/DGLEHYby.js", "../chunks/BHGMQYcz.js", "../chunks/DC-LS3Wc.js", "../chunks/CiAaDbzg.js", "../chunks/B8CBK0oB.js", "../assets/Snowfall.BYUeO2Vb.css", "../assets/0.DLM90LIm.css", "../nodes/1.2aq92iZO.js", "../nodes/2.DEI5OAl6.js", "../nodes/3.BKsIMfJj.js", "../chunks/Du7RJd2N.js", "../chunks/BnQw_d2V.js", "../assets/3.pzK6T3o3.css", "../nodes/4.DpDU5k3X.js", "../assets/4.DMgpEhmC.css", "../nodes/5.iEr-2KIn.js", "../assets/5.OY9PZ2e8.css", "../nodes/6.Du77o2zU.js", "../assets/6.Dx9TMFYi.css", "../nodes/7.CNNOcwSe.js", "../assets/7.BpBzM9te.css", "../nodes/8.Ca2VlAG6.js", "../assets/8.BRITehwB.css", "../nodes/9.B9teUpc1.js", "../assets/9.DqAo0Kcw.css", "../nodes/10.Bzt73xDO.js", "../assets/10.B0tswZqB.css", "../nodes/11.vNMqM4U1.js", "../assets/11.MfHKS-gB.css", "../nodes/12.GwEwf9QR.js", "../assets/12.W0E2KU9j.css", "../nodes/13.CNxEW-bh.js", "../assets/13.DpNgR--q.css", "../nodes/14.B7CUUcNo.js", "../chunks/PPVm8Dsz.js", "../assets/14.Dzi4qB06.css", "../nodes/15.C-MwCr3K.js", "../assets/15.C0bJ_CVT.css"]))) => i.map(i => d[i]);
import {_ as s} from "../chunks/PPVm8Dsz.js";
import {n as B, ac as H, m as W, ad as Y, ah as Z, k as p, O as q, g as u, aD as z, aE as J, aF as K, W as Q, aG as U, R as X, p as $, a7 as tt, u as et, o as rt, s as P, aH as at, f as V, b as E, e as st, i as h, a as ot, j as R, c as nt, r as it, h as O, a0 as _t, Z as mt, a1 as ut} from "../chunks/DsUZB3l6.js";
import "../chunks/DsnmJJEf.js";
import {i as b, b as y} from "../chunks/BZbNXXnN.js";
import {p as A} from "../chunks/CiAaDbzg.js";
function T(n, t, a) {
    B && H();
    var i = new Z(n);
    W( () => {
        var o = t() ?? null;
        i.ensure(o, o && (e => a(e, o)))
    }
    , Y)
}
function ct(n) {
    return class extends lt {
        constructor(t) {
            super({
                component: n,
                ...t
            })
        }
    }
}
class lt {
    #e;
    #t;
    constructor(t) {
        var a = new Map
          , i = (e, r) => {
            var m = X(r, !1, !1);
            return a.set(e, m),
            m
        }
        ;
        const o = new Proxy({
            ...t.props || {},
            $$events: {}
        },{
            get(e, r) {
                return u(a.get(r) ?? i(r, Reflect.get(e, r)))
            },
            has(e, r) {
                return r === q ? !0 : (u(a.get(r) ?? i(r, Reflect.get(e, r))),
                Reflect.has(e, r))
            },
            set(e, r, m) {
                return p(a.get(r) ?? i(r, m), m),
                Reflect.set(e, r, m)
            }
        });
        this.#t = (t.hydrate ? z : J)(t.component, {
            target: t.target,
            anchor: t.anchor,
            props: o,
            context: t.context,
            intro: t.intro ?? !1,
            recover: t.recover
        }),
        (!t?.props?.$$host || t.sync === !1) && K(),
        this.#e = o.$$events;
        for (const e of Object.keys(this.#t))
            e === "$set" || e === "$destroy" || e === "$on" || Q(this, e, {
                get() {
                    return this.#t[e]
                },
                set(r) {
                    this.#t[e] = r
                },
                enumerable: !0
            });
        this.#t.$set = e => {
            Object.assign(o, e)
        }
        ,
        this.#t.$destroy = () => {
            U(this.#t)
        }
    }
    $set(t) {
        this.#t.$set(t)
    }
    $on(t, a) {
        this.#e[t] = this.#e[t] || [];
        const i = (...o) => a.call(this, ...o);
        return this.#e[t].push(i),
        () => {
            this.#e[t] = this.#e[t].filter(o => o !== i)
        }
    }
    $destroy() {
        this.#t.$destroy()
    }
}
const bt = {};
var dt = V('<div id="svelte-announcer" aria-live="assertive" aria-atomic="true" style="position: absolute; left: 0; top: 0; clip: rect(0 0 0 0); clip-path: inset(50%); overflow: hidden; white-space: nowrap; width: 1px; height: 1px"><!></div>')
  , ft = V("<!> <!>", 1);
function ht(n, t) {
    $(t, !0);
    let a = A(t, "components", 23, () => [])
      , i = A(t, "data_0", 3, null)
      , o = A(t, "data_1", 3, null);
    tt( () => t.stores.page.set(t.page)),
    et( () => {
        t.stores,
        t.page,
        t.constructors,
        a(),
        t.form,
        i(),
        o(),
        t.stores.page.notify()
    }
    );
    let e = P(!1)
      , r = P(!1)
      , m = P(null);
    rt( () => {
        const _ = t.stores.page.subscribe( () => {
            u(e) && (p(r, !0),
            at().then( () => {
                p(m, document.title || "untitled page", !0)
            }
            ))
        }
        );
        return p(e, !0),
        _
    }
    );
    const k = O( () => t.constructors[1]);
    var D = ft()
      , I = E(D);
    {
        var w = _ => {
            const c = O( () => t.constructors[0]);
            var l = R()
              , v = E(l);
            T(v, () => u(c), (d, f) => {
                y(f(d, {
                    get data() {
                        return i()
                    },
                    get form() {
                        return t.form
                    },
                    get params() {
                        return t.page.params
                    },
                    children: (g, gt) => {
                        var L = R()
                          , F = E(L);
                        T(F, () => u(k), (M, G) => {
                            y(G(M, {
                                get data() {
                                    return o()
                                },
                                get form() {
                                    return t.form
                                },
                                get params() {
                                    return t.page.params
                                }
                            }), N => a()[1] = N, () => a()?.[1])
                        }
                        ),
                        h(g, L)
                    }
                    ,
                    $$slots: {
                        default: !0
                    }
                }), g => a()[0] = g, () => a()?.[0])
            }
            ),
            h(_, l)
        }
          , j = _ => {
            const c = O( () => t.constructors[0]);
            var l = R()
              , v = E(l);
            T(v, () => u(c), (d, f) => {
                y(f(d, {
                    get data() {
                        return i()
                    },
                    get form() {
                        return t.form
                    },
                    get params() {
                        return t.page.params
                    }
                }), g => a()[0] = g, () => a()?.[0])
            }
            ),
            h(_, l)
        }
        ;
        b(I, _ => {
            t.constructors[1] ? _(w) : _(j, !1)
        }
        )
    }
    var C = st(I, 2);
    {
        var S = _ => {
            var c = dt()
              , l = nt(c);
            {
                var v = d => {
                    var f = _t();
                    mt( () => ut(f, u(m))),
                    h(d, f)
                }
                ;
                b(l, d => {
                    u(r) && d(v)
                }
                )
            }
            it(c),
            h(_, c)
        }
        ;
        b(C, _ => {
            u(e) && _(S)
        }
        )
    }
    h(n, D),
    ot()
}
const yt = ct(ht)
  , At = [ () => s( () => import("../nodes/0.CrZbgMS3.js"), __vite__mapDeps([0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]), import.meta.url), () => s( () => import("../nodes/1.2aq92iZO.js"), __vite__mapDeps([15, 1, 12, 2, 7]), import.meta.url), () => s( () => import("../nodes/2.DEI5OAl6.js"), __vite__mapDeps([16, 1, 12, 2, 7]), import.meta.url), () => s( () => import("../nodes/3.BKsIMfJj.js"), __vite__mapDeps([17, 1, 2, 3, 5, 6, 7, 8, 9, 10, 11, 12, 13, 18, 19, 20]), import.meta.url), () => s( () => import("../nodes/4.DpDU5k3X.js"), __vite__mapDeps([21, 1, 12, 2, 5, 6, 7, 22]), import.meta.url), () => s( () => import("../nodes/5.iEr-2KIn.js"), __vite__mapDeps([23, 1, 2, 3, 10, 9, 7, 12, 8, 11, 5, 6, 13, 24]), import.meta.url), () => s( () => import("../nodes/6.Du77o2zU.js"), __vite__mapDeps([25, 1, 2, 3, 5, 7, 8, 9, 10, 11, 6, 12, 13, 18, 19, 26]), import.meta.url), () => s( () => import("../nodes/7.CNNOcwSe.js"), __vite__mapDeps([27, 1, 2, 3, 10, 9, 7, 28]), import.meta.url), () => s( () => import("../nodes/8.Ca2VlAG6.js"), __vite__mapDeps([29, 1, 2, 3, 5, 6, 7, 8, 9, 10, 11, 12, 13, 18, 19, 30]), import.meta.url), () => s( () => import("../nodes/9.B9teUpc1.js"), __vite__mapDeps([31, 1, 12, 2, 4, 7, 32]), import.meta.url), () => s( () => import("../nodes/10.Bzt73xDO.js"), __vite__mapDeps([33, 1, 12, 2, 4, 7, 34]), import.meta.url), () => s( () => import("../nodes/11.vNMqM4U1.js"), __vite__mapDeps([35, 1, 12, 2, 4, 7, 36]), import.meta.url), () => s( () => import("../nodes/12.GwEwf9QR.js"), __vite__mapDeps([37, 1, 2, 3, 10, 9, 5, 7, 38]), import.meta.url), () => s( () => import("../nodes/13.CNxEW-bh.js"), __vite__mapDeps([39, 1, 2, 3, 10, 8, 9, 11, 5, 6, 7, 12, 13, 19, 40]), import.meta.url), () => s( () => import("../nodes/14.B7CUUcNo.js"), __vite__mapDeps([41, 1, 2, 3, 9, 5, 7, 42, 43]), import.meta.url), () => s( () => import("../nodes/15.C-MwCr3K.js"), __vite__mapDeps([44, 1, 2, 3, 10, 9, 5, 7, 45]), import.meta.url)]
  , Tt = []
  , Dt = {
    "/": [2],
    "/explore": [5],
    "/feed": [6],
    "/forgot-password": [7],
    "/hashtag/[tag]": [8],
    "/legal/cookies": [9],
    "/legal/privacy": [10],
    "/legal/terms": [11],
    "/login": [12],
    "/notifications": [13],
    "/onboarding": [14],
    "/register": [15],
    "/[username]": [3],
    "/[username]/post/[postId]": [4]
}
  , x = {
    handleError: ( ({error: n}) => {}
    ),
    reroute: ( () => {}
    ),
    transport: {}
}
  , vt = Object.fromEntries(Object.entries(x.transport).map( ([n,t]) => [n, t.decode]))
  , It = Object.fromEntries(Object.entries(x.transport).map( ([n,t]) => [n, t.encode]))
  , Lt = !1
  , Vt = (n, t) => vt[n](t);
export {Vt as decode, vt as decoders, Dt as dictionary, It as encoders, Lt as hash, x as hooks, bt as matchers, At as nodes, yt as root, Tt as server_loads};
import {l as o, c as r} from "../chunks/Dbk_u4kD.js";
export {o as load_css, r as start};
import "../chunks/DsnmJJEf.js";
import {f as g, i as o, p as oe, k as X, u as K, g as n, a5 as le, j as Q, b as x, a as ce, s as Z, o as ge, h as _, Y as we, a3 as _e, a4 as be, e as m, c as F, r as B, d as ee} from "../chunks/DsUZB3l6.js";
import {i as S, b as Se} from "../chunks/BZbNXXnN.js";
import {h as ye} from "../chunks/CMk2kEau.js";
import {a as b, s as ke} from "../chunks/SPpZcdEB.js";
import {p as Me} from "../chunks/BzzorF5Q.js";
import {b as Pe, a as Ce, g as te} from "../chunks/Dbk_u4kD.js";
import {s as Ee, e as $e, E as xe, t as Ae, i as ae, g as Le, j as je, k as ne, L as Oe, P as We, a as Te, S as Ue, M as He, C as Ie} from "../chunks/DGLEHYby.js";
import "../chunks/B8CBK0oB.js";
import {j as qe, n as D, k as ie, l as re, i as ze, m as Ne, o as Re, c as Fe, q as se, t as Be} from "../chunks/BHGMQYcz.js";
const De = !1
  , Ke = !1
  , ut = Object.freeze(Object.defineProperty({
    __proto__: null,
    prerender: Ke,
    ssr: De
}, Symbol.toStringTag, {
    value: "Module"
}));
var Qe = g('<aside class="right-sidebar svelte-1f0m1ej"><footer class="right-sidebar__footer svelte-1f0m1ej"><nav class="right-sidebar__links svelte-1f0m1ej"><a href="/legal/terms" class="svelte-1f0m1ej">Условия использования</a> <a href="/legal/privacy" class="svelte-1f0m1ej">Конфиденциальность</a> <a href="/legal/cookies" class="svelte-1f0m1ej">Cookies</a></nav> <p class="right-sidebar__copyright svelte-1f0m1ej">© 2025 итд</p></footer></aside>');
function Ve(y) {
    var v = Qe();
    o(y, v)
}
var Ye = g('<canvas class="snowfall svelte-12vu4pb"></canvas>');
function Ge(y, v) {
    oe(v, !0);
    let i = Z(null)
      , r = null
      , d = 0
      , l = []
      , k = Z(!1)
      , s = null;
    const f = Ee.subscribe(a => {
        X(k, a, !0)
    }
    )
      , U = 100;
    function p() {
        return {
            x: Math.random() * window.innerWidth,
            y: Math.random() * window.innerHeight - window.innerHeight,
            radius: Math.random() * 3 + 1,
            speed: Math.random() * 1 + .5,
            wind: Math.random() * .5 - .25,
            opacity: Math.random() * .5 + .3
        }
    }
    function M() {
        l = [];
        for (let a = 0; a < U; a++) {
            const u = p();
            u.y = Math.random() * window.innerHeight,
            l.push(u)
        }
    }
    function A() {
        for (const a of l)
            a.y += a.speed,
            a.x += a.wind,
            a.y > window.innerHeight && (a.y = -a.radius * 2,
            a.x = Math.random() * window.innerWidth),
            a.x > window.innerWidth ? a.x = 0 : a.x < 0 && (a.x = window.innerWidth)
    }
    function H() {
        if (!(!r || !n(i))) {
            r.clearRect(0, 0, n(i).width, n(i).height);
            for (const a of l)
                r.beginPath(),
                r.arc(a.x, a.y, a.radius, 0, Math.PI * 2),
                r.fillStyle = `rgba(255, 255, 255, ${a.opacity})`,
                r.fill()
        }
    }
    function L() {
        A(),
        H(),
        d = requestAnimationFrame(L)
    }
    function j() {
        n(i) && (n(i).width = window.innerWidth,
        n(i).height = window.innerHeight)
    }
    function I() {
        n(i) && (r = n(i).getContext("2d"),
        j(),
        M(),
        L(),
        s = j,
        window.addEventListener("resize", s))
    }
    function P() {
        d && (cancelAnimationFrame(d),
        d = 0),
        s && (window.removeEventListener("resize", s),
        s = null),
        r = null,
        l = []
    }
    K( () => (n(i) && n(k) && I(),
    () => {
        P()
    }
    )),
    le( () => {
        f(),
        P()
    }
    );
    var C = Q()
      , O = x(C);
    {
        var q = a => {
            var u = Ye();
            Se(u, W => X(i, W), () => n(i)),
            o(a, u)
        }
        ;
        S(O, a => {
            n(k) && a(q)
        }
        )
    }
    o(y, C),
    ce()
}
var Je = g('<link rel="preconnect" href="https://fonts.googleapis.com"/> <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"/> <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&amp;display=swap" rel="stylesheet"/>', 1)
  , Xe = g('<div class="auth-loading svelte-12qhfyh"><!></div>')
  , Ze = g("<!> <!>", 1)
  , et = g('<div class="layout"><!> <main class="content"><!></main> <!> <!></div>')
  , tt = g("<!> <!> <!> <!> <!>", 1);
function ht(y, v) {
    oe(v, !0);
    const i = () => b(Me, "$page", f)
      , r = () => b(Be, "$currentUser", f)
      , d = () => b(Ne, "$isAuthChecked", f)
      , l = () => b(ze, "$isAuthenticated", f)
      , k = () => b(ae, "$isMobile", f)
      , s = () => b(ne, "$postModalStore", f)
      , [f,U] = ke();
    let p = _( () => i().url.pathname === "/login" || i().url.pathname === "/register" || i().url.pathname === "/forgot-password")
      , M = _( () => i().url.pathname === "/onboarding")
      , A = _( () => i().url.pathname.startsWith("/legal"))
      , H = _( () => ["/legal/terms", "/legal/privacy", "/legal/cookies"].includes(i().url.pathname))
      , L = _( () => {
        const e = i().url.pathname;
        if (!r())
            return !1;
        const t = e.slice(1);
        return t.includes("/") ? !1 : t === r().username
    }
    )
      , j = _( () => n(p) || n(A) || n(M) || d() && l());
    ge(async () => {
        Ae.init();
        const e = window.matchMedia("(max-width: 1024px)")
          , t = $ => {
            ae.set($.matches)
        }
        ;
        if (t(e),
        e.addEventListener("change", t),
        n(p) || n(A) || n(M))
            return Re.setChecked(!0),
            () => e.removeEventListener("change", t);
        const {authenticated: h, profileRequired: E} = await Fe.checkAuth();
        return E ? te("/onboarding", {
            replaceState: !0
        }) : h || te("/login", {
            replaceState: !0
        }),
        () => e.removeEventListener("change", t)
    }
    ),
    K( () => {
        !d() || n(p) || (l() ? (qe(),
        D.fetchUnreadCount()) : se())
    }
    ),
    K( () => {
        if (!d() || n(p) || !l())
            return;
        const e = () => {
            document.visibilityState === "visible" && (ie() || (re(),
            D.fetchUnreadCount()))
        }
          , t = () => {
            ie() || (re(),
            D.fetchUnreadCount())
        }
        ;
        return document.addEventListener("visibilitychange", e),
        window.addEventListener("online", t),
        () => {
            document.removeEventListener("visibilitychange", e),
            window.removeEventListener("online", t)
        }
    }
    ),
    le( () => {
        se()
    }
    );
    const I = ["/", "/feed", "/explore", "/notifications"];
    function P(e) {
        if (I.includes(e))
            return e === "/" ? "/feed" : e;
        const t = e.split("/").filter(Boolean);
        return t.length === 1 ? "/profile" : "/" + t[0]
    }
    Pe( ({from: e}) => {
        e?.url?.pathname && Le(e.url.pathname)
    }
    ),
    Ce( ({from: e, to: t, type: h}) => {
        if (!t?.url?.pathname)
            return;
        if (h === "popstate") {
            if (t.url.pathname === "/")
                return;
            const c = je(t.url.pathname);
            c > 0 && setTimeout( () => {
                window.scrollTo({
                    top: c,
                    left: 0,
                    behavior: "instant"
                })
            }
            , 100);
            return
        }
        if (!e?.url?.pathname || e.url.pathname === t.url.pathname)
            return;
        const E = P(e.url.pathname)
          , $ = P(t.url.pathname);
        t.url.pathname !== "/" && E !== $ && window.scrollTo({
            top: 0,
            left: 0,
            behavior: "instant"
        })
    }
    );
    var C = tt();
    ye("12qhfyh", e => {
        var t = Je();
        we(4),
        _e( () => {
            be.title = "итд"
        }
        ),
        o(e, t)
    }
    );
    var O = x(C);
    {
        var q = e => {
            var t = Xe()
              , h = F(t);
            Oe(h, {}),
            B(t),
            o(e, t)
        }
          , a = e => {
            var t = Q()
              , h = x(t);
            {
                var E = c => {
                    var w = Q()
                      , T = x(w);
                    ee(T, () => v.children),
                    o(c, w)
                }
                  , $ = c => {
                    var w = et()
                      , T = F(w);
                    Ue(T, {});
                    var z = m(T, 2)
                      , ue = F(z);
                    ee(ue, () => v.children),
                    B(z);
                    var Y = m(z, 2);
                    Ve(Y);
                    var he = m(Y, 2);
                    {
                        var me = N => {
                            var G = Ze()
                              , J = x(G);
                            He(J, {});
                            var ve = m(J, 2);
                            {
                                var pe = R => {
                                    Ie(R, {})
                                }
                                ;
                                S(ve, R => {
                                    n(L) || R(pe)
                                }
                                )
                            }
                            o(N, G)
                        }
                        ;
                        S(he, N => {
                            k() && N(me)
                        }
                        )
                    }
                    B(w),
                    o(c, w)
                }
                ;
                S(h, c => {
                    n(p) || n(H) || n(M) ? c(E) : c($, !1)
                }
                , !0)
            }
            o(e, t)
        }
        ;
        S(O, e => {
            n(j) ? e(a, !1) : e(q)
        }
        )
    }
    var u = m(O, 2);
    Ge(u, {});
    var W = m(u, 2);
    $e(W, {});
    var V = m(W, 2);
    xe(V, {});
    var de = m(V, 2);
    {
        var fe = e => {
            We(e, {
                children: (t, h) => {
                    Te(t, {
                        get isOpen() {
                            return s().isOpen
                        },
                        get postId() {
                            return s().postId
                        },
                        onClose: () => ne.close()
                    })
                }
                ,
                $$slots: {
                    default: !0
                }
            })
        }
        ;
        S(de, e => {
            s().isOpen && s().postId && e(fe)
        }
        )
    }
    o(y, C),
    ce(),
    U()
}
export {ht as component, ut as universal};
import "../chunks/DsnmJJEf.js";
import {i as u} from "../chunks/B8CBK0oB.js";
import {p as h, f as g, b as l, Z as v, i as d, a as _, c as e, r as s, e as x, a1 as o} from "../chunks/DsUZB3l6.js";
import {s as $, p} from "../chunks/Dbk_u4kD.js";
const b = {
    get error() {
        return p.error
    },
    get status() {
        return p.status
    }
};
$.updated.check;
const i = b;
var k = g("<h1> </h1> <p> </p>", 1);
function w(m, c) {
    h(c, !1),
    u();
    var t = k()
      , r = l(t)
      , n = e(r, !0);
    s(r);
    var a = x(r, 2)
      , f = e(a, !0);
    s(a),
    v( () => {
        o(n, i.status),
        o(f, i.error?.message)
    }
    ),
    d(m, t),
    _()
}
export {w as component};
import "../chunks/DsnmJJEf.js";
import {X as Ee, p as Ve, s as w, D as Ge, u as Xe, k as t, f as _, c as o, g as e, r as s, _ as Xt, i as l, j as ye, b as _e, a as We, e as d, Z as W, a1 as te, h as me, a0 as Ne, Y as Ke, aR as Kt} from "../chunks/DsUZB3l6.js";
import {i as y, b as tt} from "../chunks/BZbNXXnN.js";
import {s as Mt, a as Ye} from "../chunks/SPpZcdEB.js";
import {p as Yt} from "../chunks/BzzorF5Q.js";
import {g as ht, b as Jt} from "../chunks/Dbk_u4kD.js";
import {u as Pe, o as Ft, L as Je, q as nt, d as Qt, A as Ut, f as bt, N as Gt, r as yt, v as $t, x as Qe, y as Ue, p as he, R as ea, D as xt, z as ta, P as aa, a as ra, b as ia} from "../chunks/DGLEHYby.js";
import "../chunks/B8CBK0oB.js";
import {V as sa} from "../chunks/Du7RJd2N.js";
import {e as St, s as ze} from "../chunks/DC-LS3Wc.js";
import {a as kt, A as Pt, r as Dt, b as oa, i as Lt, t as zt, s as at, d as la, u as na} from "../chunks/BHGMQYcz.js";
import {r as va} from "../chunks/BnQw_d2V.js";
const Ct = {
    async getStatus() {
        const J = await kt.get(Pt.verification.status);
        return J.error ? {
            error: J.error.message
        } : {
            data: J.data
        }
    },
    async submitRequest(J) {
        const r = await kt.post(Pt.verification.submit, {
            videoUrl: J
        });
        return r.error ? {
            success: !1,
            error: r.error.message
        } : {
            success: !0
        }
    }
};
function ua(J, r) {
    let g = 0
      , F = null;
    return (...p) => {
        const O = Date.now()
          , U = r - (O - g);
        U <= 0 ? (F && (clearTimeout(F),
        F = null),
        g = O,
        J(...p)) : F || (F = setTimeout( () => {
            g = Date.now(),
            F = null,
            J(...p)
        }
        , U))
    }
}
var da = _('<div class="followers-modal__header svelte-13xi1sg"><h2 class="followers-modal__title svelte-13xi1sg"> </h2> <button class="followers-modal__close svelte-13xi1sg" aria-label="Закрыть"><!></button></div> <div class="followers-modal__search svelte-13xi1sg"><!> <input type="text" placeholder="Поиск" class="followers-modal__search-input svelte-13xi1sg"/></div>', 1)
  , ca = _('<div class="followers-modal__loading svelte-13xi1sg"><!></div>')
  , fa = _('<div class="followers-modal__error svelte-13xi1sg"><p> </p> <button class="svelte-13xi1sg">Повторить</button></div>')
  , _a = _('<div class="followers-modal__empty svelte-13xi1sg"><!></div>')
  , pa = _('<span class="followers-modal__username svelte-13xi1sg"> </span>')
  , ga = _('<button class="followers-modal__edit-btn svelte-13xi1sg">Редактировать</button>')
  , wa = _("<button> </button>")
  , ma = _('<div class="followers-modal__user svelte-13xi1sg" role="button" tabindex="0"><!> <div class="followers-modal__info svelte-13xi1sg"><span class="followers-modal__name svelte-13xi1sg"> </span> <!></div> <!></div>')
  , ha = _('<div class="followers-modal__loading-more svelte-13xi1sg"><!></div>')
  , ba = _("<!> <!>", 1)
  , ya = _('<div class="followers-modal__list svelte-13xi1sg"><!></div>');
function xa(J, r) {
    Ve(r, !0);
    const g = () => Ye(Lt, "$isAuthenticated", p)
      , F = () => Ye(zt, "$currentUser", p)
      , [p,O] = Mt();
    let U = w(Ge([]))
      , B = w(!1)
      , L = w("")
      , S = w("")
      , I = w(1)
      , oe = w(!1)
      , le = w(!1)
      , $ = w(Ge(new Set))
      , re = me( () => e(S).trim() ? e(U).filter(u => u.displayName.toLowerCase().includes(e(S).toLowerCase()) || u.username && u.username.toLowerCase().includes(e(S).toLowerCase())) : e(U));
    Xe( () => {
        r.isOpen && r.username && (t(S, ""),
        t(I, 1),
        H())
    }
    );
    async function H() {
        if (!r.username) {
            t(L, "Не указан пользователь");
            return
        }
        t(B, !0),
        t(L, ""),
        t(U, [], !0);
        try {
            const u = r.type === "followers" ? await Pe.getFollowers(r.username, 1, 30) : await Pe.getFollowing(r.username, 1, 30);
            u.error ? t(L, u.error, !0) : u.data && (t(U, u.data.users, !0),
            t(oe, u.data.pagination.hasMore, !0),
            t(I, 1))
        } catch {
            t(L, "Не удалось загрузить список")
        } finally {
            t(B, !1)
        }
    }
    async function ne() {
        if (e(le) || !e(oe) || !r.username)
            return;
        t(le, !0);
        const u = e(I) + 1;
        try {
            const m = r.type === "followers" ? await Pe.getFollowers(r.username, u, 30) : await Pe.getFollowing(r.username, u, 30);
            m.data && (t(U, [...e(U), ...m.data.users], !0),
            t(oe, m.data.pagination.hasMore, !0),
            t(I, u))
        } catch {} finally {
            t(le, !1)
        }
    }
    function i() {
        t(S, ""),
        t(U, [], !0),
        t(L, ""),
        r.onClose()
    }
    function z(u) {
        i();
        const m = u.username || u.id;
        ht(`/${m}`)
    }
    function Z(u, m) {
        (m.key === "Enter" || m.key === " ") && (m.preventDefault(),
        z(u))
    }
    async function de(u, m) {
        if (m.stopPropagation(),
        !g() || e($).has(u.id))
            return;
        t($, new Set([...e($), u.id]), !0);
        const P = u.isFollowing;
        t(U, e(U).map(Y => Y.id === u.id ? {
            ...Y,
            isFollowing: !P
        } : Y), !0);
        const N = u.username || u.id;
        (P ? await Pe.unfollow(N) : await Pe.follow(N)).success || t(U, e(U).map(Y => Y.id === u.id ? {
            ...Y,
            isFollowing: P
        } : Y), !0),
        t($, new Set([...e($)].filter(Y => Y !== u.id)), !0)
    }
    function ie() {
        return r.type === "followers" ? "Подписчики" : "Подписки"
    }
    const ge = ua(u => {
        const m = u.target;
        m.scrollHeight - m.scrollTop <= m.clientHeight + 100 && ne()
    }
    , 200);
    Ft(J, {
        get isOpen() {
            return r.isOpen
        },
        onClose: i,
        maxWidth: "400px",
        showCloseButton: !1,
        noPadding: !0,
        header: m => {
            var P = da()
              , N = _e(P)
              , se = o(N)
              , Y = o(se, !0);
            s(se);
            var ce = d(se, 2);
            ce.__click = i;
            var R = o(ce);
            nt(R, {
                size: 20
            }),
            s(ce),
            s(N);
            var T = d(N, 2)
              , fe = o(T);
            Qt(fe, {
                size: 18
            });
            var we = d(fe, 2);
            Dt(we),
            s(T),
            W(X => te(Y, X), [ie]),
            oa(we, () => e(S), X => t(S, X)),
            l(m, P)
        }
        ,
        children: (m, P) => {
            var N = ya()
              , se = o(N);
            {
                var Y = R => {
                    var T = ca()
                      , fe = o(T);
                    Je(fe, {}),
                    s(T),
                    l(R, T)
                }
                  , ce = R => {
                    var T = ye()
                      , fe = _e(T);
                    {
                        var we = Q => {
                            var G = fa()
                              , v = o(G)
                              , x = o(v, !0);
                            s(v);
                            var A = d(v, 2);
                            A.__click = H,
                            s(G),
                            W( () => te(x, e(L))),
                            l(Q, G)
                        }
                          , X = Q => {
                            var G = ye()
                              , v = _e(G);
                            {
                                var x = j => {
                                    var K = _a()
                                      , n = o(K);
                                    {
                                        var c = C => {
                                            var b = Ne("Ничего не найдено");
                                            l(C, b)
                                        }
                                          , h = C => {
                                            var b = ye()
                                              , D = _e(b);
                                            {
                                                var ae = ee => {
                                                    var pe = Ne("Пока нет подписчиков");
                                                    l(ee, pe)
                                                }
                                                  , ve = ee => {
                                                    var pe = Ne("Пока нет подписок");
                                                    l(ee, pe)
                                                }
                                                ;
                                                y(D, ee => {
                                                    r.type === "followers" ? ee(ae) : ee(ve, !1)
                                                }
                                                , !0)
                                            }
                                            l(C, b)
                                        }
                                        ;
                                        y(n, C => {
                                            e(S).trim() ? C(c) : C(h, !1)
                                        }
                                        )
                                    }
                                    s(K),
                                    l(j, K)
                                }
                                  , A = j => {
                                    var K = ba()
                                      , n = _e(K);
                                    St(n, 17, () => e(re), C => C.id, (C, b) => {
                                        var D = ma();
                                        D.__click = () => z(e(b)),
                                        D.__keydown = M => Z(e(b), M);
                                        var ae = o(D);
                                        Ut(ae, {
                                            get avatar() {
                                                return e(b).avatar
                                            },
                                            get name() {
                                                return e(b).displayName
                                            },
                                            size: 44
                                        });
                                        var ve = d(ae, 2)
                                          , ee = o(ve)
                                          , pe = o(ee, !0);
                                        s(ee);
                                        var xe = d(ee, 2);
                                        {
                                            var Se = M => {
                                                var q = pa()
                                                  , ue = o(q);
                                                s(q),
                                                W( () => te(ue, `@${e(b).username ?? ""}`)),
                                                l(M, q)
                                            }
                                            ;
                                            y(xe, M => {
                                                e(b).username && M(Se)
                                            }
                                            )
                                        }
                                        s(ve);
                                        var De = d(ve, 2);
                                        {
                                            var Ce = M => {
                                                var q = ga();
                                                q.__click = ue => {
                                                    ue.stopPropagation(),
                                                    i(),
                                                    ht(`/${F()?.username || F()?.id}`)
                                                }
                                                ,
                                                l(M, q)
                                            }
                                              , E = M => {
                                                var q = ye()
                                                  , ue = _e(q);
                                                {
                                                    var Oe = be => {
                                                        var ke = wa();
                                                        let je;
                                                        ke.__click = qe => de(e(b), qe);
                                                        var $e = o(ke, !0);
                                                        s(ke),
                                                        W(qe => {
                                                            je = ze(ke, 1, "followers-modal__follow-btn svelte-13xi1sg", null, je, {
                                                                following: e(b).isFollowing
                                                            }),
                                                            ke.disabled = qe,
                                                            te($e, e(b).isFollowing ? "Отписаться" : "Подписаться")
                                                        }
                                                        , [ () => e($).has(e(b).id)]),
                                                        l(be, ke)
                                                    }
                                                    ;
                                                    y(ue, be => {
                                                        g() && be(Oe)
                                                    }
                                                    , !0)
                                                }
                                                l(M, q)
                                            }
                                            ;
                                            y(De, M => {
                                                g() && F()?.id === e(b).id ? M(Ce) : M(E, !1)
                                            }
                                            )
                                        }
                                        s(D),
                                        W( () => te(pe, e(b).displayName)),
                                        l(C, D)
                                    }
                                    );
                                    var c = d(n, 2);
                                    {
                                        var h = C => {
                                            var b = ha()
                                              , D = o(b);
                                            Je(D, {}),
                                            s(b),
                                            l(C, b)
                                        }
                                        ;
                                        y(c, C => {
                                            e(le) && C(h)
                                        }
                                        )
                                    }
                                    l(j, K)
                                }
                                ;
                                y(v, j => {
                                    e(re).length === 0 ? j(x) : j(A, !1)
                                }
                                , !0)
                            }
                            l(Q, G)
                        }
                        ;
                        y(fe, Q => {
                            e(L) ? Q(we) : Q(X, !1)
                        }
                        , !0)
                    }
                    l(R, T)
                }
                ;
                y(se, R => {
                    e(B) ? R(Y) : R(ce, !1)
                }
                )
            }
            s(N),
            Xt("scroll", N, ge),
            l(m, N)
        }
        ,
        $$slots: {
            header: !0,
            default: !0
        }
    }),
    We(),
    O()
}
Ee(["click", "keydown"]);
var ka = _('<img alt="Баннер профиля" class="profile-banner__image svelte-9mur0y"/>')
  , Pa = _('<div class="profile-banner__gradient svelte-9mur0y"></div>')
  , Ca = _('<button class="profile-banner__btn profile-banner__btn--danger svelte-9mur0y" title="Удалить баннер"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg></button>')
  , Ma = _('<div class="profile-banner__actions svelte-9mur0y"><button class="profile-banner__btn svelte-9mur0y" title="Нарисовать баннер"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="13.5" cy="6.5" r=".5" fill="currentColor"></circle><circle cx="17.5" cy="10.5" r=".5" fill="currentColor"></circle><circle cx="8.5" cy="7.5" r=".5" fill="currentColor"></circle><circle cx="6.5" cy="12.5" r=".5" fill="currentColor"></circle><path d="M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.555C21.965 6.012 17.461 2 12 2z"></path></svg></button> <!></div>')
  , Fa = _("<div><!> <!></div>");
function Ua(J, r) {
    var g = Fa();
    let F;
    var p = o(g);
    {
        var O = S => {
            var I = ka();
            W( () => at(I, "src", r.banner)),
            l(S, I)
        }
          , U = S => {
            var I = Pa();
            l(S, I)
        }
        ;
        y(p, S => {
            r.banner ? S(O) : S(U, !1)
        }
        )
    }
    var B = d(p, 2);
    {
        var L = S => {
            var I = Ma()
              , oe = o(I);
            oe.__click = function(...re) {
                r.onDrawBanner?.apply(this, re)
            }
            ;
            var le = d(oe, 2);
            {
                var $ = re => {
                    var H = Ca();
                    H.__click = function(...ne) {
                        r.onRemoveBanner?.apply(this, ne)
                    }
                    ,
                    W( () => H.disabled = r.isSaving),
                    l(re, H)
                }
                ;
                y(le, re => {
                    r.banner && re($)
                }
                )
            }
            s(I),
            W( () => oe.disabled = r.isSaving),
            l(S, I)
        }
        ;
        y(B, S => {
            r.isOwnProfile && S(L)
        }
        )
    }
    s(g),
    W( () => F = ze(g, 1, "profile-banner svelte-9mur0y", null, F, {
        "has-image": r.banner
    })),
    l(J, g)
}
Ee(["click"]);
var Sa = _('<div class="profile-avatar profile-avatar--emoji svelte-p40znu"><span class="profile-avatar__emoji svelte-p40znu"> </span></div>')
  , Da = _('<div class="profile-avatar no-avatar svelte-p40znu"><!></div>')
  , La = _('<button class="profile-verify-btn svelte-p40znu" title="Подать заявку на верификацию"><!></button>')
  , za = _('<div class="profile-own-actions svelte-p40znu"><button class="profile-edit-btn svelte-p40znu">Редактировать</button> <!></div>')
  , Oa = _('<div class="profile-action__buttons svelte-p40znu"><button> </button> <button class="profile-report-btn svelte-p40znu" title="Пожаловаться"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z"></path><line x1="4" y1="22" x2="4" y2="15"></line></svg></button></div>')
  , Ia = _('<span class="profile-bio__verified svelte-p40znu"><!></span>')
  , Ra = _('<p class="profile-bio__username svelte-p40znu"> </p>')
  , Ta = _('<p class="profile-bio__text svelte-p40znu"> </p>')
  , Aa = _('<div class="profile-meta__item follows-you svelte-p40znu">Подписан на вас</div>')
  , Ba = _('<div class="profile-info svelte-p40znu"><div class="profile-info__row svelte-p40znu"><div class="profile-avatar-wrapper svelte-p40znu"><!></div> <!></div> <div class="profile-bio svelte-p40znu"><div class="profile-bio__name-row svelte-p40znu"><h1 class="profile-bio__name svelte-p40znu"> </h1> <!> <!></div> <!> <!> <div class="profile-meta svelte-p40znu"><div class="profile-meta__item svelte-p40znu"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg> <span> </span></div> <!></div> <div class="profile-stats svelte-p40znu"><button class="profile-stats__item svelte-p40znu"><span class="profile-stats__value svelte-p40znu"> </span> <span class="profile-stats__label svelte-p40znu">Подписки</span></button> <button class="profile-stats__item svelte-p40znu"><span class="profile-stats__value svelte-p40znu"> </span> <span class="profile-stats__label svelte-p40znu">Подписчики</span></button></div></div></div>');
function Na(J, r) {
    Ve(r, !0);
    function g(v) {
        return new Date(v).toLocaleDateString("ru-RU", {
            month: "long",
            year: "numeric"
        })
    }
    var F = Ba()
      , p = o(F)
      , O = o(p)
      , U = o(O);
    {
        var B = v => {
            var x = Sa()
              , A = o(x)
              , j = o(A, !0);
            s(A),
            s(x),
            W( () => te(j, r.profile.avatar)),
            l(v, x)
        }
          , L = v => {
            var x = Da()
              , A = o(x);
            Gt(A, {
                size: 120
            }),
            s(x),
            l(v, x)
        }
        ;
        y(U, v => {
            r.profile.avatar ? v(B) : v(L, !1)
        }
        )
    }
    s(O);
    var S = d(O, 2);
    {
        var I = v => {
            var x = za()
              , A = o(x);
            A.__click = function(...n) {
                r.onEditProfile?.apply(this, n)
            }
            ;
            var j = d(A, 2);
            {
                var K = n => {
                    var c = La();
                    c.__click = function(...C) {
                        r.onVerify?.apply(this, C)
                    }
                    ;
                    var h = o(c);
                    yt(h, {
                        size: 18
                    }),
                    s(c),
                    l(n, c)
                }
                ;
                y(j, n => {
                    r.profile.verified || n(K)
                }
                )
            }
            s(x),
            l(v, x)
        }
          , oe = v => {
            var x = ye()
              , A = _e(x);
            {
                var j = K => {
                    var n = Oa()
                      , c = o(n);
                    c.__click = function(...D) {
                        r.onFollow?.apply(this, D)
                    }
                    ;
                    let h;
                    var C = o(c, !0);
                    s(c);
                    var b = d(c, 2);
                    b.__click = function(...D) {
                        r.onReport?.apply(this, D)
                    }
                    ,
                    s(n),
                    W( () => {
                        h = ze(c, 1, "profile-follow-btn svelte-p40znu", null, h, {
                            following: r.profile.isFollowing
                        }),
                        c.disabled = r.isFollowLoading,
                        te(C, r.profile.isFollowing ? "Отписаться" : "Подписаться")
                    }
                    ),
                    l(K, n)
                }
                ;
                y(A, K => {
                    r.isAuthenticated && K(j)
                }
                , !0)
            }
            l(v, x)
        }
        ;
        y(S, v => {
            r.isOwnProfile ? v(I) : v(oe, !1)
        }
        )
    }
    s(p);
    var le = d(p, 2)
      , $ = o(le)
      , re = o($)
      , H = o(re, !0);
    s(re);
    var ne = d(re, 2);
    {
        var i = v => {
            var x = Ia()
              , A = o(x);
            yt(A, {
                size: 20
            }),
            s(x),
            l(v, x)
        }
        ;
        y(ne, v => {
            r.profile.verified && v(i)
        }
        )
    }
    var z = d(ne, 2);
    {
        var Z = v => {
            $t(v, {
                get pin() {
                    return r.profile.pin
                },
                size: 18
            })
        }
        ;
        y(z, v => {
            r.profile.pin && v(Z)
        }
        )
    }
    s($);
    var de = d($, 2);
    {
        var ie = v => {
            var x = Ra()
              , A = o(x);
            s(x),
            W( () => te(A, `@${r.profile.username ?? ""}`)),
            l(v, x)
        }
        ;
        y(de, v => {
            r.profile.username && v(ie)
        }
        )
    }
    var ge = d(de, 2);
    {
        var u = v => {
            var x = Ta()
              , A = o(x, !0);
            s(x),
            W( () => te(A, r.profile.bio)),
            l(v, x)
        }
        ;
        y(ge, v => {
            r.profile.bio && v(u)
        }
        )
    }
    var m = d(ge, 2)
      , P = o(m)
      , N = d(o(P), 2)
      , se = o(N);
    s(N),
    s(P);
    var Y = d(P, 2);
    {
        var ce = v => {
            var x = Aa();
            l(v, x)
        }
        ;
        y(Y, v => {
            r.profile.isFollowedBy && !r.isOwnProfile && v(ce)
        }
        )
    }
    s(m);
    var R = d(m, 2)
      , T = o(R);
    T.__click = function(...v) {
        r.onFollowingClick?.apply(this, v)
    }
    ;
    var fe = o(T)
      , we = o(fe, !0);
    s(fe),
    Ke(2),
    s(T);
    var X = d(T, 2);
    X.__click = function(...v) {
        r.onFollowersClick?.apply(this, v)
    }
    ;
    var Q = o(X)
      , G = o(Q, !0);
    s(Q),
    Ke(2),
    s(X),
    s(R),
    s(le),
    s(F),
    W( (v, x, A) => {
        te(H, r.profile.displayName),
        te(se, `Регистрация: ${v ?? ""}`),
        te(we, x),
        te(G, A)
    }
    , [ () => g(r.profile.createdAt), () => bt(r.profile.followingCount), () => bt(r.profile.followersCount)]),
    l(J, F),
    We()
}
Ee(["click"]);
var Ea = _('<div class="profile-tabs svelte-1r4i2gu"><button>Посты</button> <button>Понравившиеся</button></div>');
function Va(J, r) {
    Ve(r, !0);
    var g = Ea()
      , F = o(g);
    let p;
    F.__click = () => r.onTabChange("posts");
    var O = d(F, 2);
    let U;
    O.__click = () => r.onTabChange("liked"),
    s(g),
    W( () => {
        p = ze(F, 1, "profile-tab svelte-1r4i2gu", null, p, {
            active: r.activeTab === "posts"
        }),
        U = ze(O, 1, "profile-tab svelte-1r4i2gu", null, U, {
            active: r.activeTab === "liked"
        })
    }
    ),
    l(J, g),
    We()
}
Ee(["click"]);
var Wa = _('<div class="wall-post-form__error svelte-vw1v4s"> </div>')
  , ja = _('<div class="upload-overlay svelte-vw1v4s"><svg class="spinner svelte-vw1v4s" width="24" height="24" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="3" fill="none" stroke-dasharray="31.4" stroke-linecap="round"><animateTransform attributeName="transform" type="rotate" from="0 12 12" to="360 12 12" dur="1s" repeatCount="indefinite"></animateTransform></circle></svg></div>')
  , qa = _('<button class="wall-post-form__edit-btn svelte-vw1v4s" title="Редактировать рисунок"><svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18.37 2.63 14 7l-1.59-1.59a2 2 0 0 0-2.82 0L8 7l9 9 1.59-1.59a2 2 0 0 0 0-2.82L17 10l4.37-4.37a2.12 2.12 0 1 0-3-3Z"></path><path d="M9 8c-2 3-4 3.5-7 4l8 10c2-1 6-5 6-7"></path></svg></button>')
  , Ha = _('<div><img alt="Превью"/> <!> <!> <button class="wall-post-form__remove-btn svelte-vw1v4s"><!></button></div>')
  , Za = _("<div></div>")
  , Xa = _('<span class="wall-post-form__counter svelte-vw1v4s"> </span>')
  , Ka = _('<div class="wall-post-form svelte-vw1v4s"><!> <div class="wall-post-form__inner svelte-vw1v4s"><div class="wall-post-form__avatar svelte-vw1v4s"><!></div> <div class="wall-post-form__content svelte-vw1v4s"><textarea class="wall-post-form__textarea svelte-vw1v4s"></textarea> <!></div></div> <div class="wall-post-form__toolbar svelte-vw1v4s"><div class="wall-post-form__attach svelte-vw1v4s"><input type="file" class="wall-post-form__file-input svelte-vw1v4s" accept="image/*" multiple/> <button class="wall-post-form__attach-btn svelte-vw1v4s" title="Прикрепить файлы"><svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l9.19-9.19a4 4 0 0 1 5.66 5.66l-9.2 9.19a2 2 0 0 1-2.83-2.83l8.49-8.48"></path></svg></button> <button class="wall-post-form__attach-btn svelte-vw1v4s" title="Нарисовать"><svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18.37 2.63 14 7l-1.59-1.59a2 2 0 0 0-2.82 0L8 7l9 9 1.59-1.59a2 2 0 0 0 0-2.82L17 10l4.37-4.37a2.12 2.12 0 1 0-3-3Z"></path><path d="M9 8c-2 3-4 3.5-7 4l8 10c2-1 6-5 6-7"></path><path d="M14.5 17.5 4.5 15"></path></svg></button> <!></div> <button class="wall-post-form__submit svelte-vw1v4s"> </button></div></div>');
function Ya(J, r) {
    Ve(r, !0);
    const g = 10;
    let F = w(""), p = w(Ge([])), O, U, B = w(!1), L = w(""), S = me( () => e(p).some(n => n.isUploading)), I = me( () => e(p).filter(n => n.uploaded).map(n => n.uploaded)), oe = me( () => !e(F).trim() && e(I).length === 0 || e(B) || e(S)), le = me( () => e(p).length < g);
    function $(n) {
        const c = n.target;
        t(F, c.value, !0),
        c.style.height = "auto",
        c.style.height = `${Math.min(c.scrollHeight, 200)}px`
    }
    async function re(n) {
        const h = n.target.files;
        if (!h || h.length === 0)
            return;
        const C = g - e(p).length
          , b = Array.from(h).slice(0, C);
        for (const D of b) {
            const ae = crypto.randomUUID()
              , ve = new FileReader;
            ve.onload = ee => {
                const pe = ee.target?.result
                  , xe = {
                    id: ae,
                    preview: pe,
                    file: D,
                    isUploading: !0
                };
                t(p, [...e(p), xe], !0),
                H(ae, D)
            }
            ,
            ve.readAsDataURL(D)
        }
        O && (O.value = "")
    }
    async function H(n, c) {
        const h = await Qe.uploadFile(c);
        t(p, e(p).map(C => {
            if (C.id === n) {
                if (h.error)
                    return {
                        ...C,
                        isUploading: !1,
                        error: h.error
                    };
                if (h.data)
                    return {
                        ...C,
                        isUploading: !1,
                        uploaded: h.data
                    }
            }
            return C
        }
        ), !0)
    }
    async function ne(n) {
        const c = e(p).find(h => h.id === n);
        c?.uploaded && await Qe.deleteFile(c.uploaded.id),
        t(p, e(p).filter(h => h.id !== n), !0)
    }
    async function i() {
        if (!e(F).trim() && e(I).length === 0)
            return;
        t(B, !0),
        t(L, "");
        const n = e(I).length > 0 ? e(I).map(h => h.id) : void 0
          , c = await r.onPostCreated(n, e(F));
        !c.success && c.error ? t(L, c.error, !0) : (t(F, ""),
        t(p, [], !0),
        U && (U.style.height = "auto")),
        t(B, !1)
    }
    function z(n, c) {
        const h = crypto.randomUUID()
          , C = {
            id: h,
            preview: n,
            file: c,
            isUploading: !0,
            isDrawing: !0
        };
        t(p, [...e(p), C], !0),
        H(h, c)
    }
    function Z(n, c, h) {
        const C = e(p)[n];
        C?.uploaded && Qe.deleteFile(C.uploaded.id);
        const b = C.id;
        t(p, e(p).map( (D, ae) => ae === n ? {
            ...D,
            preview: c,
            file: h,
            uploaded: void 0,
            isUploading: !0
        } : D), !0),
        H(b, h)
    }
    function de(n) {
        return e(p)[n]
    }
    function ie() {
        return e(p)
    }
    var ge = {
        addDrawing: z,
        updateDrawing: Z,
        getDrawingItem: de,
        getMediaItems: ie
    }
      , u = Ka()
      , m = o(u);
    {
        var P = n => {
            var c = Wa()
              , h = o(c, !0);
            s(c),
            W( () => te(h, e(L))),
            l(n, c)
        }
        ;
        y(m, n => {
            e(L) && n(P)
        }
        )
    }
    var N = d(m, 2)
      , se = o(N)
      , Y = o(se);
    Ut(Y, {
        get avatar() {
            return r.currentUserAvatar
        },
        get name() {
            return r.currentUserName
        },
        size: 40
    }),
    s(se);
    var ce = d(se, 2)
      , R = o(ce);
    Kt(R),
    R.__input = $,
    tt(R, n => U = n, () => U);
    var T = d(R, 2);
    {
        var fe = n => {
            var c = Za();
            let h;
            St(c, 23, () => e(p), C => C.id, (C, b) => {
                var D = Ha();
                let ae;
                var ve = o(D);
                let ee;
                var pe = d(ve, 2);
                {
                    var xe = M => {
                        var q = ja();
                        l(M, q)
                    }
                    ;
                    y(pe, M => {
                        e(b).isUploading && M(xe)
                    }
                    )
                }
                var Se = d(pe, 2);
                {
                    var De = M => {
                        var q = qa();
                        q.__click = () => {}
                        ,
                        l(M, q)
                    }
                    ;
                    y(Se, M => {
                        e(b).isDrawing && !e(b).isUploading && M(De)
                    }
                    )
                }
                var Ce = d(Se, 2);
                Ce.__click = () => ne(e(b).id);
                var E = o(Ce);
                nt(E, {
                    size: 14
                }),
                s(Ce),
                s(D),
                W( () => {
                    ae = ze(D, 1, "wall-post-form__preview-item svelte-vw1v4s", null, ae, {
                        "is-drawing": e(b).isDrawing
                    }),
                    at(ve, "src", e(b).preview),
                    ee = ze(ve, 1, "svelte-vw1v4s", null, ee, {
                        uploading: e(b).isUploading
                    }),
                    Ce.disabled = e(b).isUploading
                }
                ),
                l(C, D)
            }
            ),
            s(c),
            W( () => h = ze(c, 1, "wall-post-form__previews svelte-vw1v4s", null, h, {
                single: e(p).length === 1
            })),
            l(n, c)
        }
        ;
        y(T, n => {
            e(p).length > 0 && n(fe)
        }
        )
    }
    s(ce),
    s(N);
    var we = d(N, 2)
      , X = o(we)
      , Q = o(X);
    Q.__change = re,
    tt(Q, n => O = n, () => O);
    var G = d(Q, 2);
    G.__click = () => O?.click();
    var v = d(G, 2);
    v.__click = function(...n) {
        r.onOpenDrawing?.apply(this, n)
    }
    ;
    var x = d(v, 2);
    {
        var A = n => {
            var c = Xa()
              , h = o(c);
            s(c),
            W( () => te(h, `${e(p).length ?? ""}/10`)),
            l(n, c)
        }
        ;
        y(x, n => {
            e(p).length > 0 && n(A)
        }
        )
    }
    s(X);
    var j = d(X, 2);
    j.__click = i;
    var K = o(j, !0);
    return s(j),
    s(we),
    s(u),
    W( () => {
        la(R, e(F)),
        at(R, "placeholder", r.isOwnProfile ? "Что у вас нового?" : `Написать на стене ${r.recipientName}...`),
        G.disabled = !e(le),
        v.disabled = !e(le),
        j.disabled = e(oe),
        te(K, e(B) ? "Публикация..." : "Опубликовать")
    }
    ),
    l(J, u),
    We(ge)
}
Ee(["input", "click", "change"]);
var Ja = _('<div class="verification-loading svelte-14bvw1i"><div class="spinner svelte-14bvw1i"></div> <p>Загрузка...</p></div>')
  , Qa = _('<div class="verification-status verified svelte-14bvw1i"><div class="status-icon svelte-14bvw1i"><svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path><polyline points="22 4 12 14.01 9 11.01"></polyline></svg></div> <h3 class="svelte-14bvw1i">Вы верифицированы!</h3> <p class="svelte-14bvw1i">Ваш аккаунт уже имеет галочку верификации.</p></div>')
  , Ga = _('<div class="verification-status pending svelte-14bvw1i"><div class="status-icon svelte-14bvw1i"><svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg></div> <h3 class="svelte-14bvw1i">Заявка на рассмотрении</h3> <p class="svelte-14bvw1i"> </p> <p class="hint svelte-14bvw1i">Мы рассмотрим её в ближайшее время и уведомим вас о результате.</p></div>')
  , $a = _('<p class="rejection-reason svelte-14bvw1i"> </p>')
  , er = _('<div class="verification-status rejected svelte-14bvw1i"><div class="status-icon svelte-14bvw1i"><svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"></circle><line x1="15" y1="9" x2="9" y2="15"></line><line x1="9" y1="9" x2="15" y2="15"></line></svg></div> <h3 class="svelte-14bvw1i">Заявка отклонена</h3> <!> <p class="hint svelte-14bvw1i">Вы можете подать новую заявку.</p> <div class="new-request svelte-14bvw1i"><button class="btn-new-request svelte-14bvw1i">Подать новую заявку</button></div></div>')
  , tr = _('<div class="error-message svelte-14bvw1i"> </div>')
  , ar = _('<div class="video-preview svelte-14bvw1i"><video controls class="svelte-14bvw1i"><track kind="captions"/></video> <button class="remove-video svelte-14bvw1i"><!></button></div>', 2)
  , rr = _('<div class="upload-area svelte-14bvw1i" role="button" tabindex="0"><input type="file" accept="video/mp4,video/webm,video/quicktime" class="hidden-input svelte-14bvw1i"/> <div class="upload-icon svelte-14bvw1i"><svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="23 7 16 12 23 17 23 7"></polygon><rect x="1" y="5" width="15" height="14" rx="2" ry="2"></rect></svg></div> <p class="upload-text svelte-14bvw1i">Нажмите, чтобы выбрать видео</p> <p class="upload-hint svelte-14bvw1i">MP4, WebM или MOV, до 50 МБ</p></div>')
  , ir = _('<div class="verification-form svelte-14bvw1i"><p class="form-description svelte-14bvw1i">Запишите видео, в котором объясните, почему вам нужна галочка и без неё никак.</p> <!> <div class="video-upload svelte-14bvw1i"><!></div> <label class="consent-checkbox svelte-14bvw1i"><input type="checkbox" class="svelte-14bvw1i"/> <span class="svelte-14bvw1i">Я соглашаюсь с тем, что моё видео может быть использовано в контенте Nowkie</span></label> <div class="form-actions svelte-14bvw1i"><button class="btn-cancel svelte-14bvw1i">Отмена</button> <button class="btn-submit svelte-14bvw1i"><!></button></div></div>');
function sr(J, r) {
    Ve(r, !0);
    let g = w(null), F = w(!0), p = w(null), O = w(null), U = w(!1), B = w(!1), L = w(""), S, I = w(!1);
    const oe = 50 * 1024 * 1024
      , le = ["video/mp4", "video/webm", "video/quicktime"];
    Xe( () => {
        r.isOpen && $()
    }
    );
    async function $() {
        t(F, !0),
        t(L, "");
        const Z = await Ct.getStatus();
        Z.data ? t(g, Z.data, !0) : t(L, Z.error || "Не удалось загрузить статус", !0),
        t(F, !1)
    }
    function re(Z) {
        const ie = Z.target.files?.[0];
        if (!ie)
            return;
        if (!le.includes(ie.type)) {
            t(L, "Поддерживаются только видеофайлы (MP4, WebM, MOV)");
            return
        }
        if (ie.size > oe) {
            t(L, "Максимальный размер видео - 50 МБ");
            return
        }
        t(L, ""),
        t(p, ie, !0);
        const ge = URL.createObjectURL(ie);
        t(O, ge, !0)
    }
    function H() {
        e(O) && URL.revokeObjectURL(e(O)),
        t(p, null),
        t(O, null),
        S && (S.value = "")
    }
    async function ne() {
        if (!e(p)) {
            t(L, "Выберите видео для загрузки");
            return
        }
        t(B, !0),
        t(U, !0),
        t(L, "");
        const Z = await Qe.uploadFile(e(p));
        if (Z.error || !Z.data) {
            t(L, Z.error || "Не удалось загрузить видео", !0),
            t(B, !1),
            t(U, !1);
            return
        }
        t(U, !1);
        const de = await Ct.submitRequest(Z.data.url);
        if (!de.success) {
            t(L, de.error || "Не удалось отправить заявку", !0),
            t(B, !1);
            return
        }
        t(B, !1),
        await $(),
        r.onSuccess && r.onSuccess()
    }
    function i() {
        e(B) || (H(),
        r.onClose())
    }
    function z(Z) {
        return new Date(Z).toLocaleString("ru-RU", {
            day: "numeric",
            month: "long",
            year: "numeric",
            hour: "2-digit",
            minute: "2-digit"
        })
    }
    Ft(J, {
        get isOpen() {
            return r.isOpen
        },
        title: "Верификация",
        maxWidth: "500px",
        onClose: i,
        get closeDisabled() {
            return e(B)
        },
        children: de => {
            var ie = ye()
              , ge = _e(ie);
            {
                var u = P => {
                    var N = Ja();
                    l(P, N)
                }
                  , m = P => {
                    var N = ye()
                      , se = _e(N);
                    {
                        var Y = R => {
                            var T = Qa();
                            l(R, T)
                        }
                          , ce = R => {
                            var T = ye()
                              , fe = _e(T);
                            {
                                var we = Q => {
                                    var G = Ga()
                                      , v = d(o(G), 4)
                                      , x = o(v);
                                    s(v),
                                    Ke(2),
                                    s(G),
                                    W(A => te(x, `Ваша заявка отправлена ${A ?? ""}`), [ () => e(g).submittedAt ? z(e(g).submittedAt) : ""]),
                                    l(Q, G)
                                }
                                  , X = Q => {
                                    var G = ye()
                                      , v = _e(G);
                                    {
                                        var x = j => {
                                            var K = er()
                                              , n = d(o(K), 4);
                                            {
                                                var c = b => {
                                                    var D = $a()
                                                      , ae = o(D);
                                                    s(D),
                                                    W( () => te(ae, `Причина: ${e(g).rejectionReason ?? ""}`)),
                                                    l(b, D)
                                                }
                                                ;
                                                y(n, b => {
                                                    e(g).rejectionReason && b(c)
                                                }
                                                )
                                            }
                                            var h = d(n, 4)
                                              , C = o(h);
                                            C.__click = () => t(g, {
                                                status: "none"
                                            }, !0),
                                            s(h),
                                            s(K),
                                            l(j, K)
                                        }
                                          , A = j => {
                                            var K = ir()
                                              , n = d(o(K), 2);
                                            {
                                                var c = E => {
                                                    var M = tr()
                                                      , q = o(M, !0);
                                                    s(M),
                                                    W( () => te(q, e(L))),
                                                    l(E, M)
                                                }
                                                ;
                                                y(n, E => {
                                                    e(L) && E(c)
                                                }
                                                )
                                            }
                                            var h = d(n, 2)
                                              , C = o(h);
                                            {
                                                var b = E => {
                                                    var M = ar()
                                                      , q = o(M)
                                                      , ue = d(q, 2);
                                                    ue.__click = H;
                                                    var Oe = o(ue);
                                                    nt(Oe, {
                                                        size: 16
                                                    }),
                                                    s(ue),
                                                    s(M),
                                                    W( () => {
                                                        at(q, "src", e(O)),
                                                        ue.disabled = e(B)
                                                    }
                                                    ),
                                                    l(E, M)
                                                }
                                                  , D = E => {
                                                    var M = rr();
                                                    M.__click = () => S?.click(),
                                                    M.__keydown = ue => ue.key === "Enter" && S?.click();
                                                    var q = o(M);
                                                    q.__change = re,
                                                    tt(q, ue => S = ue, () => S),
                                                    Ke(6),
                                                    s(M),
                                                    l(E, M)
                                                }
                                                ;
                                                y(C, E => {
                                                    e(O) ? E(b) : E(D, !1)
                                                }
                                                )
                                            }
                                            s(h);
                                            var ae = d(h, 2)
                                              , ve = o(ae);
                                            Dt(ve),
                                            Ke(2),
                                            s(ae);
                                            var ee = d(ae, 2)
                                              , pe = o(ee);
                                            pe.__click = i;
                                            var xe = d(pe, 2);
                                            xe.__click = ne;
                                            var Se = o(xe);
                                            {
                                                var De = E => {
                                                    var M = Ne("Загрузка видео...");
                                                    l(E, M)
                                                }
                                                  , Ce = E => {
                                                    var M = ye()
                                                      , q = _e(M);
                                                    {
                                                        var ue = be => {
                                                            var ke = Ne("Отправка...");
                                                            l(be, ke)
                                                        }
                                                          , Oe = be => {
                                                            var ke = Ne("Отправить заявку");
                                                            l(be, ke)
                                                        }
                                                        ;
                                                        y(q, be => {
                                                            e(B) ? be(ue) : be(Oe, !1)
                                                        }
                                                        , !0)
                                                    }
                                                    l(E, M)
                                                }
                                                ;
                                                y(Se, E => {
                                                    e(U) ? E(De) : E(Ce, !1)
                                                }
                                                )
                                            }
                                            s(xe),
                                            s(ee),
                                            s(K),
                                            W( () => {
                                                ve.disabled = e(B),
                                                pe.disabled = e(B),
                                                xe.disabled = !e(p) || !e(I) || e(B)
                                            }
                                            ),
                                            na(ve, () => e(I), E => t(I, E)),
                                            l(j, K)
                                        }
                                        ;
                                        y(v, j => {
                                            e(g)?.status === "rejected" ? j(x) : j(A, !1)
                                        }
                                        , !0)
                                    }
                                    l(Q, G)
                                }
                                ;
                                y(fe, Q => {
                                    e(g)?.status === "pending" ? Q(we) : Q(X, !1)
                                }
                                , !0)
                            }
                            l(R, T)
                        }
                        ;
                        y(se, R => {
                            e(g)?.status === "verified" ? R(Y) : R(ce, !1)
                        }
                        , !0)
                    }
                    l(P, N)
                }
                ;
                y(ge, P => {
                    e(F) ? P(u) : P(m, !1)
                }
                )
            }
            l(de, ie)
        }
        ,
        $$slots: {
            default: !0
        }
    }),
    We()
}
Ee(["click", "keydown", "change"]);
var or = _('<div class="profile-loading svelte-14luta1"><!></div>')
  , lr = _('<div class="profile-error svelte-14luta1"><p> </p></div>')
  , nr = _('<div class="profile-loading svelte-14luta1"><!></div>')
  , vr = _('<div class="profile-empty svelte-14luta1"> </div>')
  , ur = _('<div class="profile-posts svelte-14luta1"><!></div>')
  , dr = _('<div class="profile-card svelte-14luta1"><!> <!> <!> <!> <!></div>')
  , cr = _("<!> <!>", 1)
  , fr = _("<!> <!> <!> <!> <!> <!> <!>", 1);
function Fr(J, r) {
    Ve(r, !0);
    const g = () => Ye(zt, "$currentUser", O)
      , F = () => Ye(Lt, "$isAuthenticated", O)
      , p = () => Ye(Yt, "$page", O)
      , [O,U] = Mt();
    let B = w(!1)
      , L = w(!1)
      , S = w("followers")
      , I = w(!1)
      , oe = w(null)
      , le = w("post")
      , $ = w(!1);
    const re = typeof window < "u" ? new URL(window.location.href).searchParams.get("post") : null;
    let H = w(!!re), ne = w(Ge(re)), i = w(null), z = w(Ge([])), Z = w(!0), de = w(!1), ie = w(""), ge = w(!1), u = w(null), m = w(!1), P = w("posts"), N = w(!1), se = w(!1), Y = w(null), ce = w(""), R = w(!1), T = w(!1), fe = w(!1), we, X = me( () => !e(i) || !g()?.id ? !1 : g().id === e(i).id), Q = me( () => !F() || !e(i) ? !1 : e(X) ? !0 : !(e(i).wallClosed || e(i).isPrivate && !e(i).isFollowing));
    Xe( () => {
        const a = p().params.username;
        a && a !== e(ce) && (t(ce, a, !0),
        typeof window < "u" && (document.body.scrollTop = 0),
        v(a))
    }
    ),
    Xe( () => {
        if (typeof window > "u")
            return;
        const a = () => {
            const f = new URL(window.location.href).searchParams.get("post");
            f ? (t(ne, f, !0),
            t(H, !0)) : (t(H, !1),
            t(ne, null))
        }
        ;
        return window.addEventListener("popstate", a),
        () => window.removeEventListener("popstate", a)
    }
    );
    let G = w(null);
    Xe( () => {
        if (!g() || !e(i) || g().id !== e(i).id)
            return;
        const a = `${g().displayName}|${g().username}|${g().bio}|${g().avatar}`;
        e(G) !== a && (t(G, a),
        t(i, {
            ...e(i),
            displayName: g().displayName,
            username: g().username || e(i).username,
            bio: g().bio || e(i).bio,
            avatar: g().avatar || e(i).avatar
        }, !0))
    }
    );
    async function v(a) {
        t(ie, "");
        const f = Ue.getProfile(a);
        if (f) {
            t(i, f.profile, !0);
            const Me = e(P) === "posts" ? f.posts : f.liked;
            t(z, Me.posts, !0),
            t(u, Me.nextCursor, !0),
            t(m, Me.hasMore, !0),
            t(Z, !1),
            t(se, !0),
            x(a);
            return
        }
        t(Z, !0),
        t(i, null),
        t(z, [], !0);
        const [k,V] = await Promise.all([Pe.getProfile(a), e(P) === "posts" ? he.getUserPosts(a, {
            limit: 20
        }) : he.getLikedPosts(a, {
            limit: 20
        })]);
        if (k.error) {
            t(ie, k.error, !0),
            t(Z, !1);
            return
        }
        t(i, k.data, !0),
        V.data && (t(z, V.data.posts, !0),
        t(u, V.data.pagination.nextCursor, !0),
        t(m, V.data.pagination.hasMore, !0),
        Ue.setProfile(a, e(i), {
            posts: e(z),
            nextCursor: e(u),
            hasMore: e(m)
        }, e(P))),
        t(Z, !1)
    }
    async function x(a) {
        const [f,k] = await Promise.all([Pe.getProfile(a), e(P) === "posts" ? he.getUserPosts(a, {
            limit: 20
        }) : he.getLikedPosts(a, {
            limit: 20
        })]);
        f.data && (t(i, f.data, !0),
        k.data && (t(z, k.data.posts, !0),
        t(u, k.data.pagination.nextCursor, !0),
        t(m, k.data.pagination.hasMore, !0),
        Ue.setProfile(a, e(i), {
            posts: e(z),
            nextCursor: e(u),
            hasMore: e(m)
        }, e(P)))),
        t(se, !1)
    }
    async function A() {
        if (!e(i))
            return;
        const a = e(i).username
          , f = Ue.getProfile(a);
        if (f) {
            const V = e(P) === "posts" ? f.posts : f.liked;
            if (V.posts.length > 0) {
                t(z, V.posts, !0),
                t(u, V.nextCursor, !0),
                t(m, V.hasMore, !0),
                t(N, !1),
                t(se, !0),
                j();
                return
            }
        }
        t(N, !0),
        t(z, [], !0),
        t(u, null),
        t(m, !1);
        const k = e(P) === "posts" ? await he.getUserPosts(a, {
            limit: 20
        }) : await he.getLikedPosts(a, {
            limit: 20
        });
        k.data && (t(z, k.data.posts, !0),
        t(u, k.data.pagination.nextCursor, !0),
        t(m, k.data.pagination.hasMore, !0),
        Ue.setPostsTab(a, e(P), {
            posts: e(z),
            nextCursor: e(u),
            hasMore: e(m)
        })),
        t(N, !1)
    }
    async function j() {
        if (!e(i))
            return;
        const a = e(i).username
          , f = e(P) === "posts" ? await he.getUserPosts(a, {
            limit: 20
        }) : await he.getLikedPosts(a, {
            limit: 20
        });
        f.data && (t(z, f.data.posts, !0),
        t(u, f.data.pagination.nextCursor, !0),
        t(m, f.data.pagination.hasMore, !0),
        Ue.setPostsTab(a, e(P), {
            posts: e(z),
            nextCursor: e(u),
            hasMore: e(m)
        })),
        t(se, !1)
    }
    async function K(a) {
        e(P) !== a && (t(P, a, !0),
        await A())
    }
    async function n() {
        if (e(de) || !e(m) || !e(u) || !e(i))
            return;
        t(de, !0);
        const a = e(i).username
          , f = e(P) === "posts" ? await he.getUserPosts(a, {
            cursor: e(u),
            limit: 20
        }) : await he.getLikedPosts(a, {
            cursor: e(u),
            limit: 20
        });
        if (f.data) {
            const k = new Set(e(z).map(Me => Me.id))
              , V = f.data.posts.filter(Me => !k.has(Me.id));
            t(z, [...e(z), ...V], !0),
            t(u, f.data.pagination.nextCursor, !0),
            t(m, f.data.pagination.hasMore, !0),
            Ue.appendPosts(a, e(P), V, e(u), e(m))
        }
        t(de, !1)
    }
    async function c() {
        if (!e(i) || e(ge) || !F())
            return;
        t(ge, !0);
        const a = e(i).isFollowing
          , f = e(i).username;
        t(i, {
            ...e(i),
            isFollowing: !a,
            followersCount: a ? e(i).followersCount - 1 : e(i).followersCount + 1
        }, !0),
        Ue.updateProfile(f, {
            isFollowing: !a,
            followersCount: e(i).followersCount
        });
        const k = f || e(i).id;
        (a ? await Pe.unfollow(k) : await Pe.follow(k)).success || (t(i, {
            ...e(i),
            isFollowing: a,
            followersCount: a ? e(i).followersCount + 1 : e(i).followersCount - 1
        }, !0),
        Ue.updateProfile(f, {
            isFollowing: a,
            followersCount: e(i).followersCount
        })),
        t(ge, !1)
    }
    function h(a) {
        t(oe, a, !0),
        t(le, "post"),
        t(I, !0)
    }
    function C() {
        e(i) && (t(oe, e(i).id, !0),
        t(le, "user"),
        t(I, !0))
    }
    async function b(a, f) {
        e(oe) && await va.createReport({
            targetType: e(le),
            targetId: e(oe),
            reason: a,
            description: f || void 0
        })
    }
    function D(a) {
        F() && he.recordView(a)
    }
    async function ae(a) {
        if (!e(i))
            return;
        (await he.pinPost(a)).success && t(i, {
            ...e(i),
            pinnedPostId: a
        }, !0)
    }
    async function ve(a) {
        if (!e(i))
            return;
        (await he.unpinPost(a)).success && t(i, {
            ...e(i),
            pinnedPostId: null
        }, !0)
    }
    let ee = me( () => {
        if (!e(i)?.pinnedPostId || e(P) !== "posts")
            return e(z);
        const a = e(z).findIndex(V => V.id === e(i).pinnedPostId);
        if (a === -1)
            return e(z);
        const f = e(z)[a]
          , k = [...e(z).slice(0, a), ...e(z).slice(a + 1)];
        return [f, ...k]
    }
    );
    function pe() {
        return e(P) === "posts" ? "Пока нет постов" : "Пока нет понравившихся постов"
    }
    function xe(a, f) {
        t(ne, a, !0),
        t(H, !0);
        const k = e(i)?.username || e(ce);
        k && history.pushState({
            modal: !0,
            postId: a
        }, "", `/${k}?post=${a}`)
    }
    function Se() {
        e(H) && (t(H, !1),
        t(ne, null),
        history.back())
    }
    Jt( () => {
        if (e(H)) {
            t(H, !1),
            t(ne, null);
            const a = new URL(window.location.href);
            a.searchParams.has("post") && (a.searchParams.delete("post"),
            history.replaceState({}, "", `/${e(i)?.username || e(ce)}`))
        }
    }
    );
    function De(a) {
        t(S, a, !0),
        t(L, !0)
    }
    function Ce() {
        t(R, !0)
    }
    function E() {
        t(R, !1)
    }
    async function M(a, f) {
        t(T, !0);
        const k = new File([a],`banner-${Date.now()}.png`,{
            type: "image/png"
        })
          , V = await Qe.uploadFile(k);
        if (V.error || !V.data) {
            t(T, !1),
            E();
            return
        }
        (await Pe.updateProfile({
            bannerId: V.data.id
        })).data && e(i) && t(i, {
            ...e(i),
            banner: V.data.url
        }, !0),
        t(T, !1),
        E()
    }
    async function q() {
        if (!e(i)?.banner)
            return;
        t(T, !0),
        (await Pe.updateProfile({
            bannerId: null
        })).data && e(i) && t(i, {
            ...e(i),
            banner: void 0
        }, !0),
        t(T, !1)
    }
    async function ue(a, f) {
        if (!e(i))
            return {
                success: !1,
                error: "No profile"
            };
        const k = await he.createPost({
            content: f,
            attachmentIds: a,
            wallRecipientId: e(X) ? void 0 : e(i).id
        });
        return k.error ? {
            success: !1,
            error: k.error
        } : (k.data && e(P) === "posts" && (t(z, [k.data, ...e(z)], !0),
        Ue.prependPost(e(i).username, k.data),
        t(Y, k.data.id, !0),
        requestAnimationFrame( () => {
            const V = document.querySelector(`[data-post-id="${k.data.id}"]`);
            V && V.scrollIntoView({
                behavior: "smooth",
                block: "center"
            })
        }
        ),
        setTimeout( () => {
            t(Y, null)
        }
        , 2500)),
        {
            success: !0
        })
    }
    function Oe() {
        t(fe, !0)
    }
    function be() {
        t(fe, !1)
    }
    async function ke(a, f) {
        const k = new File([a],`drawing-${Date.now()}.png`,{
            type: "image/png"
        });
        we?.addDrawing(f, k),
        be()
    }
    var je = fr()
      , $e = _e(je);
    {
        var qe = a => {
            var f = or()
              , k = o(f);
            Je(k, {}),
            s(f),
            l(a, f)
        }
          , Ot = a => {
            var f = ye()
              , k = _e(f);
            {
                var V = Re => {
                    var Te = lr()
                      , et = o(Te)
                      , rt = o(et, !0);
                    s(et),
                    s(Te),
                    W( () => te(rt, e(ie))),
                    l(Re, Te)
                }
                  , Me = Re => {
                    var Te = ye()
                      , et = _e(Te);
                    {
                        var rt = it => {
                            var st = dr()
                              , _t = o(st);
                            Ua(_t, {
                                get banner() {
                                    return e(i).banner
                                },
                                get isOwnProfile() {
                                    return e(X)
                                },
                                get isSaving() {
                                    return e(T)
                                },
                                onDrawBanner: Ce,
                                onRemoveBanner: q
                            });
                            var pt = d(_t, 2);
                            Na(pt, {
                                get profile() {
                                    return e(i)
                                },
                                get isOwnProfile() {
                                    return e(X)
                                },
                                get isAuthenticated() {
                                    return F()
                                },
                                get isFollowLoading() {
                                    return e(ge)
                                },
                                onEditProfile: () => t(B, !0),
                                onVerify: () => t($, !0),
                                onFollow: c,
                                onReport: C,
                                onFollowersClick: () => De("followers"),
                                onFollowingClick: () => De("following")
                            });
                            var gt = d(pt, 2);
                            Va(gt, {
                                get activeTab() {
                                    return e(P)
                                },
                                onTabChange: K
                            });
                            var wt = d(gt, 2);
                            {
                                var Bt = Fe => {
                                    {
                                        let Le = me( () => g()?.avatar)
                                          , He = me( () => g()?.displayName);
                                        tt(Ya(Fe, {
                                            get currentUserAvatar() {
                                                return e(Le)
                                            },
                                            get currentUserName() {
                                                return e(He)
                                            },
                                            get recipientName() {
                                                return e(i).displayName
                                            },
                                            get isOwnProfile() {
                                                return e(X)
                                            },
                                            onPostCreated: ue,
                                            onOpenDrawing: Oe
                                        }), ot => we = ot, () => we)
                                    }
                                }
                                ;
                                y(wt, Fe => {
                                    e(P) === "posts" && e(Q) && Fe(Bt)
                                }
                                )
                            }
                            var Nt = d(wt, 2);
                            {
                                var Et = Fe => {
                                    var Le = nr()
                                      , He = o(Le);
                                    Je(He, {}),
                                    s(Le),
                                    l(Fe, Le)
                                }
                                  , Vt = Fe => {
                                    var Le = ye()
                                      , He = _e(Le);
                                    {
                                        var ot = Ae => {
                                            var Ie = vr()
                                              , lt = o(Ie, !0);
                                            s(Ie),
                                            W(mt => te(lt, mt), [pe]),
                                            l(Ae, Ie)
                                        }
                                          , Wt = Ae => {
                                            var Ie = ur()
                                              , lt = o(Ie);
                                            sa(lt, {
                                                get items() {
                                                    return e(ee)
                                                },
                                                keyFn: Ze => Ze.id,
                                                onLoadMore: n,
                                                get hasMore() {
                                                    return e(m)
                                                },
                                                get isLoading() {
                                                    return e(de)
                                                },
                                                children: (Ze, jt) => {
                                                    let Be = () => jt?.().item;
                                                    {
                                                        let qt = me( () => e(i)?.pinnedPostId === Be().id)
                                                          , Ht = me( () => e(X) && e(P) === "posts")
                                                          , Zt = me( () => e(Y) === Be().id);
                                                        ia(Ze, {
                                                            get post() {
                                                                return Be()
                                                            },
                                                            get isPinned() {
                                                                return e(qt)
                                                            },
                                                            get canPin() {
                                                                return e(Ht)
                                                            },
                                                            get isHighlighted() {
                                                                return e(Zt)
                                                            },
                                                            get isWallOwner() {
                                                                return e(X)
                                                            },
                                                            onReport: () => h(Be().id),
                                                            onView: D,
                                                            onPin: () => ae(Be().id),
                                                            onUnpin: () => ve(Be().id),
                                                            onModalOpen: xe
                                                        })
                                                    }
                                                }
                                                ,
                                                loading: Ze => {
                                                    Je(Ze, {})
                                                }
                                                ,
                                                $$slots: {
                                                    default: !0,
                                                    loading: !0
                                                }
                                            }),
                                            s(Ie),
                                            l(Ae, Ie)
                                        }
                                        ;
                                        y(He, Ae => {
                                            e(ee).length === 0 ? Ae(ot) : Ae(Wt, !1)
                                        }
                                        , !0)
                                    }
                                    l(Fe, Le)
                                }
                                ;
                                y(Nt, Fe => {
                                    e(N) ? Fe(Et) : Fe(Vt, !1)
                                }
                                )
                            }
                            s(st),
                            l(it, st)
                        }
                        ;
                        y(et, it => {
                            e(i) && it(rt)
                        }
                        , !0)
                    }
                    l(Re, Te)
                }
                ;
                y(k, Re => {
                    e(ie) ? Re(V) : Re(Me, !1)
                }
                , !0)
            }
            l(a, f)
        }
        ;
        y($e, a => {
            e(Z) ? a(qe) : a(Ot, !1)
        }
        )
    }
    var vt = d($e, 2);
    {
        var It = a => {
            var f = cr()
              , k = _e(f);
            ta(k, {
                get isOpen() {
                    return e(B)
                },
                onClose: () => t(B, !1)
            });
            var V = d(k, 2);
            sr(V, {
                get isOpen() {
                    return e($)
                },
                onClose: () => t($, !1)
            }),
            l(a, f)
        }
        ;
        y(vt, a => {
            e(X) && a(It)
        }
        )
    }
    var ut = d(vt, 2);
    {
        var Rt = a => {
            {
                let f = me( () => e(i).username || e(i).id);
                xa(a, {
                    get isOpen() {
                        return e(L)
                    },
                    get type() {
                        return e(S)
                    },
                    get username() {
                        return e(f)
                    },
                    onClose: () => t(L, !1)
                })
            }
        }
        ;
        y(ut, a => {
            e(i) && a(Rt)
        }
        )
    }
    var dt = d(ut, 2);
    ea(dt, {
        get isOpen() {
            return e(I)
        },
        onClose: () => t(I, !1),
        onSubmit: b
    });
    var ct = d(dt, 2);
    xt(ct, {
        get isOpen() {
            return e(fe)
        },
        onSave: ke,
        onClose: be
    });
    var ft = d(ct, 2);
    {
        let a = me( () => e(i)?.banner);
        xt(ft, {
            get isOpen() {
                return e(R)
            },
            get initialImage() {
                return e(a)
            },
            onSave: M,
            onClose: E,
            aspectRatio: 3,
            get isSaving() {
                return e(T)
            }
        })
    }
    var Tt = d(ft, 2);
    {
        var At = a => {
            aa(a, {
                children: (f, k) => {
                    ra(f, {
                        get isOpen() {
                            return e(H)
                        },
                        get postId() {
                            return e(ne)
                        },
                        onClose: Se
                    })
                }
                ,
                $$slots: {
                    default: !0
                }
            })
        }
        ;
        y(Tt, a => {
            e(H) && e(ne) && a(At)
        }
        )
    }
    l(J, je),
    We(),
    U()
}
export {Fr as component};
import "../chunks/DsnmJJEf.js";
import {X as Ie, p as Pe, s as L, D as Z, o as Ae, f as i, c as s, Z as R, i as v, a as Le, k as n, g as e, e as r, r as a, j as me, b as re, h as We, a1 as m} from "../chunks/DsUZB3l6.js";
import {i as w} from "../chunks/BZbNXXnN.js";
import {e as G, s as Ue, i as Ve} from "../chunks/DC-LS3Wc.js";
import {a as je, A as qe, r as Be, d as Ee} from "../chunks/BHGMQYcz.js";
import {g as we} from "../chunks/Dbk_u4kD.js";
import "../chunks/B8CBK0oB.js";
import {d as Me, w as M, h as Oe, u as ke, L as be, A as Te, V as Ce, f as de} from "../chunks/DGLEHYby.js";
const Qe = {
    async search(ve, le=5, F=5) {
        const $ = await je.get(qe.search.global, {
            q: ve,
            userLimit: le,
            hashtagLimit: F
        });
        return $.error ? {
            error: $.error.message
        } : {
            data: $.data
        }
    }
};
var Xe = i('<div class="explore-loading svelte-1w567vk"><!></div>')
  , Ze = i('<div class="explore-section svelte-1w567vk"><div class="explore-section__loading svelte-1w567vk"><!></div></div>')
  , Ge = i('<div class="explore-section svelte-1w567vk"><p class="explore-section__empty svelte-1w567vk"> </p></div>')
  , Je = i('<span class="explore-user__username svelte-1w567vk"> </span>')
  , Ke = i('<button class="explore-user svelte-1w567vk"><!> <div class="explore-user__info svelte-1w567vk"><span class="explore-user__name svelte-1w567vk"> <!></span> <!> <span class="explore-user__followers svelte-1w567vk"> </span></div></button>')
  , Ye = i('<div class="explore-section svelte-1w567vk"><h3 class="explore-section__title svelte-1w567vk">Пользователи</h3> <!></div>')
  , ea = i('<button class="explore-hashtag svelte-1w567vk"><div class="explore-hashtag__icon svelte-1w567vk">#</div> <div class="explore-hashtag__info svelte-1w567vk"><span class="explore-hashtag__name svelte-1w567vk"> </span> <span class="explore-hashtag__count svelte-1w567vk"> </span></div></button>')
  , aa = i('<div class="explore-section svelte-1w567vk"><h3 class="explore-section__title svelte-1w567vk">Хэштеги</h3> <!></div>')
  , sa = i("<!> <!>", 1)
  , ta = i('<button class="explore-hashtag svelte-1w567vk"><div class="explore-hashtag__rank svelte-1w567vk"> </div> <div class="explore-hashtag__info svelte-1w567vk"><span class="explore-hashtag__name svelte-1w567vk"> </span> <span class="explore-hashtag__count svelte-1w567vk"> </span></div></button>')
  , ra = i('<div class="explore-section svelte-1w567vk"><h3 class="explore-section__title svelte-1w567vk">Популярные хэштеги</h3> <!></div>')
  , va = i('<span class="explore-user__username svelte-1w567vk"> </span>')
  , la = i('<span class="explore-user__mutual svelte-1w567vk"> </span>')
  , oa = i('<span class="explore-user__followers svelte-1w567vk"> </span>')
  , na = i('<button class="explore-user svelte-1w567vk"><!> <div class="explore-user__info svelte-1w567vk"><span class="explore-user__name svelte-1w567vk"> <!></span> <!> <!></div></button>')
  , ia = i('<div class="explore-section svelte-1w567vk"><h3 class="explore-section__title svelte-1w567vk">Кого читать</h3> <!></div>')
  , _a = i('<div><span class="explore-clan__rank svelte-1w567vk"></span> <span class="explore-clan__avatar svelte-1w567vk"> </span> <span class="explore-clan__count svelte-1w567vk"> </span></div>')
  , pa = i('<div class="explore-section svelte-1w567vk"><h3 class="explore-section__title svelte-1w567vk">Топ кланов</h3> <div class="explore-clans svelte-1w567vk"></div></div>')
  , da = i('<div class="explore-empty svelte-1w567vk"><p>Пока нет данных для отображения</p> <p class="explore-empty__hint svelte-1w567vk">Создавайте посты с хэштегами, чтобы они появились здесь!</p></div>')
  , ca = i("<!> <!> <!> <!>", 1)
  , ua = i('<div class="explore-content svelte-1w567vk"><!></div>')
  , ha = i('<div class="explore-card svelte-1w567vk"><header class="explore-header svelte-1w567vk"><div class="explore-search svelte-1w567vk"><input type="text" placeholder="Поиск пользователей и хэштегов" class="explore-search__input svelte-1w567vk"/> <span class="explore-search__icon svelte-1w567vk"><!></span></div></header> <!></div>');
function Ca(ve, le) {
    Pe(le, !0);
    let F = L(Z([])), $ = L(Z([])), W = L(Z([])), J = L(!0), K = L(""), j = L(Z([])), q = L(Z([])), Y = L(!1), ce;
    Ae(async () => {
        await ye()
    }
    );
    async function ye() {
        const t = M.getWhoToFollow()
          , _ = M.getTopClans()
          , f = M.getTrendingHashtags();
        if (t && _ && f) {
            n($, t, !0),
            n(W, _, !0),
            n(F, f, !0),
            n(J, !1);
            return
        }
        n(J, !0);
        const B = [];
        f || B.push(Oe.getTrending(10)),
        t || B.push(ke.getWhoToFollow()),
        _ || B.push(ke.getTopClans());
        const O = await Promise.all(B);
        let z = 0;
        if (f)
            n(F, f, !0);
        else {
            const k = O[z++];
            k.data && (n(F, k.data.hashtags, !0),
            M.setTrendingHashtags(e(F)))
        }
        if (t)
            n($, t, !0);
        else {
            const k = O[z++];
            k.data && (n($, k.data, !0),
            M.setWhoToFollow(e($)))
        }
        if (_)
            n(W, _, !0);
        else {
            const k = O[z++];
            k.data && (n(W, k.data, !0),
            M.setTopClans(e(W)))
        }
        n(J, !1)
    }
    function Se(t) {
        const _ = t.target.value;
        if (n(K, _, !0),
        clearTimeout(ce),
        !_.trim()) {
            n(j, [], !0),
            n(q, [], !0),
            n(Y, !1);
            return
        }
        n(Y, !0),
        ce = setTimeout(async () => {
            const f = await Qe.search(_, 5, 5);
            f.data ? (n(q, f.data.users || [], !0),
            n(j, f.data.hashtags || [], !0)) : (n(q, [], !0),
            n(j, [], !0)),
            n(Y, !1)
        }
        , 500)
    }
    function ue(t) {
        we(`/hashtag/${t}`)
    }
    function he(t) {
        we(`/${t}`)
    }
    function fe(t) {
        if (t === 0)
            return "Нет постов";
        if (t === 1)
            return "1 пост";
        if (t >= 1e6)
            return (t / 1e6).toFixed(1).replace(/\.0$/, "") + " млн постов";
        if (t >= 1e3)
            return (t / 1e3).toFixed(1).replace(/\.0$/, "") + " тыс. постов";
        const _ = t % 10
          , f = t % 100;
        return f >= 11 && f <= 14 ? `${t} постов` : _ === 1 ? `${t} пост` : _ >= 2 && _ <= 4 ? `${t} поста` : `${t} постов`
    }
    let $e = We( () => e(j).length > 0 || e(q).length > 0);
    var oe = ha()
      , ne = s(oe)
      , xe = s(ne)
      , ee = s(xe);
    Be(ee),
    ee.__input = Se;
    var ge = r(ee, 2)
      , Ne = s(ge);
    Me(Ne, {
        size: 18
    }),
    a(ge),
    a(xe),
    a(ne);
    var Re = r(ne, 2);
    {
        var ze = t => {
            var _ = Xe()
              , f = s(_);
            be(f, {}),
            a(_),
            v(t, _)
        }
          , De = t => {
            var _ = ua()
              , f = s(_);
            {
                var B = z => {
                    var k = me()
                      , ae = re(k);
                    {
                        var ie = A => {
                            var H = Ze()
                              , E = s(H)
                              , Q = s(E);
                            be(Q, {}),
                            a(E),
                            a(H),
                            v(A, H)
                        }
                          , se = A => {
                            var H = me()
                              , E = re(H);
                            {
                                var Q = l => {
                                    var p = Ge()
                                      , S = s(p)
                                      , T = s(S);
                                    a(S),
                                    a(p),
                                    R( () => m(T, `Ничего не найдено по запросу "${e(K) ?? ""}"`)),
                                    v(l, p)
                                }
                                  , _e = l => {
                                    var p = sa()
                                      , S = re(p);
                                    {
                                        var T = c => {
                                            var h = Ye()
                                              , C = r(s(h), 2);
                                            G(C, 17, () => e(q), x => x.id, (x, o) => {
                                                var g = Ke();
                                                g.__click = () => he(e(o).username?.trim() || e(o).id);
                                                var y = s(g);
                                                Te(y, {
                                                    get avatar() {
                                                        return e(o).avatar
                                                    },
                                                    get name() {
                                                        return e(o).displayName
                                                    },
                                                    size: 44
                                                });
                                                var D = r(y, 2)
                                                  , I = s(D)
                                                  , U = s(I)
                                                  , X = r(U);
                                                {
                                                    var u = P => {
                                                        Ce(P, {
                                                            size: 16
                                                        })
                                                    }
                                                    ;
                                                    w(X, P => {
                                                        e(o).verified && P(u)
                                                    }
                                                    )
                                                }
                                                a(I);
                                                var b = r(I, 2);
                                                {
                                                    var V = P => {
                                                        var pe = Je()
                                                          , He = s(pe);
                                                        a(pe),
                                                        R( () => m(He, `@${e(o).username ?? ""}`)),
                                                        v(P, pe)
                                                    }
                                                    ;
                                                    w(b, P => {
                                                        e(o).username && P(V)
                                                    }
                                                    )
                                                }
                                                var te = r(b, 2)
                                                  , Fe = s(te);
                                                a(te),
                                                a(D),
                                                a(g),
                                                R(P => {
                                                    m(U, `${e(o).displayName ?? ""} `),
                                                    m(Fe, `${P ?? ""} подписчиков`)
                                                }
                                                , [ () => de(e(o).followersCount)]),
                                                v(x, g)
                                            }
                                            ),
                                            a(h),
                                            v(c, h)
                                        }
                                        ;
                                        w(S, c => {
                                            e(q).length > 0 && c(T)
                                        }
                                        )
                                    }
                                    var d = r(S, 2);
                                    {
                                        var N = c => {
                                            var h = aa()
                                              , C = r(s(h), 2);
                                            G(C, 17, () => e(j), x => x.id, (x, o) => {
                                                var g = ea();
                                                g.__click = () => ue(e(o).name);
                                                var y = r(s(g), 2)
                                                  , D = s(y)
                                                  , I = s(D);
                                                a(D);
                                                var U = r(D, 2)
                                                  , X = s(U, !0);
                                                a(U),
                                                a(y),
                                                a(g),
                                                R(u => {
                                                    m(I, `#${e(o).name ?? ""}`),
                                                    m(X, u)
                                                }
                                                , [ () => fe(e(o).postsCount)]),
                                                v(x, g)
                                            }
                                            ),
                                            a(h),
                                            v(c, h)
                                        }
                                        ;
                                        w(d, c => {
                                            e(j).length > 0 && c(N)
                                        }
                                        )
                                    }
                                    v(l, p)
                                }
                                ;
                                w(E, l => {
                                    e($e) ? l(_e, !1) : l(Q)
                                }
                                , !0)
                            }
                            v(A, H)
                        }
                        ;
                        w(ae, A => {
                            e(Y) ? A(ie) : A(se, !1)
                        }
                        )
                    }
                    v(z, k)
                }
                  , O = z => {
                    var k = ca()
                      , ae = re(k);
                    {
                        var ie = l => {
                            var p = ra()
                              , S = r(s(p), 2);
                            G(S, 19, () => e(F), T => T.id, (T, d, N) => {
                                var c = ta();
                                c.__click = () => ue(e(d).name);
                                var h = s(c)
                                  , C = s(h, !0);
                                a(h);
                                var x = r(h, 2)
                                  , o = s(x)
                                  , g = s(o);
                                a(o);
                                var y = r(o, 2)
                                  , D = s(y, !0);
                                a(y),
                                a(x),
                                a(c),
                                R(I => {
                                    m(C, e(N) + 1),
                                    m(g, `#${e(d).name ?? ""}`),
                                    m(D, I)
                                }
                                , [ () => fe(e(d).postsCount)]),
                                v(T, c)
                            }
                            ),
                            a(p),
                            v(l, p)
                        }
                        ;
                        w(ae, l => {
                            e(F).length > 0 && l(ie)
                        }
                        )
                    }
                    var se = r(ae, 2);
                    {
                        var A = l => {
                            var p = ia()
                              , S = r(s(p), 2);
                            G(S, 17, () => e($), T => T.id, (T, d) => {
                                var N = na();
                                N.__click = () => he(e(d).username?.trim() || e(d).id);
                                var c = s(N);
                                Te(c, {
                                    get avatar() {
                                        return e(d).avatar
                                    },
                                    get name() {
                                        return e(d).displayName
                                    },
                                    size: 44
                                });
                                var h = r(c, 2)
                                  , C = s(h)
                                  , x = s(C)
                                  , o = r(x);
                                {
                                    var g = u => {
                                        Ce(u, {
                                            size: 16
                                        })
                                    }
                                    ;
                                    w(o, u => {
                                        e(d).verified && u(g)
                                    }
                                    )
                                }
                                a(C);
                                var y = r(C, 2);
                                {
                                    var D = u => {
                                        var b = va()
                                          , V = s(b);
                                        a(b),
                                        R( () => m(V, `@${e(d).username ?? ""}`)),
                                        v(u, b)
                                    }
                                    ;
                                    w(y, u => {
                                        e(d).username && u(D)
                                    }
                                    )
                                }
                                var I = r(y, 2);
                                {
                                    var U = u => {
                                        var b = la()
                                          , V = s(b);
                                        a(b),
                                        R( () => m(V, `${e(d).mutualCount ?? ""} общих подписчика`)),
                                        v(u, b)
                                    }
                                      , X = u => {
                                        var b = oa()
                                          , V = s(b);
                                        a(b),
                                        R(te => m(V, `${te ?? ""} подписчиков`), [ () => de(e(d).followersCount)]),
                                        v(u, b)
                                    }
                                    ;
                                    w(I, u => {
                                        e(d).mutualCount > 0 ? u(U) : u(X, !1)
                                    }
                                    )
                                }
                                a(h),
                                a(N),
                                R( () => m(x, `${e(d).displayName ?? ""} `)),
                                v(T, N)
                            }
                            ),
                            a(p),
                            v(l, p)
                        }
                        ;
                        w(se, l => {
                            e($).length > 0 && l(A)
                        }
                        )
                    }
                    var H = r(se, 2);
                    {
                        var E = l => {
                            var p = pa()
                              , S = r(s(p), 2);
                            G(S, 21, () => e(W), Ve, (T, d, N) => {
                                var c = _a();
                                Ue(c, 1, "explore-clan svelte-1w567vk", null, {}, {
                                    "is-top-3": N < 3
                                });
                                var h = s(c);
                                h.textContent = N + 1;
                                var C = r(h, 2)
                                  , x = s(C, !0);
                                a(C);
                                var o = r(C, 2)
                                  , g = s(o, !0);
                                a(o),
                                a(c),
                                R(y => {
                                    m(x, e(d).avatar),
                                    m(g, y)
                                }
                                , [ () => de(e(d).memberCount)]),
                                v(T, c)
                            }
                            ),
                            a(S),
                            a(p),
                            v(l, p)
                        }
                        ;
                        w(H, l => {
                            e(W).length > 0 && l(E)
                        }
                        )
                    }
                    var Q = r(H, 2);
                    {
                        var _e = l => {
                            var p = da();
                            v(l, p)
                        }
                        ;
                        w(Q, l => {
                            e(F).length === 0 && e($).length === 0 && e(W).length === 0 && l(_e)
                        }
                        )
                    }
                    v(z, k)
                }
                ;
                w(f, z => {
                    e(K).trim() ? z(B) : z(O, !1)
                }
                )
            }
            a(_),
            v(t, _)
        }
        ;
        w(Re, t => {
            e(J) ? t(ze) : t(De, !1)
        }
        )
    }
    a(oe),
    R( () => Ee(ee, e(K))),
    v(ve, oe),
    Le()
}
Ie(["input", "click"]);
export {Ca as component};
import "../chunks/DsnmJJEf.js";
import {X as Ce, p as ce, f as k, c, e as f, Z as J, i as g, a as de, r as l, s as u, D as q, o as xe, k as a, j as le, b as ae, g as t, a1 as D, _ as Ue, u as Me, h as je} from "../chunks/DsUZB3l6.js";
import {i as I, b as Ye} from "../chunks/BZbNXXnN.js";
import {a as Le, s as ze} from "../chunks/SPpZcdEB.js";
import {g as He, a as Xe, b as Ze} from "../chunks/Dbk_u4kD.js";
import {w as ie, u as ne, A as Ge, V as Je, l as G, p as Se, R as Qe, m as et, n as tt, L as $e, P as at, a as st, b as ot} from "../chunks/DGLEHYby.js";
import "../chunks/B8CBK0oB.js";
import {V as rt} from "../chunks/Du7RJd2N.js";
import {s as ue, e as Re} from "../chunks/DC-LS3Wc.js";
import {p as nt} from "../chunks/CiAaDbzg.js";
import {i as lt} from "../chunks/BHGMQYcz.js";
import {r as it} from "../chunks/BnQw_d2V.js";
var ut = k('<header class="feed-tabs svelte-1thmq55"><button>Популярное</button> <button>Подписки</button></header>');
function ct(B, $) {
    ce($, !0);
    let h = nt($, "activeTab", 3, "popular");
    function T(_) {
        $.onTabChange?.(_)
    }
    var d = ut()
      , i = c(d);
    let C;
    i.__click = () => T("popular");
    var x = f(i, 2);
    let o;
    x.__click = () => T("following"),
    l(d),
    J( () => {
        C = ue(i, 1, "feed-tab svelte-1thmq55", null, C, {
            active: h() === "popular"
        }),
        o = ue(x, 1, "feed-tab svelte-1thmq55", null, o, {
            active: h() === "following"
        })
    }
    ),
    g(B, d),
    de()
}
Ce(["click"]);
var dt = k('<span class="user-card__handle svelte-1u9eu0j"> </span>')
  , vt = k('<article class="user-card svelte-1u9eu0j"><button class="user-card__link svelte-1u9eu0j"><!> <span class="user-card__name svelte-1u9eu0j"> <!></span> <!></button> <button> </button></article>')
  , ft = k('<section class="suggestions svelte-1u9eu0j"><header class="suggestions__header svelte-1u9eu0j"><h3 class="suggestions__title svelte-1u9eu0j">Кого читать</h3> <div class="suggestions__controls svelte-1u9eu0j"><button class="suggestions__arrow svelte-1u9eu0j" aria-label="Назад"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><polyline points="15 18 9 12 15 6"></polyline></svg></button> <button class="suggestions__arrow svelte-1u9eu0j" aria-label="Вперёд"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><polyline points="9 18 15 12 9 6"></polyline></svg></button></div></header> <div class="suggestions__scroll svelte-1u9eu0j"><div class="suggestions__track svelte-1u9eu0j"></div></div></section>');
function pt(B, $) {
    ce($, !0);
    let h = u(q([]))
      , T = u(!0)
      , d = u(q(new Set))
      , i = null
      , C = u(!1)
      , x = u(!0);
    xe(async () => {
        const v = ie.getWhoToFollow();
        if (v) {
            a(h, v, !0),
            a(T, !1),
            setTimeout(o, 100);
            return
        }
        const r = await ne.getWhoToFollow();
        r.data && (a(h, r.data, !0),
        ie.setWhoToFollow(r.data)),
        a(T, !1),
        setTimeout(o, 100)
    }
    );
    function o() {
        i && (a(C, i.scrollLeft > 5),
        a(x, i.scrollLeft < i.scrollWidth - i.clientWidth - 5))
    }
    function _() {
        i && i.scrollBy({
            left: -170,
            behavior: "smooth"
        })
    }
    function F() {
        i && i.scrollBy({
            left: 170,
            behavior: "smooth"
        })
    }
    async function N(v, r) {
        v.stopPropagation();
        const n = r.username?.trim() || r.id;
        t(d).has(r.id) ? (await ne.unfollow(n)).success && (t(d).delete(r.id),
        a(d, new Set(t(d)), !0)) : (await ne.follow(n)).success && (t(d).add(r.id),
        a(d, new Set(t(d)), !0))
    }
    function K(v) {
        He(`/${v.username?.trim() || v.id}`)
    }
    var W = le()
      , A = ae(W);
    {
        var U = v => {
            var r = ft()
              , n = c(r)
              , M = f(c(n), 2)
              , y = c(M);
            y.__click = _;
            var R = f(y, 2);
            R.__click = F,
            l(M),
            l(n);
            var p = f(n, 2)
              , j = c(p);
            Re(j, 21, () => t(h), S => S.id, (S, m) => {
                var Y = vt()
                  , b = c(Y);
                b.__click = () => K(t(m));
                var P = c(b);
                Ge(P, {
                    get avatar() {
                        return t(m).avatar
                    },
                    get name() {
                        return t(m).displayName
                    },
                    size: 72
                });
                var E = f(P, 2)
                  , se = c(E)
                  , ve = f(se);
                {
                    var oe = w => {
                        Je(w, {})
                    }
                    ;
                    I(ve, w => {
                        t(m).verified && w(oe)
                    }
                    )
                }
                l(E);
                var fe = f(E, 2);
                {
                    var pe = w => {
                        var V = dt()
                          , he = c(V);
                        l(V),
                        J( () => D(he, `@${t(m).username ?? ""}`)),
                        g(w, V)
                    }
                    ;
                    I(fe, w => {
                        t(m).username && w(pe)
                    }
                    )
                }
                l(b);
                var z = f(b, 2);
                let re;
                z.__click = w => N(w, t(m));
                var ge = c(z, !0);
                l(z),
                l(Y),
                J( (w, V) => {
                    D(se, `${t(m).displayName ?? ""} `),
                    re = ue(z, 1, "user-card__follow svelte-1u9eu0j", null, re, w),
                    D(ge, V)
                }
                , [ () => ({
                    "is-following": t(d).has(t(m).id)
                }), () => t(d).has(t(m).id) ? "Отписаться" : "Подписаться"]),
                g(S, Y)
            }
            ),
            l(j),
            l(p),
            Ye(p, S => i = S, () => i),
            l(r),
            J( () => {
                y.disabled = !t(C),
                R.disabled = !t(x)
            }
            ),
            Ue("scroll", p, o),
            g(v, r)
        }
        ;
        I(A, v => {
            !t(T) && t(h).length > 0 && v(U)
        }
        )
    }
    g(B, W),
    de()
}
Ce(["click"]);
var gt = k('<div><span class="clan-item__rank svelte-15vxund"> </span> <span class="clan-item__avatar svelte-15vxund"> </span> <span class="clan-item__count svelte-15vxund"> </span></div>')
  , ht = k('<section class="top-clans svelte-15vxund"><header class="top-clans__header svelte-15vxund"><h3 class="top-clans__title svelte-15vxund">Топ кланов</h3></header> <div class="top-clans__list svelte-15vxund"></div></section>');
function _t(B, $) {
    ce($, !0);
    let h = u(q([]))
      , T = u(!0);
    xe(async () => {
        const o = ie.getTopClans();
        if (o) {
            a(h, o, !0),
            a(T, !1);
            return
        }
        const _ = await ne.getTopClans();
        _.data && (a(h, _.data, !0),
        ie.setTopClans(_.data)),
        a(T, !1)
    }
    );
    function d(o) {
        return o >= 1e6 ? (o / 1e6).toFixed(1).replace(/\.0$/, "") + "M" : o >= 1e3 ? (o / 1e3).toFixed(1).replace(/\.0$/, "") + "K" : o.toString()
    }
    var i = le()
      , C = ae(i);
    {
        var x = o => {
            var _ = ht()
              , F = f(c(_), 2);
            Re(F, 23, () => t(h), N => N.avatar, (N, K, W) => {
                var A = gt();
                let U;
                var v = c(A)
                  , r = c(v, !0);
                l(v);
                var n = f(v, 2)
                  , M = c(n, !0);
                l(n);
                var y = f(n, 2)
                  , R = c(y, !0);
                l(y),
                l(A),
                J(p => {
                    U = ue(A, 1, "clan-item svelte-15vxund", null, U, {
                        "is-top-3": t(W) < 3
                    }),
                    D(r, t(W) + 1),
                    D(M, t(K).avatar),
                    D(R, p)
                }
                , [ () => d(t(K).memberCount)]),
                g(N, A)
            }
            ),
            l(F),
            l(_),
            g(o, _)
        }
        ;
        I(C, o => {
            !t(T) && t(h).length > 0 && o(x)
        }
        )
    }
    g(B, i),
    de()
}
var mt = k('<div class="feed-loading svelte-1ooj66h"><!></div>')
  , bt = k('<div class="feed-error svelte-1ooj66h"><p> </p> <button class="svelte-1ooj66h">Повторить</button></div>')
  , wt = k('<div class="feed-empty svelte-1ooj66h"><p>Пока нет постов</p></div>')
  , Tt = k('<div class="feed-content svelte-1ooj66h"><!> <!></div>')
  , St = k('<!> <div class="feed-card svelte-1ooj66h"><!> <!></div> <!> <!>', 1);
function At(B, $) {
    ce($, !0);
    const h = () => Le(et, "$feedResetSignal", d)
      , T = () => Le(lt, "$isAuthenticated", d)
      , [d,i] = ze();
    let C = u(!1)
      , x = u(null)
      , o = u("post");
    const _ = "nowkie_feed_active_tab"
      , F = "nowkie_feed_scroll_position";
    function N() {
        return sessionStorage.getItem(_) === "following" ? "following" : "popular"
    }
    function K(e) {
        sessionStorage.setItem(_, e)
    }
    function W() {
        sessionStorage.setItem(F, String(document.body.scrollTop))
    }
    function A() {
        return parseInt(sessionStorage.getItem(F) || "0", 10)
    }
    function U(e) {
        e <= 0 || setTimeout( () => {
            document.body.scrollTop = e
        }
        , 0)
    }
    const v = N()
      , r = G.getTab(v);
    let n = u(q(r?.posts ?? []))
      , M = u(!r)
      , y = u(!1)
      , R = u("")
      , p = u(q(v))
      , j = u(q(r?.nextCursor ?? null))
      , S = u(q(r?.hasMore ?? !1))
      , m = u(null);
    const Y = new URL(window.location.href).searchParams.get("post");
    let b = u(!!Y)
      , P = u(q(Y));
    Xe( ({type: e}) => {
        e === "popstate" && r && U(A())
    }
    ),
    xe( () => {
        let e, s = 0;
        const L = () => {
            clearTimeout(e),
            e = setTimeout( () => {
                const O = document.body.scrollTop;
                Math.abs(O - s) > 50 && (s = O,
                W())
            }
            , 150)
        }
        ;
        return document.body.addEventListener("scroll", L, {
            passive: !0
        }),
        r || E(),
        () => {
            clearTimeout(e),
            document.body.removeEventListener("scroll", L)
        }
    }
    ),
    Me( () => {
        const e = () => {
            const s = new URL(window.location.href).searchParams.get("post");
            s ? (a(P, s, !0),
            a(b, !0)) : (a(b, !1),
            a(P, null))
        }
        ;
        return window.addEventListener("popstate", e),
        () => window.removeEventListener("popstate", e)
    }
    ),
    Me( () => {
        h() !== 0 && (sessionStorage.removeItem(F),
        document.body.scrollTo({
            top: 0,
            behavior: "smooth"
        }),
        G.clear(),
        a(n, [], !0),
        a(j, null),
        a(S, !1),
        E())
    }
    );
    async function E() {
        a(R, ""),
        a(M, !0);
        const e = await Se.getFeed({
            tab: t(p),
            limit: 20
        });
        e.error ? a(R, e.error, !0) : e.data && (a(n, e.data.posts, !0),
        a(j, e.data.pagination.nextCursor, !0),
        a(S, e.data.pagination.hasMore, !0),
        G.setTab(t(p), {
            posts: e.data.posts,
            nextCursor: e.data.pagination.nextCursor,
            hasMore: e.data.pagination.hasMore
        })),
        a(M, !1)
    }
    async function se() {
        if (t(y) || !t(S) || !t(j))
            return;
        a(y, !0);
        const e = await Se.getFeed({
            tab: t(p),
            cursor: t(j),
            limit: 20
        });
        if (e.data) {
            const s = new Set(t(n).map(O => O.id))
              , L = e.data.posts.filter(O => !s.has(O.id));
            a(n, [...t(n), ...L], !0),
            a(j, e.data.pagination.nextCursor, !0),
            a(S, e.data.pagination.hasMore, !0),
            G.appendPosts(t(p), L, e.data.pagination.nextCursor, e.data.pagination.hasMore)
        }
        a(y, !1)
    }
    async function ve(e) {
        if (t(p) === e)
            return;
        a(p, e, !0),
        K(e);
        const s = G.getTab(e);
        s ? (a(n, s.posts, !0),
        a(j, s.nextCursor, !0),
        a(S, s.hasMore, !0)) : (a(n, [], !0),
        a(j, null),
        a(S, !1),
        await E())
    }
    function oe(e) {
        a(x, e, !0),
        a(o, "post"),
        a(C, !0)
    }
    async function fe(e, s) {
        t(x) && await it.createReport({
            targetType: t(o),
            targetId: t(x),
            reason: e,
            description: s || void 0
        })
    }
    function pe(e) {
        T() && Se.recordView(e)
    }
    async function z(e) {
        a(n, [e, ...t(n)], !0),
        G.prependPost(t(p), e),
        a(m, e.id, !0),
        requestAnimationFrame( () => {
            const s = document.querySelector(`[data-post-id="${e.id}"]`);
            s && s.scrollIntoView({
                behavior: "smooth",
                block: "center"
            })
        }
        ),
        setTimeout( () => {
            a(m, null)
        }
        , 2500)
    }
    function re(e, s) {
        a(P, e, !0),
        a(b, !0),
        history.pushState({
            modal: !0,
            postId: e
        }, "", `/feed?post=${e}`)
    }
    function ge() {
        t(b) && (a(b, !1),
        a(P, null),
        history.back())
    }
    Ze( () => {
        if (t(b)) {
            a(b, !1),
            a(P, null);
            const e = new URL(window.location.href);
            e.searchParams.has("post") && (e.searchParams.delete("post"),
            history.replaceState({}, "", e.pathname))
        }
    }
    );
    var w = St()
      , V = ae(w);
    {
        var he = e => {
            tt(e, {
                onPostCreated: z
            })
        }
        ;
        I(V, e => {
            T() && e(he)
        }
        )
    }
    var _e = f(V, 2)
      , ye = c(_e);
    ct(ye, {
        get activeTab() {
            return t(p)
        },
        onTabChange: ve
    });
    var Ie = f(ye, 2);
    {
        var Fe = e => {
            var s = mt()
              , L = c(s);
            $e(L, {}),
            l(s),
            g(e, s)
        }
          , Ae = e => {
            var s = le()
              , L = ae(s);
            {
                var O = H => {
                    var X = bt()
                      , Q = c(X)
                      , me = c(Q, !0);
                    l(Q);
                    var be = f(Q, 2);
                    be.__click = E,
                    l(X),
                    J( () => D(me, t(R))),
                    g(H, X)
                }
                  , Oe = H => {
                    var X = le()
                      , Q = ae(X);
                    {
                        var me = Z => {
                            var ee = wt();
                            g(Z, ee)
                        }
                          , be = Z => {
                            var ee = Tt();
                            {
                                const Be = we => {
                                    pt(we, {})
                                }
                                ;
                                var ke = c(ee);
                                _t(ke, {});
                                var qe = f(ke, 2);
                                {
                                    const we = (te, De) => {
                                        let Te = () => De?.().item;
                                        {
                                            let Ke = je( () => t(m) === Te().id);
                                            ot(te, {
                                                get post() {
                                                    return Te()
                                                },
                                                get isHighlighted() {
                                                    return t(Ke)
                                                },
                                                onReport: () => oe(Te().id),
                                                onView: pe,
                                                onModalOpen: re
                                            })
                                        }
                                    }
                                      , Ne = te => {
                                        $e(te, {})
                                    }
                                    ;
                                    let We = je( () => [{
                                        afterIndex: 2,
                                        snippet: Be
                                    }]);
                                    rt(qe, {
                                        get items() {
                                            return t(n)
                                        },
                                        keyFn: te => te.id,
                                        onLoadMore: se,
                                        get hasMore() {
                                            return t(S)
                                        },
                                        get isLoading() {
                                            return t(y)
                                        },
                                        get injectSlots() {
                                            return t(We)
                                        },
                                        children: we,
                                        loading: Ne,
                                        $$slots: {
                                            default: !0,
                                            loading: !0
                                        }
                                    })
                                }
                                l(ee)
                            }
                            g(Z, ee)
                        }
                        ;
                        I(Q, Z => {
                            t(n).length === 0 ? Z(me) : Z(be, !1)
                        }
                        , !0)
                    }
                    g(H, X)
                }
                ;
                I(L, H => {
                    t(R) ? H(O) : H(Oe, !1)
                }
                , !0)
            }
            g(e, s)
        }
        ;
        I(Ie, e => {
            t(M) ? e(Fe) : e(Ae, !1)
        }
        )
    }
    l(_e);
    var Pe = f(_e, 2);
    Qe(Pe, {
        get isOpen() {
            return t(C)
        },
        onClose: () => a(C, !1),
        onSubmit: fe
    });
    var Ee = f(Pe, 2);
    {
        var Ve = e => {
            at(e, {
                children: (s, L) => {
                    st(s, {
                        get isOpen() {
                            return t(b)
                        },
                        get postId() {
                            return t(P)
                        },
                        onClose: ge,
                        onReport: () => oe(t(P))
                    })
                }
                ,
                $$slots: {
                    default: !0
                }
            })
        }
        ;
        I(Ee, e => {
            t(b) && t(P) && e(Ve)
        }
        )
    }
    g(B, w),
    de(),
    i()
}
Ce(["click"]);
export {At as component};
import "../chunks/DsnmJJEf.js";
import {X as St, p as Ct, s as i, D as et, u as st, g as a, k as e, f as b, b as V, c as r, Z as z, i as l, a as It, h as Ot, e as w, r as o, a1 as L, j as F} from "../chunks/DsUZB3l6.js";
import {i as P} from "../chunks/BZbNXXnN.js";
import {s as Vt, a as rt} from "../chunks/SPpZcdEB.js";
import {p as At} from "../chunks/BzzorF5Q.js";
import {h as ot, I as Tt, R as Bt, L as it, P as Nt, a as Ut, b as Dt, p as Et} from "../chunks/DGLEHYby.js";
import "../chunks/B8CBK0oB.js";
import {V as Ht} from "../chunks/Du7RJd2N.js";
import {i as jt} from "../chunks/BHGMQYcz.js";
import {r as qt} from "../chunks/BnQw_d2V.js";
import {b as Ft} from "../chunks/Dbk_u4kD.js";
var Xt = b('<span class="hashtag-count svelte-75az0a"> </span>')
  , Zt = b('<div class="hashtag-loading svelte-75az0a"><!></div>')
  , Gt = b('<div class="hashtag-error svelte-75az0a"><p> </p> <button class="svelte-75az0a">Повторить</button></div>')
  , Jt = b('<div class="hashtag-empty svelte-75az0a"><p> </p></div>')
  , Kt = b('<div class="hashtag-empty svelte-75az0a"><p> </p></div>')
  , Qt = b('<div class="hashtag-page svelte-75az0a"><header class="hashtag-header svelte-75az0a"><button class="back-btn svelte-75az0a"><!></button> <div class="hashtag-info svelte-75az0a"><h1 class="hashtag-title svelte-75az0a"> </h1> <!></div></header> <div class="hashtag-content svelte-75az0a"><!></div></div> <!> <!>', 1);
function da(nt, lt) {
    Ct(lt, !0);
    const dt = () => rt(At, "$page", X)
      , pt = () => rt(jt, "$isAuthenticated", X)
      , [X,vt] = Vt();
    let A = i(!1)
      , T = i(null)
      , Z = i("post")
      , v = i(et([]))
      , x = i(null)
      , B = i(!0)
      , $ = i(!1)
      , R = i("")
      , k = i(null)
      , S = i(!1);
    const G = new URL(window.location.href).searchParams.get("post");
    let n = i(!!G)
      , d = i(et(G))
      , u = Ot( () => dt().params.tag);
    st( () => {
        a(u) && J()
    }
    ),
    st( () => {
        const t = () => {
            const s = new URL(window.location.href).searchParams.get("post");
            s ? (e(d, s, !0),
            e(n, !0)) : (e(n, !1),
            e(d, null))
        }
        ;
        return window.addEventListener("popstate", t),
        () => window.removeEventListener("popstate", t)
    }
    );
    async function J() {
        e(B, !0),
        e(R, ""),
        e(v, [], !0);
        const t = await ot.getPostsByHashtag(a(u), {
            limit: 20
        });
        t.error ? e(R, t.error, !0) : t.data && (e(x, t.data.hashtag, !0),
        e(v, t.data.posts, !0),
        e(k, t.data.pagination.nextCursor, !0),
        e(S, t.data.pagination.hasMore, !0)),
        e(B, !1)
    }
    async function ut() {
        if (a($) || !a(S) || !a(k))
            return;
        e($, !0);
        const t = await ot.getPostsByHashtag(a(u), {
            cursor: a(k),
            limit: 20
        });
        if (t.data) {
            const s = new Set(a(v).map(y => y.id))
              , p = t.data.posts.filter(y => !s.has(y.id));
            e(v, [...a(v), ...p], !0),
            e(k, t.data.pagination.nextCursor, !0),
            e(S, t.data.pagination.hasMore, !0)
        }
        e($, !1)
    }
    function K(t) {
        e(T, t, !0),
        e(Z, "post"),
        e(A, !0)
    }
    async function ct(t, s) {
        a(T) && await qt.createReport({
            targetType: a(Z),
            targetId: a(T),
            reason: t,
            description: s || void 0
        })
    }
    function ht(t) {
        pt() && Et.recordView(t)
    }
    function ft(t, s) {
        e(d, t, !0),
        e(n, !0),
        history.pushState({
            modal: !0,
            postId: t
        }, "", `/hashtag/${a(u)}?post=${t}`)
    }
    function gt() {
        a(n) && (e(n, !1),
        e(d, null),
        history.back())
    }
    Ft( () => {
        if (a(n)) {
            e(n, !1),
            e(d, null);
            const t = new URL(window.location.href);
            t.searchParams.has("post") && (t.searchParams.delete("post"),
            history.replaceState({}, "", t.pathname))
        }
    }
    );
    function mt() {
        history.back()
    }
    var Q = Qt()
      , N = V(Q)
      , U = r(N)
      , C = r(U);
    C.__click = mt;
    var _t = r(C);
    Tt(_t, {
        size: 20
    }),
    o(C);
    var W = w(C, 2)
      , D = r(W)
      , wt = r(D);
    o(D);
    var Pt = w(D, 2);
    {
        var bt = t => {
            var s = Xt()
              , p = r(s);
            o(s),
            z( () => L(p, `${a(x).postsCount ?? ""} постов`)),
            l(t, s)
        }
        ;
        P(Pt, t => {
            a(x) && t(bt)
        }
        )
    }
    o(W),
    o(U);
    var Y = w(U, 2)
      , yt = r(Y);
    {
        var Mt = t => {
            var s = Zt()
              , p = r(s);
            it(p, {}),
            o(s),
            l(t, s)
        }
          , zt = t => {
            var s = F()
              , p = V(s);
            {
                var y = h => {
                    var f = Gt()
                      , M = r(f)
                      , E = r(M, !0);
                    o(M);
                    var H = w(M, 2);
                    H.__click = J,
                    o(f),
                    z( () => L(E, a(R))),
                    l(h, f)
                }
                  , $t = h => {
                    var f = F()
                      , M = V(f);
                    {
                        var E = g => {
                            var m = Jt()
                              , I = r(m)
                              , j = r(I);
                            o(I),
                            o(m),
                            z( () => L(j, `Хэштег #${a(u) ?? ""} не найден`)),
                            l(g, m)
                        }
                          , H = g => {
                            var m = F()
                              , I = V(m);
                            {
                                var j = _ => {
                                    var O = Kt()
                                      , q = r(O)
                                      , c = r(q);
                                    o(q),
                                    o(O),
                                    z( () => L(c, `Нет постов с хэштегом #${a(u) ?? ""}`)),
                                    l(_, O)
                                }
                                  , Rt = _ => {
                                    Ht(_, {
                                        get items() {
                                            return a(v)
                                        },
                                        keyFn: c => c.id,
                                        onLoadMore: ut,
                                        get hasMore() {
                                            return a(S)
                                        },
                                        get isLoading() {
                                            return a($)
                                        },
                                        children: (c, kt) => {
                                            let at = () => kt?.().item;
                                            Dt(c, {
                                                get post() {
                                                    return at()
                                                },
                                                onReport: () => K(at().id),
                                                onView: ht,
                                                onModalOpen: ft
                                            })
                                        }
                                        ,
                                        loading: c => {
                                            it(c, {})
                                        }
                                        ,
                                        $$slots: {
                                            default: !0,
                                            loading: !0
                                        }
                                    })
                                }
                                ;
                                P(I, _ => {
                                    a(v).length === 0 ? _(j) : _(Rt, !1)
                                }
                                , !0)
                            }
                            l(g, m)
                        }
                        ;
                        P(M, g => {
                            a(x) ? g(H, !1) : g(E)
                        }
                        , !0)
                    }
                    l(h, f)
                }
                ;
                P(p, h => {
                    a(R) ? h(y) : h($t, !1)
                }
                , !0)
            }
            l(t, s)
        }
        ;
        P(yt, t => {
            a(B) ? t(Mt) : t(zt, !1)
        }
        )
    }
    o(Y),
    o(N);
    var tt = w(N, 2);
    Bt(tt, {
        get isOpen() {
            return a(A)
        },
        onClose: () => e(A, !1),
        onSubmit: ct
    });
    var Lt = w(tt, 2);
    {
        var xt = t => {
            Nt(t, {
                children: (s, p) => {
                    Ut(s, {
                        get isOpen() {
                            return a(n)
                        },
                        get postId() {
                            return a(d)
                        },
                        onClose: gt,
                        onReport: () => K(a(d))
                    })
                }
                ,
                $$slots: {
                    default: !0
                }
            })
        }
        ;
        P(Lt, t => {
            a(n) && a(d) && t(xt)
        }
        )
    }
    z( () => L(wt, `#${a(u) ?? ""}`)),
    l(nt, Q),
    It(),
    vt()
}
St(["click"]);
export {da as component};
import "../chunks/DsnmJJEf.js";
import {X as Rt, p as It, s as T, D as Ht, o as Pt, u as Je, k as h, a5 as Bt, g as e, f as A, b as c, c as i, e as g, Z as K, i as a, a as Tt, r as n, j as m, h as Lt, a1 as Ne, a2 as H, a0 as L} from "../chunks/DsUZB3l6.js";
import {i as o, b as Vt} from "../chunks/BZbNXXnN.js";
import {s as Q, e as St} from "../chunks/DC-LS3Wc.js";
import {R as Ot, L as Ke, P as Dt, a as Ut, T as jt, c as Et, N as Ft} from "../chunks/DGLEHYby.js";
import {n as V, f as Xt, h as Zt, g as qt, s as W} from "../chunks/BHGMQYcz.js";
import {a as Ae, s as Gt} from "../chunks/SPpZcdEB.js";
import {b as Jt, g as Kt} from "../chunks/Dbk_u4kD.js";
import "../chunks/B8CBK0oB.js";
import {r as Qt} from "../chunks/BnQw_d2V.js";
var Wt = A('<button class="notifications-header__mark-read svelte-1ce0uvz">Прочитать все</button>')
  , Yt = A('<div class="notifications-loading svelte-1ce0uvz"><!></div>')
  , $t = A('<div class="notifications-empty svelte-1ce0uvz"><svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" class="svelte-1ce0uvz"><path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"></path><path d="M13.73 21a2 2 0 0 1-3.46 0"></path></svg> <p class="svelte-1ce0uvz">Нет уведомлений</p></div>')
  , ea = A('<span class="notification-emoji svelte-1ce0uvz"> </span>')
  , ta = H('<svg width="10" height="10" viewBox="0 0 24 24" fill="currentColor" class="svelte-1ce0uvz"><path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"></path></svg>')
  , aa = H('<svg width="10" height="10" viewBox="0 0 24 24" fill="currentColor" class="svelte-1ce0uvz"><path d="M21.99 4c0-1.1-.89-2-1.99-2H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h14l4 4-.01-18z"></path></svg>')
  , ra = H('<svg width="10" height="10" viewBox="0 0 24 24" fill="currentColor" class="svelte-1ce0uvz"><path d="M10 9V5l-7 7 7 7v-4.1c5 0 8.5 1.6 11 5.1-1-5-4-10-11-11z"></path></svg>')
  , sa = H('<svg width="10" height="10" viewBox="0 0 24 24" fill="currentColor" class="svelte-1ce0uvz"><path d="M15 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm-9-2V7H4v3H1v2h3v3h2v-3h3v-2H6zm9 4c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"></path></svg>')
  , va = H('<svg width="10" height="10" viewBox="0 0 24 24" fill="currentColor" class="svelte-1ce0uvz"><path d="M7 7h10v3l4-4-4-4v3H5v6h2V7zm10 10H7v-3l-4 4 4 4v-3h12v-6h-2v4z"></path></svg>')
  , oa = H('<svg width="10" height="10" viewBox="0 0 24 24" fill="currentColor" class="svelte-1ce0uvz"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10h5v-2h-5c-4.34 0-8-3.66-8-8s3.66-8 8-8 8 3.66 8 8v1.43c0 .79-.71 1.57-1.5 1.57s-1.5-.78-1.5-1.57V12c0-2.76-2.24-5-5-5s-5 2.24-5 5 2.24 5 5 5c1.38 0 2.64-.56 3.54-1.47.65.89 1.77 1.47 2.96 1.47 1.97 0 3.5-1.6 3.5-3.57V12c0-5.52-4.48-10-10-10zm0 13c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3z"></path></svg>')
  , la = H('<svg width="10" height="10" viewBox="0 0 24 24" fill="currentColor" class="svelte-1ce0uvz"><path d="M3 5v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2zm4 0h10v2H7V5zm0 4h10v2H7V9zm0 4h7v2H7v-2z"></path></svg>')
  , ia = H('<svg width="10" height="10" viewBox="0 0 24 24" fill="currentColor" class="svelte-1ce0uvz"><path d="M12 22c1.1 0 2-.9 2-2h-4c0 1.1.89 2 2 2zm6-6v-5c0-3.07-1.64-5.64-4.5-6.32V4c0-.83-.67-1.5-1.5-1.5s-1.5.67-1.5 1.5v.68C7.63 5.36 6 7.92 6 11v5l-2 2v1h16v-1l-2-2z"></path></svg>')
  , na = A('<p class="notification-preview svelte-1ce0uvz"> </p>')
  , ca = A('<div role="button" tabindex="0"><a class="notification-avatar-wrap svelte-1ce0uvz" title="Перейти в профиль"><div class="notification-avatar svelte-1ce0uvz"><!></div> <div><!></div></a> <div class="notification-content svelte-1ce0uvz"><p class="notification-text svelte-1ce0uvz"><a class="notification-author svelte-1ce0uvz"> </a> <span class="notification-action svelte-1ce0uvz"><!></span></p> <!> <!></div></div>')
  , da = A('<div class="notifications-loading-more svelte-1ce0uvz"><!></div>')
  , ua = A('<!> <div class="notifications-sentinel svelte-1ce0uvz" aria-hidden="true"></div> <!>', 1)
  , fa = A('<div class="notifications-card svelte-1ce0uvz"><header class="notifications-header svelte-1ce0uvz"><div class="notifications-header__top svelte-1ce0uvz"><h2 class="notifications-header__title svelte-1ce0uvz">Уведомления</h2> <!></div> <div class="notifications-tabs svelte-1ce0uvz"><button>Все</button> <button>Упоминания</button></div></header> <div class="notifications-list svelte-1ce0uvz"><!></div></div> <!> <!>', 1);
function xa(Qe, We) {
    It(We, !0);
    const R = () => Ae(Xt, "$notifications", $)
      , Ye = () => Ae(Zt, "$hasMoreNotifications", $)
      , Y = () => Ae(qt, "$isLoadingNotifications", $)
      , [$,$e] = Gt();
    let P = T(!1)
      , S = T(null)
      , ee = T(!1)
      , te = T(null)
      , D = T("all")
      , Z = null
      , U = null
      , q = T(null)
      , G = new Set
      , j = null
      , B = T(Ht(new Set))
      , Re = !1;
    Pt( () => {
        V.fetchNotifications(),
        Z = new IntersectionObserver(t => {
            for (const v of t)
                if (v.isIntersecting) {
                    const z = v.target.getAttribute("data-notification-id")
                      , oe = v.target.getAttribute("data-unread") === "true";
                    z && oe && (G.add(z),
                    et())
                }
        }
        ,{
            threshold: .5
        })
    }
    ),
    Je( () => {
        !Re && R().length > 0 && (h(B, new Set(R().filter(t => !t.read).map(t => t.id)), !0),
        Re = !0)
    }
    ),
    Bt( () => {
        Z?.disconnect(),
        U?.disconnect(),
        j && clearTimeout(j),
        Ie()
    }
    ),
    Je( () => {
        if (e(q))
            return U?.disconnect(),
            U = new IntersectionObserver(t => {
                t[0]?.isIntersecting && Ye() && !Y() && at()
            }
            ,{
                rootMargin: "200px",
                threshold: 0
            }),
            U.observe(e(q)),
            () => {
                U?.disconnect()
            }
    }
    );
    function et() {
        j || (j = setTimeout( () => {
            Ie(),
            j = null
        }
        , 500))
    }
    function Ie() {
        if (G.size === 0)
            return;
        const t = Array.from(G);
        G.clear(),
        V.markBatchAsRead(t)
    }
    function tt(t) {
        return Z?.observe(t),
        {
            destroy() {
                Z?.unobserve(t)
            }
        }
    }
    async function at() {
        const t = R().length;
        await V.fetchNotifications(t);
        const v = R().slice(t);
        for (const z of v)
            z.read || e(B).add(z.id)
    }
    function He(t) {
        if (e(B).delete(t.id),
        t.read || V.markAsRead(t.id),
        ["like", "comment", "reply", "repost", "mention", "wall_post"].includes(t.type) && t.targetId)
            h(S, t.targetId, !0),
            h(P, !0);
        else {
            const z = V.getNotificationLink(t);
            Kt(z)
        }
    }
    function rt() {
        e(P) && (h(P, !1),
        h(S, null))
    }
    Jt( () => {
        e(P) && (h(P, !1),
        h(S, null))
    }
    );
    function st(t) {
        h(te, t, !0),
        h(ee, !0)
    }
    async function vt(t, v) {
        e(te) && await Qt.createReport({
            targetType: "post",
            targetId: e(te),
            reason: t,
            description: v || void 0
        })
    }
    function Pe(t) {
        return `/${t.actor.username || t.actor.id}`
    }
    function Be(t, v) {
        e(B).delete(v.id),
        v.read || V.markAsRead(v.id)
    }
    async function ot() {
        await V.markAllAsRead(),
        e(B).clear()
    }
    let Te = Lt( () => e(D) === "mentions" ? R().filter(t => t.type === "mention" || t.type === "reply") : R());
    var Le = fa()
      , ae = c(Le)
      , re = i(ae)
      , se = i(re)
      , lt = g(i(se), 2);
    {
        var it = t => {
            var v = Wt();
            v.__click = ot,
            a(t, v)
        }
        ;
        o(lt, t => {
            e(B).size > 0 && t(it)
        }
        )
    }
    n(se);
    var Ve = g(se, 2)
      , ve = i(Ve);
    let Se;
    ve.__click = () => h(D, "all");
    var Oe = g(ve, 2);
    let De;
    Oe.__click = () => h(D, "mentions"),
    n(Ve),
    n(re);
    var Ue = g(re, 2)
      , nt = i(Ue);
    {
        var ct = t => {
            var v = Yt()
              , z = i(v);
            Ke(z, {}),
            n(v),
            a(t, v)
        }
          , dt = t => {
            var v = m()
              , z = c(v);
            {
                var oe = O => {
                    var J = $t();
                    a(O, J)
                }
                  , _t = O => {
                    var J = ua()
                      , Ee = c(J);
                    St(Ee, 17, () => e(Te), w => w.id, (w, s) => {
                        var y = ca();
                        let Xe;
                        y.__click = () => He(e(s)),
                        y.__keydown = r => {
                            (r.key === "Enter" || r.key === " ") && (r.preventDefault(),
                            He(e(s)))
                        }
                        ;
                        var E = i(y);
                        E.__click = r => Be(r, e(s));
                        var le = i(E)
                          , gt = i(le);
                        {
                            var mt = r => {
                                var l = ea()
                                  , b = i(l, !0);
                                n(l),
                                K( () => Ne(b, e(s).actor.avatar)),
                                a(r, l)
                            }
                              , zt = r => {
                                Ft(r, {
                                    size: 44
                                })
                            }
                            ;
                            o(gt, r => {
                                e(s).actor.avatar ? r(mt) : r(zt, !1)
                            }
                            )
                        }
                        n(le);
                        var ie = g(le, 2)
                          , yt = i(ie);
                        {
                            var wt = r => {
                                var l = ta();
                                a(r, l)
                            }
                              , bt = r => {
                                var l = m()
                                  , b = c(l);
                                {
                                    var ce = d => {
                                        var k = aa();
                                        a(d, k)
                                    }
                                      , de = d => {
                                        var k = m()
                                          , ue = c(k);
                                        {
                                            var fe = u => {
                                                var x = ra();
                                                a(u, x)
                                            }
                                              , _e = u => {
                                                var x = m()
                                                  , pe = c(x);
                                                {
                                                    var he = f => {
                                                        var M = sa();
                                                        a(f, M)
                                                    }
                                                      , ge = f => {
                                                        var M = m()
                                                          , me = c(M);
                                                        {
                                                            var ze = _ => {
                                                                var C = va();
                                                                a(_, C)
                                                            }
                                                              , ye = _ => {
                                                                var C = m()
                                                                  , we = c(C);
                                                                {
                                                                    var be = p => {
                                                                        var N = oa();
                                                                        a(p, N)
                                                                    }
                                                                      , ke = p => {
                                                                        var N = m()
                                                                          , xe = c(N);
                                                                        {
                                                                            var Me = I => {
                                                                                var Ce = la();
                                                                                a(I, Ce)
                                                                            }
                                                                              , X = I => {
                                                                                var Ce = ia();
                                                                                a(I, Ce)
                                                                            }
                                                                            ;
                                                                            o(xe, I => {
                                                                                e(s).type === "wall_post" ? I(Me) : I(X, !1)
                                                                            }
                                                                            , !0)
                                                                        }
                                                                        a(p, N)
                                                                    }
                                                                    ;
                                                                    o(we, p => {
                                                                        e(s).type === "mention" ? p(be) : p(ke, !1)
                                                                    }
                                                                    , !0)
                                                                }
                                                                a(_, C)
                                                            }
                                                            ;
                                                            o(me, _ => {
                                                                e(s).type === "repost" ? _(ze) : _(ye, !1)
                                                            }
                                                            , !0)
                                                        }
                                                        a(f, M)
                                                    }
                                                    ;
                                                    o(pe, f => {
                                                        e(s).type === "follow" ? f(he) : f(ge, !1)
                                                    }
                                                    , !0)
                                                }
                                                a(u, x)
                                            }
                                            ;
                                            o(ue, u => {
                                                e(s).type === "reply" ? u(fe) : u(_e, !1)
                                            }
                                            , !0)
                                        }
                                        a(d, k)
                                    }
                                    ;
                                    o(b, d => {
                                        e(s).type === "comment" ? d(ce) : d(de, !1)
                                    }
                                    , !0)
                                }
                                a(r, l)
                            }
                            ;
                            o(yt, r => {
                                e(s).type === "like" ? r(wt) : r(bt, !1)
                            }
                            )
                        }
                        n(ie),
                        n(E);
                        var Ze = g(E, 2)
                          , ne = i(Ze)
                          , F = i(ne);
                        F.__click = r => Be(r, e(s));
                        var kt = i(F, !0);
                        n(F);
                        var qe = g(F, 2)
                          , xt = i(qe);
                        {
                            var Mt = r => {
                                var l = L("оценил ваш пост");
                                a(r, l)
                            }
                              , Ct = r => {
                                var l = m()
                                  , b = c(l);
                                {
                                    var ce = d => {
                                        var k = L("прокомментировал ваш пост");
                                        a(d, k)
                                    }
                                      , de = d => {
                                        var k = m()
                                          , ue = c(k);
                                        {
                                            var fe = u => {
                                                var x = L("ответил на ваш комментарий");
                                                a(u, x)
                                            }
                                              , _e = u => {
                                                var x = m()
                                                  , pe = c(x);
                                                {
                                                    var he = f => {
                                                        var M = L("подписался на вас");
                                                        a(f, M)
                                                    }
                                                      , ge = f => {
                                                        var M = m()
                                                          , me = c(M);
                                                        {
                                                            var ze = _ => {
                                                                var C = L("сделал репост вашего поста");
                                                                a(_, C)
                                                            }
                                                              , ye = _ => {
                                                                var C = m()
                                                                  , we = c(C);
                                                                {
                                                                    var be = p => {
                                                                        var N = L("упомянул вас");
                                                                        a(p, N)
                                                                    }
                                                                      , ke = p => {
                                                                        var N = m()
                                                                          , xe = c(N);
                                                                        {
                                                                            var Me = X => {
                                                                                var I = L("написал на вашей стене");
                                                                                a(X, I)
                                                                            }
                                                                            ;
                                                                            o(xe, X => {
                                                                                e(s).type === "wall_post" && X(Me)
                                                                            }
                                                                            , !0)
                                                                        }
                                                                        a(p, N)
                                                                    }
                                                                    ;
                                                                    o(we, p => {
                                                                        e(s).type === "mention" ? p(be) : p(ke, !1)
                                                                    }
                                                                    , !0)
                                                                }
                                                                a(_, C)
                                                            }
                                                            ;
                                                            o(me, _ => {
                                                                e(s).type === "repost" ? _(ze) : _(ye, !1)
                                                            }
                                                            , !0)
                                                        }
                                                        a(f, M)
                                                    }
                                                    ;
                                                    o(pe, f => {
                                                        e(s).type === "follow" ? f(he) : f(ge, !1)
                                                    }
                                                    , !0)
                                                }
                                                a(u, x)
                                            }
                                            ;
                                            o(ue, u => {
                                                e(s).type === "reply" ? u(fe) : u(_e, !1)
                                            }
                                            , !0)
                                        }
                                        a(d, k)
                                    }
                                    ;
                                    o(b, d => {
                                        e(s).type === "comment" ? d(ce) : d(de, !1)
                                    }
                                    , !0)
                                }
                                a(r, l)
                            }
                            ;
                            o(xt, r => {
                                e(s).type === "like" ? r(Mt) : r(Ct, !1)
                            }
                            )
                        }
                        n(qe),
                        n(ne);
                        var Ge = g(ne, 2);
                        {
                            var Nt = r => {
                                var l = na()
                                  , b = i(l, !0);
                                n(l),
                                K( () => Ne(b, e(s).preview)),
                                a(r, l)
                            }
                            ;
                            o(Ge, r => {
                                e(s).preview && r(Nt)
                            }
                            )
                        }
                        var At = g(Ge, 2);
                        jt(At, {
                            get date() {
                                return e(s).createdAt
                            },
                            class: "notification-time"
                        }),
                        n(Ze),
                        n(y),
                        Et(y, r => tt?.(r)),
                        K( (r, l, b) => {
                            Xe = Q(y, 1, "notification-item svelte-1ce0uvz", null, Xe, r),
                            W(y, "data-notification-id", e(s).id),
                            W(y, "data-unread", !e(s).read),
                            W(E, "href", l),
                            Q(ie, 1, `notification-badge notification-badge--${e(s).type ?? ""}`, "svelte-1ce0uvz"),
                            W(F, "href", b),
                            Ne(kt, e(s).actor.displayName)
                        }
                        , [ () => ({
                            unread: e(B).has(e(s).id)
                        }), () => Pe(e(s)), () => Pe(e(s))]),
                        a(w, y)
                    }
                    );
                    var Fe = g(Ee, 2);
                    Vt(Fe, w => h(q, w), () => e(q));
                    var pt = g(Fe, 2);
                    {
                        var ht = w => {
                            var s = da()
                              , y = i(s);
                            Ke(y, {}),
                            n(s),
                            a(w, s)
                        }
                        ;
                        o(pt, w => {
                            Y() && R().length > 0 && w(ht)
                        }
                        )
                    }
                    a(O, J)
                }
                ;
                o(z, O => {
                    e(Te).length === 0 ? O(oe) : O(_t, !1)
                }
                , !0)
            }
            a(t, v)
        }
        ;
        o(nt, t => {
            Y() && R().length === 0 ? t(ct) : t(dt, !1)
        }
        )
    }
    n(Ue),
    n(ae);
    var je = g(ae, 2);
    Ot(je, {
        get isOpen() {
            return e(ee)
        },
        onClose: () => h(ee, !1),
        onSubmit: vt
    });
    var ut = g(je, 2);
    {
        var ft = t => {
            Dt(t, {
                children: (v, z) => {
                    Ut(v, {
                        get isOpen() {
                            return e(P)
                        },
                        get postId() {
                            return e(S)
                        },
                        onClose: rt,
                        onReport: () => st(e(S))
                    })
                }
                ,
                $$slots: {
                    default: !0
                }
            })
        }
        ;
        o(ut, t => {
            e(P) && e(S) && t(ft)
        }
        )
    }
    K( () => {
        Se = Q(ve, 1, "notifications-tab svelte-1ce0uvz", null, Se, {
            active: e(D) === "all"
        }),
        De = Q(Oe, 1, "notifications-tab svelte-1ce0uvz", null, De, {
            active: e(D) === "mentions"
        })
    }
    ),
    a(Qe, Le),
    Tt(),
    $e()
}
Rt(["click", "keydown"]);
export {xa as component};
